###########################################
#
# Society decisions for monastic orders
#
###########################################

society_decisions = {

	request_to_rank_up_within_society = {
		only_playable = yes

		hide_in_decisions_list = yes # This is shown in the Society View
		
		ai_check_interval = 12
		
		potential = {
			hidden_tooltip = {
				OR = { #In some societies, there can only be 1 member at rank 4
					society_rank < 3
					NOR = {
						society_member_of = monastic_order_elder_council
						society_member_of = the_enlightened
						society_member_of = the_kemurikage_sisterhood
						society_member_of = the_white_lotus
					}
				}
				society_rank < 4
				days_in_society > 365
				is_in_society = yes
				OR = { #Players can always rank up (if they have the power)
					ai = no
					AND = {
						ai = yes
						society_can_rank_up = yes
					}
				}
			}
		}

		allow = {
			#Rank requirements. IMPORTANT!!! If you change the requirements, the customizable loc keys "GetSocietyRankUpTooltip" 1, 2, 3, and 4 must be updated, as it displays these requirements.
			custom_tooltip = { # Sufficient currency
				text = request_to_rank_up_within_society_currency_tt
				OR = {
					AND = {
						society_rank == 1
						society_currency >= 750
					}
					AND = {
						society_rank == 2
						society_currency >= 1000
					}
					society_currency >= 2000 # rank 3
				}
			}
			custom_tooltip = {
				text = request_to_rank_up_within_society_cynical_tt
				OR = {
					NOT = { society_member_of = monastic_order_elder_council }
					AND = {
						society_rank == 1
						NOT = {
							trait = cruel
						}
					}
					AND = {
						society_rank == 2
						NOR = {
							trait = cruel
							trait = cynical
						}
					}
					AND = {
						society_rank == 3
						NOR = {
							trait = cruel
							trait = cynical
							trait = greedy
							trait = gluttonous
							trait = slothful
							trait = envious
							trait = wroth
							trait = proud
						}
					}
				}
			}
			custom_tooltip = {
				text = request_to_rank_up_within_society_virtues_tt
				OR = {
					NOT = { society_member_of = monastic_order_elder_council }
					AND = {
						society_rank == 1
						OR = {
							trait = humble
							trait = charitable
							trait = chaste
							trait = kind
							trait = temperate
							trait = patient
							trait = diligent
						}
					}
					AND = {
						society_rank == 2
						calc_true_if = {
							amount = 2
							trait = humble
							trait = charitable
							trait = chaste
							trait = kind
							trait = temperate
							trait = patient
							trait = diligent
						}
					}
					AND = {
						society_rank == 3
						calc_true_if = {
							amount = 3
							trait = humble
							trait = charitable
							trait = chaste
							trait = kind
							trait = temperate
							trait = patient
							trait = diligent
						}
					}
				}
			}

			custom_tooltip = {
				text = must_not_have_sent_request_already_tooltip 
				NOT = { has_character_flag = has_sent_request_to_rank_up }
			}

			custom_tooltip = {
				text = must_be_allowed_to_rank_up_tooltip 
				days_at_current_society_rank >= 1095 #IMPORTANT! Update tooltip.
			}

			custom_tooltip = {
				text = must_have_grandmaster_tooltip #You must have a grand master
				any_society_member = {
					is_society_grandmaster = yes
					same_society_as = ROOT
				}
			}

			custom_tooltip = {
				text = must_have_multiple_rank_4 #Society must allow multiple characters at Rank 4
				NAND = {
					society_rank == 3
					OR = {
						society_member_of = monastic_order_elder_council
						society_member_of = the_enlightened
						society_member_of = the_kemurikage_sisterhood
						society_member_of = the_white_lotus
					}
				}
			}
		}

		effect = {
			#Rank up cost
			if = {
				limit = { society_rank == 1 }
				change_society_currency = -750
			}
			if = {
				limit = { society_rank == 2 }
				change_society_currency = -1000
			}
			if = {
				limit = { society_rank == 3 }
				change_society_currency = -2000
			}

			#Perform rank up
			hidden_tooltip = {
				save_event_target_as = rank_up_target
				set_character_flag = has_sent_request_to_rank_up
				character_event = { id = MNSAK.3000 days = 20 random = 10 } # sends hidden delayed event to self, which then sends request to Leader of the society
			}
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0.5 #Slow down
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 2 
				trait = ambitious
			}
		}
	}
	
	monastic_order_decide_policy = {
		ai_check_interval = 12
		is_high_prio = yes
		only_playable = yes
		
		potential = {
			society_member_of = monastic_order_elder_council
			society_rank >= 4
		}
		
		allow = {
			custom_tooltip = {
				text = changed_an_policy_recently
				hidden_tooltip = {
					OR = {
						NOT = { has_global_flag = recently_changed_an_policy }
						had_global_flag = { flag = recently_changed_an_policy days = 3650 }
					}
				}
			}
		}
		
		effect = {
			set_global_flag = recently_changed_an_policy
			hidden_tooltip = {
				character_event = { id = NOMAD.607 }
			}
		}
		
		ai_will_do = {
			factor = 0.5
		}
	}
	
	monastic_order_learn_poetry = {
		ai_check_interval = 12
		is_high_prio = yes
		potential = {
			society_member_of = five_seven_fiver_society
			NOT = { trait = poet }
		}
		
		allow = {
			has_society_currency_tiny_trigger = yes
		}
		
		effect = {
			detract_society_currency_tiny_effect = yes
			add_trait = poet
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	five_seven_fiver_write_poem = {
		ai_check_interval = 12
		is_high_prio = yes
		potential = {
			society_member_of = five_seven_fiver_society
			society_rank >= 2
			prisoner = no
			NOT = { trait = incapable }
		}
		
		allow = {
			ROOT = {
				trait = poet
				custom_tooltip = {
					text = hermetics_wrote_magnum_opus_cd_tooltip
					NOT = { has_character_flag = wrote_magnum_opus }
				}
				has_society_currency_medium_trigger = yes
				custom_tooltip = {
					text = hermetics_wrote_magnum_opus_duplicate
					OR = {
    					NOR = {
    						has_artifact = poemNature1
							has_artifact = poemNature2
							has_artifact = poemNature3
							has_artifact = poemNature4
    					}
    					NOR = {
    						has_artifact = poemWar1
							has_artifact = poemWar2
							has_artifact = poemWar3
							has_artifact = poemWar4
    					}
    					NOR = {
    						has_artifact = poemLove1
							has_artifact = poemLove2
							has_artifact = poemLove3
							has_artifact = poemLove4
    					}
					}
				}
			}
		}
		
		effect = {
			detract_society_currency_medium_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5016 days = 1 }
				set_character_flag = wrote_magnum_opus
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	bak_physical_training = {
		ai_check_interval = 12
		is_high_prio = yes
		only_playable = yes
		
		potential = {
			society_member_of = brotherhood_of_agni_kai
			society_rank >= 2
			OR = {
				NOT = { has_character_flag = bak_physical_training_done }
				had_character_flag = { flag = bak_physical_training_done days = 1500 }
			}
		}
		
		allow = {
			prisoner = no
			NOT = { trait = incapable }
			has_society_currency_medium_trigger = yes
		}
		
		effect = {
			detract_society_currency_medium_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5051 days = 7 }
				set_character_flag = bak_physical_training_done
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	bak_learn_new_bending = {
		ai_check_interval = 12
		is_high_prio = yes
		only_playable = yes
		
		potential = {
			society_member_of = brotherhood_of_agni_kai
			society_rank >= 4
			NOT = { has_character_flag = bak_learned_new_bending_done }
			NOR = {
				trait = lightningbender
				trait = combustionbender
				trait = innerflame
			}
		}
		
		allow = {
			prisoner = no
			NOT = { trait = incapable }
			has_society_currency_major_trigger = yes
		}
		
		effect = {
			detract_society_currency_major_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5066 days = 7 }
				set_character_flag = bak_learned_new_bending_done
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	bak_learn_bending = {
		ai_check_interval = 12
		is_high_prio = yes
		only_playable = yes
		
		potential = {
			society_member_of = brotherhood_of_agni_kai
			society_rank >= 3
			OR = {
				NOT = { has_character_flag = bak_bending_training_done }
				had_character_flag = { flag = bak_bending_training_done days = 3650 }
			}
		}
		
		allow = {
			prisoner = no
			NOT = { trait = incapable }
			has_society_currency_major_trigger = yes
		}
		
		effect = {
			detract_society_currency_major_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5056 days = 7 }
				set_character_flag = bak_bending_training_done
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	tes_spiritual_study = {
		ai_check_interval = 12
		only_playable = yes
		
		potential = {
			society_member_of = the_enlightened
			OR = {
				NOT = { has_character_flag = tes_study_recently_done }
				had_character_flag = { flag = tes_study_recently_done days = 5200 }
			}
		}
		
		allow = {
			prisoner = no
			NOT = { trait = incapable }
			has_society_currency_minor_trigger = yes
		}
		
		effect = {
			detract_society_currency_minor_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5092 days = 7 }
				set_character_flag = tes_study_recently_done
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	tes_learn_dark_arts = {
		ai_check_interval = 12
		only_playable = yes
		
		potential = {
			society_member_of = the_enlightened
			society_rank >= 3
			OR = {
				NOT = { has_character_flag = tes_learn_art_recently_done }
				had_character_flag = { flag = tes_learn_art_recently_done days = 3650 }
			}
			OR = {
				NOT = { trait = shrewd }
				NOR = {
					trait = bloodbender
					trait = lightningbender
					trait = lavabender
					trait = voidbender
				}
				OR = {
					trait = powerful_bender
					trait = competent_bender
					trait = incompetent_bender
				}
			}
		}
		
		allow = {
			prisoner = no
			NOT = { trait = incapable }
			has_society_currency_medium_trigger = yes
		}
		
		effect = {
			detract_society_currency_medium_effect = yes
			increase_visibility_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5112 days = 7 }
				set_character_flag = tes_learn_art_recently_done
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	tes_use_spiritual_energy = {
		ai_check_interval = 12
		is_high_prio = yes
		only_playable = yes
		
		potential = {
			society_member_of = the_enlightened
			society_rank >= 3
			OR = {
				NOT = { has_character_flag = tes_boost_energy_recently_done }
				had_character_flag = { flag = tes_boost_energy_recently_done days = 3650 }
			}
		}
		
		allow = {
			prisoner = no
			NOT = { trait = incapable }
			has_society_currency_major_trigger = yes
		}
		
		effect = {
			detract_society_currency_major_effect = yes
			increase_visibility_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5111 days = 7 }
				set_character_flag = tes_boost_energy_recently_done
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}

	monastic_orders_go_celibate = {
		ai_check_interval = 12
		
		potential = {
			society_member_of = monastic_order_elder_council
			society_rank >= 2
			NOT = { has_character_modifier = promise_of_celibacy }
			NOT = { trait = celibate }
		}

		allow = {
			NOT = {
				trait = celibate
				trait = hedonist
				trait = seducer
				trait = seductress
			}
		}

		effect = {
			tooltip = {
				add_trait = celibate
			}
			character_event = {
				id = MNSAK.3003
			}
		}
		
		ai_will_do = {
			factor = 0
		}
	}

	monastic_orders_stop_celibate = {
		ai_check_interval = 12
		
		potential = {
			society_member_of = monastic_order_elder_council
			society_rank >= 2
			trait = celibate
		}

		allow = {
			trait = celibate
		}

		effect = {
			tooltip = {
				remove_trait = celibate
			}
			character_event = {
				id = MNSAK.3004
			}
		}
		
		ai_will_do = {
			factor = 0
		}
	}

	monastic_orders_donate_to_charity = {
		only_playable = yes
		ai_check_interval = 12
		
		potential = {
			society_member_of = monastic_order_elder_council
			OR = {
				has_quest = quest_monastic_order_donate_to_charity
				NOT = { has_character_modifier = recently_donated_to_charity}
			}
			NOT = { has_character_flag = donate_to_charity_cooldown }
		}

		allow = {
			wealth = 100
		}

		effect = {
			set_character_flag = donate_to_charity_cooldown
			tooltip = {
				wealth = -100
				if = {
					limit = { has_quest = quest_monastic_order_donate_to_charity }
					add_society_currency_medium_effect = yes
				}
				if = {
					limit = { NOT = { has_quest = quest_monastic_order_donate_to_charity } }
					add_society_currency_minor_effect = yes
				}
				add_character_modifier = {
					modifier = recently_donated_to_charity
					days = 360
				}
				if = {
					limit = { 
						NOR = {
							trait = charitable
							trait = greedy 
						} 
					}
					random = {
						chance = 30
						add_trait = charitable
					}
				}
				if = {
					limit = { trait = greedy }
					random = {
						chance = 40
						remove_trait = greedy
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						is_society_grandmaster = no
					}
					random_society_member = {
						limit = {
							same_society_as = ROOT
							is_society_grandmaster = yes
						}
						character_event = {
							id = MNSAK.3006
						}
					}
				}
				else_if = {
					limit = {
						is_society_grandmaster = yes
						any_society_member = {
							same_society_as = ROOT
							is_society_grandmaster = no
						}
					}
					random_society_member = {
						limit = {
							same_society_as = ROOT
							is_society_grandmaster = no
						}
						character_event = {
							id = MNSAK.3006
						}
					}
				}
				else = {
					wealth = -100
					if = {
						limit = { NOT = { has_quest = quest_monastic_order_donate_to_charity } }
						add_society_currency_minor_effect = yes
					}
					
					if = {
						limit = { has_quest = quest_monastic_order_donate_to_charity }
						clr_quest = quest_monastic_order_donate_to_charity
						sound_effect = monastic_orders_donate_charity
						hidden_effect = { monastic_order_purity_effect = yes }
						add_society_currency_medium_effect = yes
					}

					add_character_modifier = {
						modifier = recently_donated_to_charity
						days = 360
					}
					if = {
						limit = { NOT = { trait = greedy } }
						random = {
							chance = 30
							add_trait = charitable
						}
					}
					if = {
						limit = { trait = greedy }
						random = {
							chance = 40
							remove_trait = greedy
						}
					}
					clr_character_flag = donate_to_charity_cooldown
				}
			}
		}
	}

	monastic_order_meditation = {
		ai_check_interval = 12
		
		potential = {
			society_member_of = monastic_order_elder_council
			has_quest = quest_monastic_order_meditation
		}

		allow = {
			has_quest = quest_monastic_order_meditation
			custom_tooltip = {
				text = monastic_order_meditation_allow_tt
				OR = {
					NOT = { has_character_flag = holy_seclusion_timer }
					had_character_flag = { flag = holy_seclusion_timer days = 1000 }
				}
			}
		}

		effect = {
			add_character_modifier = {
				name = in_meditation
				duration = -1
			}
			hidden_effect = { character_event = { id = MNSAK.3008 } }
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0.1

			modifier = {
				factor = 0.01
				war = yes
			}
			modifier = {
				factor = 0.1
				OR = {
					trait = gregarious
					trait = socializer
				}
			}
			modifier = {
				factor = 5
				is_virtous = yes
			}
		}
	}
	
	monastic_order_rejoin_world = {
		ai_check_interval = 12

		potential = {
			OR = {
				has_character_modifier = doing_penance
				has_character_modifier = in_meditation
			}
		}

		allow = {
			OR = {
				has_character_modifier = doing_penance
				has_character_modifier = in_meditation
			}
			piety = 100
		}

		effect = {
			remove_character_modifier = doing_penance
			remove_character_modifier = in_meditation
			hidden_effect = {
				clr_character_flag = success_seculison_desc_A #Flags from 4426
				clr_character_flag = success_seculison_desc_B
				clr_character_flag = success_seculison_desc_C
			}
			piety = -100
		}

		revoke_allowed = { always = no }

		ai_will_do = {
			factor = 0
		}
	}
	
	ks_donate = {
		only_playable = yes
		ai_check_interval = 12
		
		potential = {
			society_member_of = the_kemurikage_sisterhood
			OR = {
				has_quest = quest_kes_donate_to_charity
				NOT = { has_character_modifier = recently_donated_to_charity}
			}
			NOT = { has_character_flag = donate_to_charity_cooldown }
		}

		allow = {
			wealth = 100
		}

		effect = {
			set_character_flag = donate_to_charity_cooldown
			tooltip = {
				wealth = -100
				if = {
					limit = { has_quest = quest_kes_donate_to_charity }
					add_society_currency_medium_effect = yes
				}
				if = {
					limit = { NOT = { has_quest = quest_kes_donate_to_charity } }
					add_society_currency_minor_effect = yes
				}
				add_character_modifier = {
					modifier = recently_donated_to_charity
					days = 360
				}
				if = {
					limit = { 
						NOR = {
							trait = charitable
							trait = greedy 
						} 
					}
					random = {
						chance = 30
						add_trait = charitable
					}
				}
				if = {
					limit = { trait = greedy }
					random = {
						chance = 40
						remove_trait = greedy
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						is_society_grandmaster = no
					}
					random_society_member = {
						limit = {
							same_society_as = ROOT
							is_society_grandmaster = yes
						}
						character_event = {
							id = MNSAK.5142
						}
					}
				}
				else_if = {
					limit = {
						is_society_grandmaster = yes
						any_society_member = {
							same_society_as = ROOT
							is_society_grandmaster = no
						}
					}
					random_society_member = {
						limit = {
							same_society_as = ROOT
							is_society_grandmaster = no
						}
						character_event = {
							id = MNSAK.5142
						}
					}
				}
				else = {
					wealth = -100
					if = {
						limit = { NOT = { has_quest = quest_kes_donate_to_charity } }
						add_society_currency_minor_effect = yes
					}
					
					if = {
						limit = { has_quest = quest_kes_donate_to_charity }
						clr_quest = quest_kes_donate_to_charity
						sound_effect = monastic_orders_donate_charity
						hidden_effect = { monastic_order_purity_effect = yes }
						add_society_currency_medium_effect = yes
					}

					add_character_modifier = {
						modifier = recently_donated_to_charity
						days = 360
					}
					if = {
						limit = { NOT = { trait = greedy } }
						random = {
							chance = 30
							add_trait = charitable
						}
					}
					if = {
						limit = { trait = greedy }
						random = {
							chance = 40
							remove_trait = greedy
						}
					}
					clr_character_flag = donate_to_charity_cooldown
				}
			}
		}
	}
	
	ks_train = {
		ai_check_interval = 12
		is_high_prio = yes
		
		potential = {
			society_member_of = the_kemurikage_sisterhood
			OR = {
				NOT = { has_character_flag = kes_physical_training_done }
				had_character_flag = { flag = kes_physical_training_done days = 1500 }
			}
		}
		
		allow = {
			prisoner = no
			NOT = { trait = incapable }
			has_society_currency_medium_trigger = yes
		}
		
		effect = {
			detract_society_currency_medium_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5144 days = 7 }
				set_character_flag = kes_physical_training_done
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	ks_raise_sisters = {
		only_playable = yes
		is_high_prio = yes
		ai_check_interval = 12

		potential = {
			society_rank = {
				society = the_kemurikage_sisterhood
				rank >= 3
			}
		}

		allow = {
			war = yes
			has_society_currency_medium_trigger = yes
		}

		effect = {
			capital_scope = {
				ROOT = {
					spawn_unit = {
						owner = ROOT
						province = PREV
						home = PREV
						troops = {
							fire_benders = { 400 400 }
						}
						attrition = 1.0
						disband_on_peace = yes
						maintenance_multiplier = 0
						earmark = kemurikage_troops
					}	
				}
			}
			detract_society_currency_medium_effect = yes
			sound_effect = generic_click_01
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0.2 #Slowdown
			}
		}
	}
	
	ks_enforce_doctrine = {
		only_playable = yes
		is_high_prio = yes
		ai_check_interval = 12

		potential = {
			society_rank = {
				society = the_kemurikage_sisterhood
				rank >= 4
			}
			any_realm_province = {
				religion_group = ROOT
				NOT = { religion = ROOT }
			}
			OR = {
				NOT = { has_character_flag = kes_conversion_done }
				had_character_flag = { flag = kes_conversion_done days = 1500 }
			}
		}

		allow = {
			war = yes
			has_society_currency_major_trigger = yes
		}

		effect = {
			random_realm_province = {
				limit = { 
					NOT = { religion = ROOT } 
					religion_group = ROOT
				}
				religion = ROOT
			}
			set_character_flag = has_character_flag
			detract_society_currency_major_effect = yes
			sound_effect = generic_click_01
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0.2 #Slowdown
			}
		}
	}
	
	white_lotus_spiritual_study = {
		ai_check_interval = 12
		is_high_prio = yes
		
		potential = {
			society_rank = {
				society = the_white_lotus
				rank >= 2
			}
			OR = {
				NOT = { has_character_flag = twl_study_done }
				had_character_flag = { flag = twl_study_done days = 1500 }
			}
		}
		
		allow = {
			prisoner = no
			NOT = { trait = incapable }
			has_society_currency_medium_trigger = yes
		}
		
		effect = {
			detract_society_currency_medium_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5207 days = 7 }
				set_character_flag = twl_study_done
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	white_lotus_attain_mastery = {
		ai_check_interval = 12
		is_high_prio = yes
		
		potential = {
			society_rank = {
				society = the_white_lotus
				rank >= 3
			}
			OR = {
				NOT = { has_character_flag = twl_mastery_done }
				had_character_flag = { flag = twl_mastery_done days = 3650 }
			}
			OR = {
				trait = waterbender
				trait = earthbender
				trait = airbender
				trait = firebender
			}
			OR = {
				NOR = {
					trait = master_bender
					trait = legendary_bender
				}
				NOR = {
					trait = lightningbender
					trait = healer
					trait = seismicsense_nonblind
					trait = airbender
				}
			}
		}
		
		allow = {
			prisoner = no
			NOT = { trait = incapable }
			has_society_currency_medium_trigger = yes
		}
		
		effect = {
			detract_society_currency_medium_effect = yes
			hidden_effect = { 
				character_event = { id = MNSAK.5212 days = 7 }
				set_character_flag = twl_mastery_done
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
}

targeted_decisions = {

	five_seven_fiver_educate_family_member = {
		ai_check_interval = 12
		filter = dynasty
		ai_target_filter = dynasty
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			dynasty = FROM
			is_adult = no
			age = 6
			NOT = { has_character_flag = received_fsf_education_before }
		}
		
		from_potential = {
			society_rank >= 2
			society_member_of = five_seven_fiver_society
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_minor_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_minor_effect = yes	###lose 150SocCur
			}
			random_list = {
				10 = {
					custom_tooltip = {
						text = fsf_boost_diplomacy
						hidden_tooltip = {
							FROM = { character_event = { id = MNSAK.4506 } }
						}
					}
				}
				10 = {
					custom_tooltip = {
						text = fsf_boost_stewardship
						hidden_tooltip = {
							FROM = { character_event = { id = MNSAK.4507 } }
						}
					}
				}
				10 = {
					custom_tooltip = {
						text = fsf_boost_learning
						hidden_tooltip = {
							FROM = { character_event = { id = MNSAK.4508 } }
						}
					}
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
	five_seven_fiver_recruit_member = {
		ai_check_interval = 12
		filter = realm
		ai_target_filter = realm
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			is_in_society = no
			is_adult = yes
			is_female = yes
		}
		
		from_potential = {
			society_rank >= 2
			society_member_of = five_seven_fiver_society
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_medium_effect = yes	###lose 150SocCur
			}
			ROOT = {
				hidden_tooltip = {
					letter_event = { id = MNSAK.5021 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	five_seven_fiver_boost_relations = {
		ai_check_interval = 12
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			is_adult = yes
		}
		
		from_potential = {
			society_rank >= 3
			society_member_of = five_seven_fiver_society
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
			has_opinion_modifier = { who = FROM modifier = opinion_fsf_entertained }
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_medium_effect = yes	###lose 150SocCur
			}
			ROOT = {
				opinion = { modifier = opinion_fsf_entertained who = FROM years = 5 }
				hidden_tooltip = {
					letter_event = { id = MNSAK.5024 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				ROOT = {
					NOT = { de_facto_liege = FROM }
				}
			}
		}
	}
	
	five_seven_fiver_gain_favour = {
		ai_check_interval = 12
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			is_adult = yes
			ai = yes
			NOT = { owes_favor_to = FROM }
		}
		
		from_potential = {
			society_rank >= 4
			society_member_of = five_seven_fiver_society
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_major_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
			has_opinion_modifier = { who = FROM modifier = opinion_fsf_entertained }
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_major_effect = yes	###lose 150SocCur
			}
			ROOT = {
				reverse_add_favor = FROM
				hidden_tooltip = {
					letter_event = { id = MNSAK.5024 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				ROOT = {
					NOT = { de_facto_liege = FROM }
				}
			}
		}
	}

	monastic_orders_spiritual_guidance = {  ### Monastic Order Rank 2 power : targeted decision to remove one of target's vices
		ai_check_interval = 12
		filter = realm
		ai_target_filter = realm
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			OR = {
				same_realm = FROM
				same_society_as = FROM
			}
			religion = FROM
		}
		
		from_potential = {
			society_rank >= 2
			society_member_of = monastic_order_elder_council
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes	###requires 300SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
			in_command = no
			same_realm = FROM
			OR = {
				is_landed = yes
				is_patrician = yes
				is_close_relative = FROM
			}
			NOT = {
				has_opinion_modifier = {	###opinion modifier 10yrs cooldown
					who =  FROM
					modifier = opinion_spiritual_guidance
				}
			}
			custom_tooltip = {
				text = spiritual_guidance_tooltip
				OR ={
					AND = {
						trait = lustful
						FROM = { NOT = { trait = lustful } }
					}
					AND = {
						trait = gluttonous
						FROM = { NOT = { trait = gluttonous } }
					}
					AND = {
						trait = greedy
						FROM = { NOT = { trait = greedy } }
					}
					AND = {
						trait = slothful
						FROM = { NOT = { trait = slothful } }
					}
					AND = {
						trait = wroth
						FROM = { NOT = { trait = wroth } }
					}
					AND = {
						trait = envious
						FROM = { NOT = { trait = envious } }
					}
					AND = {
						trait = proud
						FROM = { NOT = { trait = proud } }
					}
				}
			}
		}
		
		effect = {
			FROM = {
				detract_society_currency_medium_effect = yes	###lose 300SocCur
			}
			random_list = {				###Will randomly remove one sin that target has and you don't
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = lustful }
							FROM = { trait = lustful }
						}
					}
					set_character_flag = spiritual_guidance_lustful
					remove_trait = lustful
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = gluttonous }
							FROM = { trait = gluttonous }
						}
					}
					set_character_flag = spiritual_guidance_gluttonous
					remove_trait = gluttonous
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = greedy }
							FROM = { trait = greedy }
						}
					}
					set_character_flag = spiritual_guidance_greedy
					remove_trait = greedy
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = slothful }
							FROM = { trait = slothful }
						}
					}
					set_character_flag = spiritual_guidance_slothful
					remove_trait = slothful
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = wroth }
							FROM = { trait = wroth }
						}
					}
					set_character_flag = spiritual_guidance_wroth
					remove_trait = wroth
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = envious }
							FROM = { trait = envious }
						}
					}
					set_character_flag = spiritual_guidance_envious
					remove_trait = envious
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = proud }
							FROM = { trait = proud }
						}
					}
					set_character_flag = spiritual_guidance_proud
					remove_trait = proud
				}
			}
			opinion = {										###opinion mostly serves as a 10 years cooldown ; +5 Opinion
				who = FROM
				modifier = opinion_spiritual_guidance
				months = 120
			}
			FROM = { character_event = { id = MNSAK.3039 } }
			character_event = { id = MNSAK.3040 }
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
			modifier = {
				factor = 0
				NOT = {
					AND = {
						is_close_relative = FROM						###AI will only target landed relatives in the same realm
						same_realm = FROM
						OR = {
							is_landed = yes
							is_patrician = yes
						}
					}
				}
			}
		}
	}
	
	monastic_order_teach_airbending = {
		ai_check_interval = 24
		filter = realm
		ai_target_filter = realm
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			trait = airbender
			OR = {
				same_realm = FROM
				same_society_as = FROM
			}
		}
		
		from_potential = {
			society_rank >= 3
			society_member_of = monastic_order_elder_council
			is_adult = yes
			NOT = { trait = incapable }
			NOT = { trait = legendary_bender }
			trait = airbender
			religion = ROOT
		}
		
		allow = {
			FROM = {
				has_society_currency_major_trigger = yes	###requires 500SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
			in_command = no
			same_realm = FROM
			OR = {
				is_landed = yes
				is_patrician = yes
				is_close_relative = FROM
			}
			NOT = {
				has_opinion_modifier = {	###opinion modifier 10yrs cooldown
					who =  FROM
					modifier = opinion_teach_virtue
				}
			}
		}
		
		effect = {
			FROM = {
				detract_society_currency_major_effect = yes	###lose 500SocCur
			}
			random_list = {				###Will randomly add one virtue that you have and target doesn't
				10 = {
					modifier = {
						factor = 0.5
						trait = master_bender
					}
					modifier = {
						factor = 0.6
						trait = powerful_bender
					}
					modifier = {
						factor = 0.8
						trait = competent_bender
					}
					custom_tooltip = {
						text = teach_airbending_success
						hidden_tooltip = {
							FROM = { character_event = { id = MNSAK.3043 } }
							character_event = { id = MNSAK.3044 }
							if = {
								limit = { trait = master_bender }
								remove_trait = master_bender
								add_trait = legendary_bender
							}
							if = {
								limit = { trait = powerful_bender }
								remove_trait = powerful_bender
								add_trait = master_bender
							}
							if = {
								limit = { trait = competent_bender }
								remove_trait = competent_bender
								add_trait = powerful_bender
							}
							if = {
								limit = { trait = incompetent_bender }
								remove_trait = incompetent_bender
								add_trait = competent_bender
							}
						}
					}
				}
				10 = {
					modifier = {
						factor = 1.1
						FROM = { trait = competent_bender }
					}
					modifier = {
						factor = 1.2
						FROM = { trait = incompetent_bender }
					}
					custom_tooltip = {
						text = teach_airbending_failure
						hidden_tooltip = {
							FROM = { character_event = { id = MNSAK.3045 } }
						}
					}
				}
			}
			opinion = {										###opinion mostly serves as a 10 years cooldown ; +10 Opinion
				who = FROM
				modifier = opinion_teach_virtue
				months = 120
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
			modifier = {
				factor = 0.1
				FROM = {
					OR = {
						trait = incompetent_bender
						trait = competent_bender
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					AND = {
						is_close_relative = FROM						###AI will only target landed relatives in the same realm
						same_realm = FROM
						OR = {
							is_landed = yes
							is_patrician = yes
						}
					}
				}
			}
		}
	}
	
	monastic_orders_teach_virtue = {  ### Monastic Order Rank 3 power : targeted decision to give target a virtue
		ai_check_interval = 12
		filter = realm
		ai_target_filter = realm
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			OR = {
				same_realm = FROM
				same_society_as = FROM
			}
		}
		
		from_potential = {
			society_rank >= 3
			society_member_of = monastic_order_elder_council
			is_adult = yes
			NOT = { trait = incapable }
			religion = ROOT
		}
		
		allow = {
			FROM = {
				has_society_currency_major_trigger = yes	###requires 500SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
			in_command = no
			same_realm = FROM
			OR = {
				is_landed = yes
				is_patrician = yes
				is_close_relative = FROM
			}
			NOT = {
				has_opinion_modifier = {	###opinion modifier 10yrs cooldown
					who =  FROM
					modifier = opinion_teach_virtue
				}
			}
			custom_tooltip = {
				text = teach_virtue_tooltip
				OR ={
					AND = {
						NOT = { trait = chaste }
						FROM = { trait = chaste }
					}
					AND = {
						NOT = { trait = temperate }
						FROM = { trait = temperate }
					}
					AND = {
						NOT = { trait = charitable }
						FROM = { trait = charitable }
					}
					AND = {
						NOT = { trait = diligent }
						FROM = { trait = diligent }
					}
					AND = {
						NOT = { trait = patient }
						FROM = { trait = patient }
					}
					AND = {
						NOT = { trait = kind }
						FROM = { trait = kind }
					}
					AND = {
						NOT = { trait = humble }
						FROM = { trait = humble }
					}
				}
			}
		}
		
		effect = {
			FROM = {
				detract_society_currency_major_effect = yes	###lose 500SocCur
			}
			random_list = {				###Will randomly add one virtue that you have and target doesn't
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = chaste
							FROM = { NOT = { trait = chaste } }
						}
					}
					set_character_flag = teach_virtue_chaste
					add_trait = chaste
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = temperate
							FROM = { NOT = { trait = temperate } }
						}
					}
					set_character_flag = teach_virtue_temperate
					add_trait = temperate
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = charitable
							FROM = { NOT = { trait = charitable } }
						}
					}
					set_character_flag = teach_virtue_charitable
					add_trait = charitable
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = diligent
							FROM = { NOT = { trait = diligent } }
						}
					}
					set_character_flag = teach_virtue_diligent
					add_trait = diligent
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = patient
							FROM = { NOT = { trait = patient } }
						}
					}
					set_character_flag = teach_virtue_patient
					add_trait = patient
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = kind
							FROM = { NOT = { trait = kind } }
						}
					}
					set_character_flag = teach_virtue_kind
					add_trait = kind
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = humble
							FROM = { NOT = { trait = humble } }
						}
					}
					set_character_flag = teach_virtue_humble
					add_trait = humble
				}
			}
			opinion = {										###opinion mostly serves as a 10 years cooldown ; +10 Opinion
				who = FROM
				modifier = opinion_teach_virtue
				months = 120
			}
			FROM = { character_event = { id = MNSAK.3041 } }
			character_event = { id = MNSAK.3042 }
		}
		
		revoke_allowed = {
		always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
			modifier = {
				factor = 0
				NOT = {
					AND = {
						is_close_relative = FROM						###AI will only target landed relatives in the same realm
						same_realm = FROM
						OR = {
							is_landed = yes
							is_patrician = yes
						}
					}
				}
			}
		}
	}

	challenge_fellow_member_to_spar = {
		is_in_society = yes
		
		filter = society
		ai_target_filter = society
		
		potential = {
			is_adult = yes
			NOT = { trait = incapable }
			society_member_of = brotherhood_of_agni_kai
			OR = {
				NOT = { has_character_flag = recently_refused_spar }
				had_character_flag = { flag = recently_refused_spar days = 930 }
			}
		}
		
		from_potential = {
			society_member_of = brotherhood_of_agni_kai
			is_adult = yes
			NOT = { trait = incapable }
		}

		allow = {
			FROM = {
				has_society_currency_tiny_trigger = yes
				prisoner = no
				custom_tooltip = {
					text = cannot_challenge_higher_ranked_member
					hidden_tooltip = {
						ROOT = {
							NOT = { higher_tier_than = FROM }
						}
					}
				}
				custom_tooltip = {
					text = has_not_sparred_recently
					hidden_tooltip = {
						OR = {
							NOT = { has_character_flag = recent_spar }
							had_character_flag = { flag = recent_spar days = 730 }
						}
					}
				}
			}
		}

		effect = {
			FROM = {
				detract_society_currency_tiny_effect = yes
				hidden_tooltip = {
					ROOT = {
						character_event = { id = MNSAK.5048 }
					}
				}
			}
		}

		revoke_allowed = { always = no }

		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0.2
				ROOT = {
					has_character_flag = recent_spar
				}
			}
			modifier = {
				factor = 0.5
			}
			modifier = {
				factor = 0.5
				is_dumb_trigger = yes
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 0.5
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = ambitious
			}
		}
	}
	
	bak_recruit_member = {
		ai_check_interval = 12
		filter = realm
		ai_target_filter = home_court
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			is_in_society = no
			is_adult = yes
			trait = firebender
		}
		
		from_potential = {
			society_rank >= 2
			society_member_of = brotherhood_of_agni_kai
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_minor_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_minor_effect = yes	###lose 150SocCur
			}
			ROOT = {
				hidden_tooltip = {
					letter_event = { id = MNSAK.5061 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
	bak_instruct_others = {
		ai_check_interval = 12
		filter = realm
		ai_target_filter = home_court
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			is_in_society = no
			is_adult = no
			trait = firebender
			NOT = { has_character_flag = received_bak_education_before }
			NOR = { 
				trait = legendary_bender
				trait = master_bender
			}
		}
		
		from_potential = {
			society_rank >= 3
			society_member_of = brotherhood_of_agni_kai
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_major_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_major_effect = yes	###lose 150SocCur
			}
			ROOT = {
				set_character_flag = received_bak_education_before
				if = {
					limit = {
						trait = powerful_bender
					}
					remove_trait = powerful_bender 
					add_trait = master_bender
				}
				if = {
					limit = {
						trait = competent_bender
					}
					remove_trait = competent_bender 
					add_trait = powerful_bender
				}
				if = {
					limit = {
						trait = incompetent_bender
					}
					remove_trait = incompetent_bender 
					add_trait = competent_bender
				}
				hidden_tooltip = {
					character_event = { id = MNSAK.5064 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
	tes_inflict_terror = {
		ai_check_interval = 12
		filter = realm
		ai_target_filter = rivals
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			NOT = { society_member_of = the_enlightened }
			OR = {
				NOT = { has_character_flag = recently_tes_terror }
				had_character_flag = { flag = recently_tes_terror days = 3650 }
			}
			is_adult = yes
		}
		
		from_potential = {
			society_rank >= 2
			society_member_of = the_enlightened
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_medium_effect = yes	###lose 150SocCur
				increase_visibility_effect = yes
			}
			ROOT = {
				set_character_flag = recently_tes_terror
				hidden_tooltip = {
					character_event = { id = MNSAK.5098 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
	ks_scare_ruler = {
		ai_check_interval = 16
		filter = realm
		ai_target_filter = rivals
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			NOT = { society_member_of = the_kemurikage_sisterhood }
			OR = {
				NOT = { has_character_flag = recently_ks_scare }
				had_character_flag = { flag = recently_ks_scare days = 3650 }
			}
			religion_group = fire_religions
			NOT = { has_landed_title = e_fire_nation }
			is_adult = yes
			OR = {
				has_character_flag = ks_valid_target
				trait = cruel
				trait = arbitrary
				trait = greedy
				top_liege = {
					NOT = { religion = ROOT }
				}
			}
		}
		
		from_potential = {
			society_rank >= 2
			society_member_of = the_kemurikage_sisterhood
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_medium_effect = yes	###lose 150SocCur
				increase_visibility_effect = yes
			}
			ROOT = {
				set_character_flag = recently_ks_scare
				hidden_tooltip = {
					character_event = { id = MNSAK.5155 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
	ks_poison_effect = {
		ai_check_interval = 16
		filter = realm
		ai_target_filter = rivals
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			NOT = { society_member_of = the_kemurikage_sisterhood }
			OR = {
				NOT = { has_character_flag = recently_ks_poison }
				had_character_flag = { flag = recently_ks_poison days = 3650 }
			}
			religion_group = fire_religions
			NOT = { has_landed_title = e_fire_nation }
			is_adult = yes
		}
		
		from_potential = {
			society_rank >= 2
			society_member_of = the_kemurikage_sisterhood
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_medium_effect = yes	###lose 150SocCur
				increase_visibility_effect = yes
			}
			ROOT = {
				set_character_flag = recently_ks_poison
				hidden_tooltip = {
					character_event = { id = MNSAK.5180 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
	# ks_invite_member = {
		# ai_check_interval = 12
		# filter = realm
		# ai_target_filter = home_court
		# is_in_society = yes
		
		# potential = {
			# NOT = { trait = incapable }
			# is_in_society = no
			# is_adult = yes
			# female = yes
			# trait = firebender
		# }
		
		# from_potential = {
			# society_rank >= 2
			# society_member_of = the_kemurikage_sisterhood
			# is_adult = yes
			# NOT = { trait = incapable }
		# }
		
		# allow = {
			# FROM = {
				# has_society_currency_medium_trigger = yes	###requires 150SocCur
				# is_inaccessible_trigger = no
				# prisoner = no
				# in_command = no
			# }
			# is_inaccessible_trigger = no
			# prisoner = no
		# }
		
		# revoke_allowed = {
			# always = no
		# }
		
		# effect = {
			# FROM = {
				# detract_society_currency_medium_effect = yes	###lose 150SocCur
			# }
			# ROOT = {
				# hidden_tooltip = {
					# letter_event = { id = MNSAK.4514 } 
				# }
			# }
		# }
		
		# ai_will_do = {
			# factor = 1
			# modifier = {
				# factor = 0.1
			# }
		# }
	# }
	
	ks_mark_for_punishment = {
		ai_check_interval = 16
		filter = realm
		ai_target_filter = rivals
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			NOT = { society_member_of = the_kemurikage_sisterhood }
			OR = {
				NOT = { has_character_flag = recently_ks_scare }
				NOT = { has_character_flag = ks_valid_target }
				had_character_flag = { flag = recently_ks_scare days = 3650 }
			}
			religion_group = fire_religions
			NOT = { has_landed_title = e_fire_nation }
			is_adult = yes
		}
		
		from_potential = {
			society_rank >= 4
			society_member_of = the_kemurikage_sisterhood
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_medium_effect = yes	###lose 150SocCur
			}
			ROOT = {
				set_character_flag = ks_valid_target
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
	tes_invite_member = {
		ai_check_interval = 12
		filter = realm
		ai_target_filter = realm
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			is_in_society = no
			is_adult = yes
			has_vice_trigger = yes
			OR = {
				religion = witchcraft
				religion = tui_and_la
				religion = nomadic_nihilism
				religion = barbarism
			}
		}
		
		from_potential = {
			society_rank >= 2
			society_member_of = the_enlightened
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_medium_effect = yes	###lose 150SocCur
			}
			ROOT = {
				hidden_tooltip = {
					set_character_flag = enlightened_attempted_recruitment
					set_character_flag = being_recruited_by_the_enlightened
					character_event = { id = MNSAK.4528 }
				}
			}
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	tes_eliminate_rival = {
		ai_check_interval = 12
		filter = realm
		ai_target_filter = rivals
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
			NOT = { society_member_of = the_enlightened }
			is_adult = yes
		}
		
		from_potential = {
			society_rank >= 4
			society_member_of = the_enlightened
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_major_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_major_effect = yes	###lose 150SocCur
				increase_visibility_effect = yes
			}
			ROOT = {
				hidden_tooltip = {
					character_event = { id = MNSAK.5116 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
			}
		}
	}
	
	white_lotus_safeguard = {
		ai_check_interval = 12
		filter = realm
		ai_target_filter = dynasty
		is_in_society = yes
		
		potential = {
			NOT = { trait = incapable }
		}
		
		from_potential = {
			society_member_of = the_white_lotus
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_minor_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_minor_effect = yes	###lose 150SocCur
			}
			ROOT = {
				add_character_modifier = {
					name = white_lotus_safeguard_effect
					days = 1825
				}
				hidden_tooltip = {
					character_event = { id = MNSAK.5205 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}

	white_lotus_pacify_rebellion = {
		ai_check_interval = 12
		filter = independent_rulers
		ai_target_filter = independent_rulers
		is_in_society = yes
		only_playable = yes
		
		potential = {
			NOT = { trait = incapable }
			rebel = yes
			any_war = { 
				OR = {
					using_cb = peasant_revolt
					using_cb = heretic_revolt
					using_cb = religious_revolt
					using_cb = liberation_revolt
				}
			}
		}
		
		from_potential = {
			society_rank = {
				society = the_white_lotus
				rank >= 3
			}
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_medium_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_medium_effect = yes	###lose 150SocCur
			}
			ROOT = {
				hidden_tooltip = {
					character_event = { id = MNSAK.5218 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
	white_lotus_investigate_court = {
		ai_check_interval = 12
		filter = independent_rulers
		ai_target_filter = independent_rulers
		is_in_society = yes
		only_playable = yes
		
		potential = {
			NOT = { trait = incapable }
			is_landed = yes
		}
		
		from_potential = {
			society_rank = {
				society = the_white_lotus
				rank >= 2
			}
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_minor_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_minor_effect = yes	###lose 150SocCur
			}
			ROOT = {
				hidden_tooltip = {
					character_event = { id = MNSAK.5222 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
	white_lotus_stir_rebellion = {
		ai_check_interval = 12
		filter = independent_rulers
		ai_target_filter = independent_rulers
		is_in_society = yes
		only_playable = yes
		
		potential = {
			NOT = { trait = incapable }
			NOT = { society_member_of = the_white_lotus }
			is_landed = yes
		}
		
		from_potential = {
			society_rank = {
				society = the_white_lotus
				rank >= 4
			}
			is_adult = yes
			NOT = { trait = incapable }
		}
		
		allow = {
			FROM = {
				has_society_currency_major_trigger = yes	###requires 150SocCur
				is_inaccessible_trigger = no
				prisoner = no
				in_command = no
			}
			is_inaccessible_trigger = no
			prisoner = no
		}
		
		revoke_allowed = {
			always = no
		}
		
		effect = {
			FROM = {
				detract_society_currency_major_effect = yes	###lose 150SocCur
			}
			ROOT = {
				hidden_tooltip = {
					character_event = { id = MNSAK.5220 } 
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
			}
		}
	}
	
}