namespace = avatar

character_event = { # Master is asked to take avatar under his wing
	id = avatar.152
	is_triggered_only = yes
	picture = GFX_evt_landscape_2
	desc = {
		trigger = {
			trait = earthbender
		}
		text = EVTDESCbendingA.152
	}
	desc = {
		trigger = {
			trait = waterbender
		}
		text = EVTDESCbendingB.152
	}
	desc = {
		trigger = {
			trait = airbender
		}
		text = EVTDESCbendingC.152
	}
	desc = {
		trigger = {
			trait = firebender
		}
		text = EVTDESCbendingD.152
	}

	option = { #I will teach
		name = EVTOPTAbending.152
		ai_chance = {
			factor = 100
		}
		hidden_tooltip = {
		# LOOK
			if = {
				limit = {
					is_ruler = yes
				}
				FROM = { move_character = ROOT }
				FROM = { give_minor_title = title_avatar }
			}
			if = {
				limit = {
					is_ruler = no
				}
				liege = {
					FROM = { move_character = PREV }
					FROM = { give_minor_title = title_avatar }
				}
			}
			save_event_target_as = avatar_master
			find_avatar_effect = yes
			if = {
				limit = {
					event_target:avatar_master = {
						is_landed = yes
					}
				}
				event_target:avatar_master = {
					move_avatar_effect = yes
				}
			}
			else = {
				event_target:avatar_master = {
					suzerain = {
						move_avatar_effect = yes
					}
				}
			}

			FROM = { character_event = { id = avatar.155 days = 10 random = 20 } }
		}
	}
}

#
character_event = { # Avatar Training
	id = avatar.155
	desc = EVTDESCbending.155
	is_triggered_only = yes
	picture = GFX_evt_family

	trigger = {
		has_character_flag = avatar_journey
	}

	option = {
		name = EVTOPTAbending.155
		random_list = {
			15 = { # Good Progress
				custom_tooltip = {
					text = good_progress_tt
					FROM = { character_event = { id = avatar.171 days = 10 random = 20 } }
				}
				modifier = {
					factor = 2
					FROM = {
						OR = {
							trait = legendary_bender
							trait = diligent
						}
					}
				}
			}
			35 = { # Progress
				custom_tooltip = {
					text = progress_tt
					FROM = { character_event = { id = avatar.172 days = 10 random = 20 } }
				}
			}
			30 = { # Trouble
				custom_tooltip = {
					text = trouble_tt
					FROM = { character_event = { id = avatar.173 days = 10 random = 20 } }
				}
				modifier = {
					factor = 2
					FROM = {
						OR = {
							trait = master_bender
							trait = slothful
						}
					}
				}
			}
			20 = { # Bad Trouble
				custom_tooltip = {
					text = bad_trouble_tt
					FROM = { character_event = { id = avatar.174 days = 10 random = 20 } }
				}
			}
		}
	}
}

character_event = { #avatar training - complete
	id = avatar.158
	desc = EVTDESCbending.158
	is_triggered_only = yes
	picture = GFX_evt_family

	trigger = {
		has_character_flag = avatar_journey
	}
	immediate = {
		clear_event_target = avatar_master
	}
	option = {
		name = EVTOPTAavatar.158
		trigger = {
			OR = {
				AND = {
					trait = firebender
					AND = {
						trait = avatar_waterbender
						trait = avatar_airbender
						trait = avatar_earthbender
					}
				}
				AND = {
					trait = waterbender
					AND = {
						trait = avatar_airbender
						trait = avatar_earthbender
						trait = avatar_firebender
					}
				}
				AND = {
					trait = earthbender
					AND = {
						trait = avatar_waterbender
						trait = avatar_airbender
						trait = avatar_firebender
					}
				}
				AND = {
					trait = airbender
					AND = {
						trait = avatar_waterbender
						trait = avatar_earthbender
						trait = avatar_firebender
					}
				}
			}
		}
		character_event = { id = avatar.160 }
	}
	option = {
		name = EVTOPTAavatar.158
		trigger = {
			NOR = {
				AND = {
					trait = firebender
					AND = {
						trait = avatar_waterbender
						trait = avatar_airbender
						trait = avatar_earthbender
					}
				}
				AND = {
					trait = waterbender
					AND = {
						trait = avatar_airbender
						trait = avatar_earthbender
						trait = avatar_firebender
					}
				}
				AND = {
					trait = earthbender
					AND = {
						trait = avatar_waterbender
						trait = avatar_airbender
						trait = avatar_firebender
					}
				}
				AND = {
					trait = airbender
					AND = {
						trait = avatar_waterbender
						trait = avatar_earthbender
						trait = avatar_firebender
					}
				}
			}
		}
		hidden_tooltip = {
			clr_character_flag = avatar_first_master
			clr_character_flag = master_found
			character_event = { id = avatar.159 }
		}
	}
}

character_event = { # Roku continues his training
	id = avatar.1590
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_character_flag = avatar_journey
		has_character_flag = is_roku
	}

	immediate = {
		character_event = { id = avatar.159 days = 1 }
	}
}

character_event = { #next master is searched for - fires for avatar
	id = avatar.159
	desc = EVTDESCbending.159
	is_triggered_only = yes
	picture = GFX_evt_family

	trigger = {
		has_character_flag = avatar_journey
		NOR = {
			has_character_flag = master_found
			has_character_flag = master_searching
		}
	}

	option = { #search in the earth kingdoms
	name = EVTDESCaavatar.159
		trigger = {
			OR = {
				AND = {
					trait = airbender
					trait = avatar_waterbender
					NOT = { trait = avatar_earthbender }
				}
				AND = {
					trait = firebender
					trait = avatar_airbender
					trait = avatar_waterbender
					NOT = { trait = avatar_earthbender }
				}
				AND = {
					trait = waterbender
					NOT = { trait = avatar_earthbender }
				}
			}
		}
		set_character_flag = master_searching
		character_event = { id = avatar.168 } #earth
	}
	option = { #search in among the air Nomads
	name = EVTDESCbavatar.159
		trigger = {
			OR = {
				AND = {
					trait = earthbender
					trait = avatar_firebender
					NOT = { trait = avatar_airbender }
				}
				AND = {
					trait = waterbender
					trait = avatar_earthbender
					trait = avatar_firebender
					NOT = { trait = avatar_airbender }
				}
			}
		}
		set_character_flag = master_searching
		# air
		character_event = { id = new_avatar_journey.400 days = 10 }
	}
	option = {
	name = EVTDESCcavatar.159
		trigger = { #search in water tribes
			OR = { #event 167
				AND = {
					trait = earthbender
					trait = avatar_firebender
					trait = avatar_airbender
					NOT = { trait = avatar_waterbender }
				}
				AND = {
					trait = firebender
					trait = avatar_airbender
					NOT = { trait = avatar_waterbender }
				}
				AND = {
					trait = airbender
					NOT = { trait = avatar_waterbender }
				}
			}
		}
		set_character_flag = master_searching
		character_event = { id = avatar.167 } #water
	}
	option = { #search in fire nation
	name = EVTDESCdbavatar.159
		trigger = { #event 165
			OR = {
				AND = {
					trait = waterbender
					trait = avatar_earthbender
					NOT = { trait = avatar_firebender }
				}
				AND = {
					trait = airbender
					trait = avatar_waterbender
					trait = avatar_earthbender
					NOT = { trait = avatar_firebender }
				}
				AND = {
					trait = earthbender
					NOT = { trait = avatar_firebender }
				}
			}
		}
		set_character_flag = master_searching
		character_event = { id = avatar.165 } #fire
	}

	after = {
		hidden_tooltip = {
			switch_learning_bending = yes
		}
	}
}

character_event = { #all training is completed
	id = avatar.160
	desc = EVTDESCbending.160
	is_triggered_only = yes
	picture = GFX_evt_family

	trigger = {
		has_character_flag = avatar_journey
	}

	option = {
		name = EVTDESCAavatar.160
		if = {
			limit = {
				OR = {
					trait = competent_bender
					trait = powerful_bender
				}
			}
			add_trait = master_bender
		}
		add_trait = fullyrealisedavatar
		hidden_tooltip = {
			clr_character_flag = avatar_journey
			clr_character_flag = master_searching
			clr_character_flag = master_found
			finish_learning_elements_effect = yes
			remove_trait = avatar
			character_event = { id = avatar.170 days = 60 random = 180 }
			d_the_sages = {
				grant_title = ROOT
			}
		}
		remove_trait = avatar_on_training
	}
}

character_event = { #fire
	id = avatar.165
	desc = avatar_firebendingteacher_desc
	is_triggered_only = yes
	picture = GFX_evt_fire_nation_harbor

	trigger = {
		NOT = { trait = avatar_firebender }
		has_character_flag = avatar_journey
	}

	option = {
		name = EVTDESCAavatar.165
		trigger = {
			any_independent_ruler = {
				trait = firebender
				is_adult = yes
				NOT = { age = 60 }
				more_experienced_competent_trigger = yes
			}
		}
		random_independent_ruler = {
			limit = {
				trait = firebender
				is_adult = yes
				NOT = { age = 60 }
				more_experienced_competent_trigger = yes
			}
			character_event = { id = avatar.152 days = 50 }
		}
		set_character_flag = master_found
		clr_character_flag = master_searching
	}
	option = {
		name = EVTDESCBavatar.165
		trigger = {
			any_independent_ruler = {
				any_realm_character = {
					trait = firebender
					is_adult = yes
					NOT = { age = 60 }
					more_experienced_competent_trigger = yes
				}
			}
			NAND = {
				any_independent_ruler = {
					trait = firebender
					is_adult = yes
					NOT = { age = 60 }
					more_experienced_competent_trigger = yes
				}
			}
		}
		random_independent_ruler = {
			limit = {
				any_realm_character = {
					AND = {
						trait = firebender
						is_adult = yes
						NOT = { age = 60 }
						more_experienced_competent_trigger = yes
					}
				}
			}
			random_realm_character = {
				limit = {
					AND = {
						trait = firebender
						is_adult = yes
						NOT = { age = 60 }
						more_experienced_competent_trigger = yes
					}
				}
				character_event = { id = avatar.152 days = 50 }
			}
		}
		set_character_flag = master_found
		clr_character_flag = master_searching
	}
	option = {
		name = EVTDESCCavatar.165
		trigger = {
			NAND = {
				any_independent_ruler = {
					trait = firebender
					is_adult = yes
					NOT = { age = 60 }
					more_experienced_competent_trigger = yes
				}
			}
			NAND = {
				any_independent_ruler = {
					any_realm_character = {
						trait = firebender
						is_adult = yes
						NOT = { age = 60 }
						more_experienced_competent_trigger = yes
					}
				}
			}
		}
		random_playable_ruler = {
			limit = {
				opinion = { who = ROOT value = 10 }
				trait = firebender
			}
			create_character = {
				age = 30
				dynasty = none
				random_traits = yes
				trait = tough_soldier
				trait = firebender
				trait = powerful_bender
				religion = PREV
				culture = PREV
				attributes = { martial = 5 learning = 7 }
			}
			random_courtier = {
				limit = {
					trait = firebender
					trait = powerful_bender
				}
				character_event = { id = avatar.152 days = 50 }
			}
		}
		set_character_flag = master_found
		clr_character_flag = master_searching
	}
}

character_event = { #water
	id = avatar.167
	desc = avatar_waterbendingteacher_desc
	is_triggered_only = yes
	picture = GFX_evt_northern_water_tribe_wall

	trigger = {
		NOT = { trait = avatar_waterbender }
		has_character_flag = avatar_journey
	}

	# search for a master among the rulers
	option = {
		name = EVTDESCAavatar.165
		trigger = {
			any_independent_ruler = {
				trait = waterbender
				is_adult = yes
				NOT = { age = 60 }
				more_experienced_competent_trigger = yes
			}
		}
		random_independent_ruler = {
			limit = {
				trait = waterbender
				is_adult = yes
				NOT = { age = 60 }
				more_experienced_competent_trigger = yes
			}
			character_event = { id = avatar.152 days = 50 }
		}
		set_character_flag = master_found
		clr_character_flag = master_searching
	}

	# search for a master among the rulers' courts
	option = {
		name = EVTDESCAavatar.165
		trigger = {
			any_independent_ruler = {
				any_realm_character = {
					trait = waterbender
					is_adult = yes
					NOT = { age = 60 }
					more_experienced_competent_trigger = yes
				}
			}
			NAND = {
				any_independent_ruler = {
					trait = waterbender
					is_adult = yes
					NOT = { age = 60 }
					more_experienced_competent_trigger = yes
				}
			}
		}
		random_independent_ruler = {
			limit = {
				any_realm_character = {
					AND = {
						trait = waterbender
						is_adult = yes
						NOT = { age = 60 }
						more_experienced_competent_trigger = yes
					}
				}
			}
			random_realm_character = {
				limit = {
					AND = {
						trait = waterbender
						is_adult = yes
						NOT = { age = 60 }
						more_experienced_competent_trigger = yes
					}
				}
				character_event = { id = avatar.152 days = 50 }
			}
		}
		set_character_flag = master_found
		clr_character_flag = master_searching
	}

	# if we found nothing, just generate yourself a master!
	option = {
		name = EVTDESCAavatar.165
		trigger = {
			NAND = {
				any_independent_ruler = {
					trait = waterbender
					is_adult = yes
					NOT = { age = 60 }
					more_experienced_competent_trigger = yes
				}
			}
			NAND = {
				any_independent_ruler = {
					any_realm_character = {
						trait = waterbender
						is_adult = yes
						NOT = { age = 60 }
						more_experienced_competent_trigger = yes
					}
				}
			}
		}
		random_playable_ruler = {
			limit = {
				trait = waterbender
				opinion = { who = ROOT value = 10 }
			}
			create_character = {
				age = 30
				dynasty = none
				random_traits = yes
				trait = tough_soldier
				trait = waterbender
				trait = powerful_bender
				religion = PREV
				culture = PREV
				attributes = { martial = 5 learning = 5 }
			}
			random_courtier = {
				limit = {
					trait = waterbender
					trait = powerful_bender
				}
				character_event = { id = avatar.152 days = 50 }
			}
		}
		set_character_flag = master_found
		clr_character_flag = master_searching
	}
}

character_event = { #earth
	id = avatar.168
	desc = avatar_e
	is_triggered_only = yes
	picture = GFX_evt_earth_kingdom

	trigger = {
		NOT = { trait = avatar_earthbender }
		has_character_flag = avatar_journey
	}

	# search for a master among the rulers
	option = {
		name = EVTDESCAavatar.165
		trigger = {
			any_independent_ruler = {
				trait = earthbender
				is_adult = yes
				NOT = { age = 60 }
				more_experienced_competent_trigger = yes
			}
		}
		random_independent_ruler = {
			limit = {
				trait = earthbender
				is_adult = yes
				NOT = { age = 60 }
				more_experienced_competent_trigger = yes
			}
			character_event = { id = avatar.152 days = 50 }
		}
		set_character_flag = master_found
		clr_character_flag = master_searching
	}

	# search for a master among the rulers' courts
	option = {
		name = EVTDESCAavatar.165
		trigger = {
			any_independent_ruler = {
				any_realm_character = {
					trait = earthbender
					is_adult = yes
					NOT = { age = 60 }
					more_experienced_competent_trigger = yes
				}
			}
			NAND = {
				any_independent_ruler = {
					trait = earthbender
					is_adult = yes
					NOT = { age = 60 }
					more_experienced_competent_trigger = yes
				}
			}
		}
		random_independent_ruler = {
			limit = {
				any_realm_character = {
					AND = {
						trait = earthbender
						is_adult = yes
						NOT = { age = 60 }
						more_experienced_competent_trigger = yes
					}
				}
			}
			random_realm_character = {
				limit = {
					AND = {
						trait = earthbender
						is_adult = yes
						NOT = { age = 60 }
						more_experienced_competent_trigger = yes
					}
				}
				character_event = { id = avatar.152 days = 50 }
			}
		}
		set_character_flag = master_found
		clr_character_flag = master_searching
	}

	# if we found nothing, just generate yourself a master!
	option = {
		name = EVTDESCCavatar.165
		trigger = {
			NAND = {
				any_independent_ruler = {
					trait = earthbender
					is_adult = yes
					NOT = { age = 60 }
					more_experienced_competent_trigger = yes
				}
			}
			NAND = {
				any_independent_ruler = {
					any_realm_character = {
						trait = earthbender
						is_adult = yes
						NOT = { age = 60 }
						more_experienced_competent_trigger = yes
					}
				}
			}
		}
		random_playable_ruler = {
			limit = {
				trait = earthbender
				opinion = { who = ROOT value = 10 }
			}
			create_character = {
				age = 30
				dynasty = none
				random_traits = yes
				trait = tough_soldier
				trait = earthbender
				trait = powerful_bender
				religion = PREV
				culture = PREV
				attributes = { martial = 5 learning = 5 }
			}
			random_courtier = {
				limit = {
					trait = earthbender
					trait = powerful_bender
				}
				character_event = { id = avatar.152 days = 50 }
			}
		}
		set_character_flag = master_found
		clr_character_flag = master_searching
	}
}

character_event = { #avatar gains animal guide
	id = avatar.170
	desc = EVTDESCavatar.170
	is_triggered_only = yes
	picture = GFX_evt_family

	trigger = {
		NOT = { has_character_flag = avatar_guide }
	}

	option = { #Avatar finds Animal Guide (TO BE EXPANDED)
		name = EVTOPT_avatar.170
		hidden_tooltip = {
			set_character_flag = avatar_guide
			if = {
				limit = {
					culture_group = fire_nation_culture
					NOT = {
						any_artifact = {
							has_artifact_flag = pet
						}
					}
				}
				random_list = {
					5 = {
						add_artifact = petDragon
						modifier = {
							factor = 100
							has_character_flag = is_roku
						}
						modifier = {
							factor = 2
							trait = master_bender
						}
						modifier = {
							factor = 2
							trait = temperate
						}
						modifier = {
							factor = 2
							trait = humble
						}
						modifier = {
							factor = 2
							trait = just
						}
						modifier = {
							factor = 0.1
							trait = greedy
						}
					}
					5 = {
						add_artifact = petFireFerret
						modifier = {
							factor = 3
							trait = kind
						}
						modifier = {
							factor = 3
							trait = charitable
						}
						modifier = {
							factor = 3
							trait = patient
						}
					}
					5 = {
						add_artifact = petEelHound
						modifier = {
							factor = 3
							trait = proud
						}
						modifier = {
							factor = 3
							trait = ambitious
						}
						modifier = {
							factor = 3
							trait = cruel
						}
					}
					5 = {
						add_artifact = petCat
						modifier = {
							factor = 3
							trait = content
						}
						modifier = {
							factor = 3
							trait = genius
						}
					}
				}
			}
			if = {
				limit = {
					culture_group = air_nomad_culture
					NOT = {
						any_artifact = {
							has_artifact_flag = pet
						}
					}
				}
				random_list = {
				10 = {
					add_artifact = petSkybison
					modifier = {
						factor = 2
						trait = patient
					}
				}
				5 = {
					add_artifact = petWingedLemur
					modifier = {
						factor = 3
						trait = kind
					}
				}
				}
			}
			if = {
				limit = {
					culture_group = water_tribe_culture
					NOT = {
						any_artifact = {
							has_artifact_flag = pet
						}
					}
				}
				random_list = {
				10 = {
					add_artifact = petArcticCamel
					modifier = {
						factor = 2
						trait = humble
					}
				}
				10 = {
					add_artifact = petBuffaloYak
					modifier = {
						factor = 2
						trait = content
					}
				}
				1 = {
					add_artifact = petPolarBearDog
					modifier = {
						factor = 2
						trait = proud
					}
				}
				}
			}
			if = {
				limit = {
					culture_group = earth_kingdom_culture
					NOT = {
						any_artifact = {
							has_artifact_flag = pet
						}
					}
				}
				random_list = {
				5 = {
					add_artifact = petOstrichHorse
					modifier = {
						factor = 2
						trait = patient
					}
				}
				5 = {
					add_artifact = petGiantRhinocerosBeetle
					modifier = {
						factor = 2
						trait = sandbender
					}
				}
				5 = {
					add_artifact = petGiantRhinocerosBeetle
					modifier = {
						factor = 2
						trait = proud
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 2
						trait = cruel
					}
				}
				1 = {
					add_artifact = petGoatGorilla
					modifier = {
						factor = 2
						trait = genius
					}
				}
				5 = {
					add_artifact = petDog
					modifier = {
						factor = 2
						trait = humble
					}
				}
				5 = {
					add_artifact = petCat
					modifier = {
						factor = 2
						trait = temperate
					}
				}
				}
			}
		}
	}
}

character_event = { # AVATAR TRAINING: Good Progress
	id = avatar.171
	is_triggered_only = yes
	picture = GFX_evt_landscape_2
	desc = {
		trigger = {
			trait = earthbender
		}
		text = EVTDESCavatarA.171
	}
	desc = {
		trigger = {
			trait = waterbender
		}
		text = EVTDESCavatarB.171
	}
	desc = {
		trigger = {
			trait = airbender
		}
		text = EVTDESCavatarC.171
	}
	desc = {
		trigger = {
			trait = firebender
		}
		text = EVTDESCavatarD.171
	}

	option = {
		name = EVTOPTbending.171
		add_trait = diligent
		hidden_tooltip = {
			if = {
				limit = {
					FROM = { trait = powerful_bender }
				}
				FROM = { add_trait = master_bender }
			}
			FROM = { character_event = { id = avatar.177 days = 60 random = 90 } }
		}
	}
}
character_event = { # AVATAR TRAINING: Progress
	id = avatar.172
	is_triggered_only = yes
	picture = GFX_evt_landscape_2
	desc = {
		trigger = {
			trait = earthbender
		}
		text = EVTDESCavatarA.172
	}
	desc = {
		trigger = {
			trait = waterbender
		}
		text = EVTDESCavatarB.172
	}
	desc = {
		trigger = {
			trait = airbender
		}
		text = EVTDESCavatarC.172
	}
	desc = {
		trigger = {
			trait = firebender
		}
		text = EVTDESCavatarD.172
	}

	option = {
		name = EVTOPTbending.172
		add_trait = patient
		hidden_tooltip = {
			FROM = { character_event = { id = avatar.177 days = 60 random = 90 } }
		}
	}
}

character_event = { # AVATAR TRAINING: Arguement
	id = avatar.173
	is_triggered_only = yes
	picture = GFX_evt_landscape_2
	desc = {
		trigger = {
			trait = earthbender
		}
		text = EVTDESCavatarA.173
	}
	desc = {
		trigger = {
			trait = waterbender
		}
		text = EVTDESCavatarB.173
	}
	desc = {
		trigger = {
			trait = airbender
		}
		text = EVTDESCavatarC.173
	}
	desc = {
		trigger = {
			trait = firebender
		}
		text = EVTDESCavatarD.173
	}

	option = {
		name = EVTOPTAbending.173
		hidden_tooltip = {
			FROM = { character_event = { id = avatar.177 days = 60 random = 90 } }
		}
	}

	option = {
		name = EVTOPTBbending.173
		hidden_tooltip = {
			FROM = { character_event = { id = avatar.178 days = 60 random = 90 } }
		}
	}
}

character_event = { # AVATAR TRAINING: Incident
	id = avatar.174
	is_triggered_only = yes
	picture = GFX_evt_landscape_2
	desc = {
		trigger = {
			trait = earthbender
		}
		text = EVTDESCavatarA.174
	}
	desc = {
		trigger = {
			trait = waterbender
		}
		text = EVTDESCavatarB.174
	}
	desc = {
		trigger = {
			trait = airbender
		}
		text = EVTDESCavatarC.174
	}
	desc = {
		trigger = {
			trait = firebender
		}
		text = EVTDESCavatarD.174
	}

	option = {
		name = EVTOPTAbending.174
		wealth = -50
		piety = 50
		hidden_tooltip = {
			FROM = { character_event = { id = avatar.177 days = 60 random = 90 } }
		}
	}

	option = {
		name = EVTOPTBbending.174
		wealth = -50
		prestige = -50
		hidden_tooltip = {
			FROM = { character_event = { id = avatar.178 days = 60 random = 90 } }
		}
	}
}

character_event = { # AVATAR TRAINING: Complete - POS
	id = avatar.175
	is_triggered_only = yes
	picture = GFX_evt_cliff_face
	desc = {
		trigger = {
			trait = earthbender
		}
		text = EVTDESCavatarA.175
	}
	desc = {
		trigger = {
			trait = waterbender
		}
		text = EVTDESCavatarB.175
	}
	desc = {
		trigger = {
			trait = airbender
		}
		text = EVTDESCavatarC.175
	}
	desc = {
		trigger = {
			trait = firebender
		}
		text = EVTDESCavatarD.175
	}

	option = {
		name = EVTOPTbending.175
		if = {
			limit = {
				trait = earthbender
			}
			FROM = { add_trait = avatar_earthbender }
		}
		if = {
			limit = {
				trait = airbender
			}
			FROM = { add_trait = avatar_airbender }
		}
		if = {
			limit = {
				trait = firebender
			}
			FROM = { add_trait = avatar_firebender }
		}
		if = {
			limit = {
				trait = waterbender
			}
			FROM = { add_trait = avatar_waterbender }
		}
		FROM = { add_friend = ROOT }
		hidden_tooltip = {
			FROM = { character_event = { id = avatar.158 days = 3 random = 7 } }
		}
	}

}

character_event = { # AVATAR TRAINING: Complete - NEG
	id = avatar.176
	is_triggered_only = yes
	picture = GFX_evt_cliff_face
	desc = {
		trigger = {
			trait = earthbender
		}
		text = EVTDESCavatarA.176
	}
	desc = {
		trigger = {
			trait = waterbender
		}
		text = EVTDESCavatarB.176
	}
	desc = {
		trigger = {
			trait = airbender
		}
		text = EVTDESCavatarC.176
	}
	desc = {
		trigger = {
			trait = firebender
		}
		text = EVTDESCavatarD.176
	}

	option = {
		name = EVTOPTbending.176
		if = {
			limit = {
				trait = earthbender
			}
			FROM = { add_trait = avatar_earthbender }
		}
		if = {
			limit = {
				trait = airbender
			}
			FROM = { add_trait = avatar_airbender }
		}
		if = {
			limit = {
				trait = firebender
			}
			FROM = { add_trait = avatar_firebender }
		}
		if = {
			limit = {
				trait = waterbender
			}
			FROM = { add_trait = avatar_waterbender }
		}
		hidden_tooltip = {
			FROM = { character_event = { id = avatar.158 days = 3 random = 7 } }
		}
	}

}

character_event = {
	id = avatar.177
	is_triggered_only = yes
	hide_window = yes

	option = {
		FROM = { character_event = { id = avatar.175 days = 60 random = 90 } }
	}
}

character_event = {
	id = avatar.178
	is_triggered_only = yes
	hide_window = yes

	option = {
		FROM = { character_event = { id = avatar.176 days = 60 random = 90 } }
	}
}

#
character_event = { # Avatar is asked for help
	id = avatar.179
	desc = EVTDESCavatar.179
	is_triggered_only = yes
	picture = GFX_evt_avatar_firelord

	option = { # Refuse
		name = EVTDESCavatarA.179
		FROM = {
			character_event = { id = avatar.181 days = 6 random = 21 }
			opinion = { modifier = avatar_refused_aid who = ROOT years = 5 }
		}
		ai_chance = {
			factor = 0
		}
	}

	option = { # I'm on the ruler's side
		name = EVTDESCavatarB.179
		random_list = {
			66 = {
				custom_tooltip = {
					text = tooltip_preferred_outcome
					FROM = { character_event = { id = avatar.182 days = 21 random = 47 } }
				}
			}
			33 = {
				custom_tooltip = {
					text = tooltip_compromise
					FROM = { character_event = { id = avatar.180 days = 21 random = 47 } }
				}
			}
		}
		ai_chance = {
			factor = 33
			modifier = {
				factor = 0
				FROM = { trait = greedy }
			}
			modifier = {
				factor = 0
				FROM = { trait = cruel }
			}
			modifier = {
				factor = 25
				FROM = { is_friend = ROOT }
			}
			modifier = {
				factor = 5
				FROM = { trait = just  }
			}
		}
	}

	option = { # Compromise
		name = EVTDESCavatarC.179
		custom_tooltip = {
			text = tooltip_compromise
			FROM = { character_event = { id = avatar.180 days = 21 random = 47 } }
		}
		ai_chance = {
			factor = 33
		}
	}

	option = { # I'm on the rebels' side
		name = EVTDESCavatarD.179
		random_list = {
			66 = {
				custom_tooltip = {
					text = tooltip_punishment
					FROM = { character_event = { id = avatar.183 days = 21 random = 47 } }
				}
			}
			33 = {
				custom_tooltip = {
					text = tooltip_compromise
					FROM = { character_event = { id = avatar.180 days = 21 random = 47 } }
				}
			}
		}
		ai_chance = {
			factor = 33
			modifier = {
				factor = 0
				FROM = { is_friend = ROOT }
			}
			modifier = {
				factor = 5
				FROM = { trait = greedy }
			}
			modifier = {
				factor = 5
				FROM = { trait = slothful }
			}
			modifier = {
				factor = 5
				FROM = { trait = wroth }
			}
			modifier = {
				factor = 5
				FROM = { trait = deceitful }
			}
			modifier = {
				factor = 5
				FROM = { trait = cruel }
			}
		}
	}
}

character_event = { # Avatar offers solution : Acceptable
	id = avatar.180
	desc = EVTDESCavatar.180
	is_triggered_only = yes
	picture = GFX_evt_avatar_firelord

	trigger = { always = no }

	option = { # Refuse
		name = EVTDESCavatarA.180
		opinion = { modifier = avatar_refused_aid who = FROM years = 5 }
		FROM = { opinion = { modifier = opinion_refused_council who = ROOT years = 5 } }
		hidden_tooltip = {
			any_vassal = {
				limit = {
					NOR = { 
						religion = way_of_chin 
						religion = way_of_chin_reformed
						religion = fire_nation_imperialism 
						religion = piracy 
					}
				}
				opinion = { modifier = refused_aid who = ROOT years = 5 }
			}
		}
		clr_character_flag = avatar_aid
	}

	option = { # Accept
		name = EVTDESCavatarB.180
		log = "avatar.180 might invalidated rebelion, that cunt"
		any_realm_province = {
			add_province_modifier = { name = lowered_taxes duration = 1240 }
		}
		ROOT = {
			any_war = {
				limit = {
					using_cb = peasant_revolt
				}
				end_war = invalid
			}
		}
		clr_character_flag = avatar_aid
	}
}

character_event = { # Avatar refuses to intervene
	id = avatar.181
	desc = EVTDESCavatar.181
	is_triggered_only = yes
	picture = GFX_evt_avatar_firelord

	option = { # Refuse
		name = EVTOPTavatar.181
	}
}

character_event = { # Avatar offers solution : Preferble
	id = avatar.182
	desc = EVTDESCavatar.182
	is_triggered_only = yes
	picture = GFX_evt_avatar_firelord

	option = { # Accept
		name = EVTOPTCavatar.182
		log = "avatar.182 might invalidated rebelion, that cunt"
		any_realm_province = {
			add_province_modifier = { name = lowered_taxes duration = 640 }
		}
		ROOT = {
			any_war = {
				limit = {
					using_cb = peasant_revolt
				}
				end_war = invalid
			}
		}
		clr_character_flag = avatar_aid
	}

}

character_event = { # Avatar offers solution : Forced
	id = avatar.183
	desc = EVTDESCavatar.183
	is_triggered_only = yes
	picture = GFX_evt_avatar_firelord

	option = { # Refuse
		name = EVTOPTCavatar.183
		log = "avatar.183 might invalidated rebelion, that cunt"
		any_realm_province = {
			add_province_modifier = { name = lowered_taxes duration = 2480 }
		}
		opinion = { modifier = avatar_refused_aid who = FROM years = 5 }
		ROOT = {
			any_war = {
				limit = {
					using_cb = peasant_revolt
				}
				end_war = invalid
			}
		}
		clr_character_flag = avatar_aid
	}

}

character_event = { # Avatar joins the Hundred Year War - ROOT
	id = avatar.184
	desc = EVTDESCavatar.184
	is_triggered_only = yes
	picture = GFX_evt_avatar_conflict

	option = { # Go To War
		name = EVTOPTCavatar.184
		set_global_flag = avatar_at_war
		any_playable_ruler = {
			limit = {
				NOT = { same_realm = ROOT }
			}
			character_event = { id = avatar.185 }
		}
	}

}

character_event = { # Avatar joins the Hundred Year War - WORLD
	id = avatar.185
	desc = {
		trigger = {
			AND = {
				has_global_flag = HYW_4
				has_global_flag = avatar_air
			}
		}
		text = EVTDESCavatarA.185
	}
	desc = {
		trigger = {
			OR = {
				NOT = { has_global_flag = HYW_4 }
				NOT = { has_global_flag = avatar_air }
			}
		}
		text = EVTDESCavatarB.185
	}
	is_triggered_only = yes
	picture = GFX_evt_avatar_conflict

	option = { # POS
		name = EVTOPTCavatarA.185
		trigger = {
			NOT = { religion = fire_nation_imperialism }
		}
	}

	option = { # NEG
		name = EVTOPTCavatarB.185
		trigger = {
			religion = fire_nation_imperialism
		}
	}

}

character_event = { # Avatar takes action
	id = avatar.186
	desc = EVTDESCavatar.186
	is_triggered_only = yes
	picture = GFX_evt_avatar_conflict

	option = { # Incite Rebellion
		trigger = {
			any_rival = {
				any_realm_province = {
					NOT = { culture_group = PREV }
				}
			}
		}
		name = EVTOPTCavatarA.186
	}

	option = { # Find Ally
		name = EVTOPTCavatarB.186
	}

	option = { # Launch Invasion
		trigger = {
			is_variable_equal = { which = avatar_allies value = 12 }
		}
		name = EVTOPTCavatarC.186
	}

	option = { # Challenge Tyrant
		trigger = {
			any_independent_ruler = {
				OR = {
					trait = unjust
				}
			}
		}
		name = EVTOPTCavatarD.186
	}

}

# !nevercalled
# character_event = { # Avatar takes action - Incite Uprising
# 	id = avatar.187
# 	desc = EVTDESCavatar.187
# 	is_triggered_only = yes
# 	picture = GFX_evt_avatar_conflict
# 	option = { # Curses!
# 		name = EVTOPTCavatar.187
# 	}
# }

# !nevercalled
# character_event = { # Avatar takes action - Visit Ruler
# 	id = avatar.188
# 	desc = EVTDESCavatar.188
# 	is_triggered_only = yes
# 	picture = GFX_evt_avatar_conflict
# 	option = { # I will aid you
# 		name = EVTOPTCavatar.185
# 	}
# 	option = { # I will not be involved
# 		name = EVTOPTCavatar.185
# 	}
# }

# !nevercalled
# character_event = { # Avatar takes action - Launch Invasion
# 	id = avatar.189
# 	desc = EVTDESCavatar.189
# 	is_triggered_only = yes
# 	picture = GFX_evt_avatar_conflict
# 	option = { # I will aid you
# 		name = EVTOPTCavatar.185
# 	}
# 	option = { # I will not be involved
# 		name = EVTOPTCavatar.185
# 	}
# }


#character_event = { # Descendent leaves Court for fame
#	id = avatar.191
#	desc = EVTDESCavatar.191
#	is_triggered_only = yes
#	picture = GFX_evt_cliff_face
#
#	trigger = {
#		any_child = {
#			age = 16
#		}
#	}
#
#	option = { # Alright
#		name = EVTOPTCavatar.184
#		any_independent_ruler = {
#			limit = {
#				realm_size = 3
#			}
#			character_event = { id = avatar.197 }
#		}
#	}
#
#}

# character_event = { # Avatar marries
# 	id = avatar.192
# 	is_triggered_only = yes
# 	hide_window = yes
# 	ai = yes
# 	min_age = 16

# 	trigger = {
# 		is_married = no
# 		NOT = { has_character_flag = has_been_married }
# 		trait = fullyrealisedavatar
# 		NOT = { has_character_flag = is_roku }
# 	}

# 	option = {
# 		random_playable_ruler = {
# 			limit = {
# 				any_courtier = {
# 					is_betrothed = no
# 					is_married = no
# 					has_lover = no
# 					prisoner = no
# 					is_ill = no
# 					NOT = { same_sex = ROOT }
# 					NOT = { age_diff = {who = ROOT years = 5 } }
# 					has_unpleasant_trait_trigger = no
# 					has_unattractive_trait_trigger = no
# 					NOT = { religion = fire_nation_imperialism }
# 					NOT = { religion = way_of_chin }
# 				}
# 			}
# 			random_courtier = {
# 				limit = {
# 					is_betrothed = no
# 					is_married = no
# 					has_lover = no
# 					prisoner = no
# 					is_ill = no
# 					NOT = { same_sex = ROOT }
# 					NOT = { age_diff = {who = ROOT years = 5 } }
# 					has_unpleasant_trait_trigger = no
# 					has_unattractive_trait_trigger = no
# 					NOT = { religion = fire_nation_imperialism }
# 					NOT = { religion = way_of_chin }
# 				}
# 				character_event = { id = avatar.193 }
# 			}
# 		}
# 	}

# }

# character_event = { # Is asked
# 	id = avatar.193
# 	desc = EVTDESCavatar.193
# 	is_triggered_only = yes
# 	picture = GFX_evt_fire_wedding

# 	option = { # Yes
# 		name = EVTOPTCavatarA.193
# 		if = { # If landed, marry
# 			limit = {
# 				is_landed = yes
# 			}
# 			if = {
# 				limit = {
# 					FROM = { is_female = no }
# 				}
# 				add_spouse = FROM
# 				add_lover = FROM
# 			}
# 			if = {
# 				limit = {
# 					FROM = { is_female = yes }
# 				}
# 				add_spouse_matrilineal = FROM
# 				add_lover = FROM
# 			}
# 			FROM = { set_character_flag = has_been_married }
# 		}
# 		if = { # If landed, ask liege
# 			limit = {
# 				is_landed = no
# 			}
# 			liege = {
# 				character_event = { id = avatar.194 }
# 			}
# 		}
# 		ai_chance = {
# 			factor = 1
# 		}
# 	}

# 	option = { # No
# 		name = EVTOPTCavatarB.193
# 		ai_chance = {
# 			factor = 0
# 		}
# 	}

# }

# character_event = { # Liege is asked
# 	id = avatar.194
# 	desc = EVTDESCavatar.194
# 	is_triggered_only = yes
# 	picture = GFX_evt_fire_wedding

# 	option = { # Yes
# 		name = EVTOPTCavatarA.194
# 		if = {
# 			limit = {
# 				FROMFROM = { is_female = no }
# 			}
# 			FROM = { add_spouse = FROMFROM }
# 			hidden_tooltip = {
# 				FROM = { add_lover = FROMFROM }
# 			}
# 		}
# 		if = {
# 			limit = {
# 				FROMFROM = { is_female = yes }
# 			}
# 			FROM = { add_spouse_matrilineal = FROMFROM }
# 			hidden_tooltip = {
# 				FROM = { add_lover = FROMFROM }
# 			}
# 		}
# 		FROMFROM = { set_character_flag = has_been_married }
# 		ai_chance = {
# 			factor = 1
# 		}
# 	}

# 	option = { # No
# 		name = EVTOPTCavatarB.194
# 		ai_chance = {
# 			factor = 0
# 		}
# 	}

# }


#character_event = { # Descendent leaves Court for fame - New Liege is asked
#	id = avatar.197
#	desc = EVTDESCavatar.197
#	is_triggered_only = yes
#	picture = GFX_evt_cliff_face
#
#	option = { # Alright
#		name = EVTOPTCavatarA.197
#		FROM = { move_character = ROOT }
#		FROMFROM = { character_event = { id = avatar.198 } }
#		ai_chance = {
#			factor = 1
#		}
#	}
#
#	option = { # No
#		name = EVTOPTCavatarB.197
#		FROM = { prestige = -25 }
#		ai_chance = {
#			factor = 0
#		}
#	}
#
#}

#character_event = { # Descendent leaves Court for fame - Father is informed
#	id = avatar.198
#	desc = EVTDESCavatar.198
#	is_triggered_only = yes
#	picture = GFX_evt_cliff_face
#
#	option = { # Alright
#		name = EVTOPTCavatar.198
#	}
#
#}

character_event = { # Avatar aids defender
	id = avatar.199
	desc = EVTDESCavatar.199
	is_triggered_only = yes
	picture = GFX_evt_avatar_conflict

	trigger = {
		war = no
	}

	option = { # Alright
		name = EVTOPTCavatarA.199
		random_playable_ruler = {
			limit = {
				is_primary_war_defender = yes
				any_war = {
					OR = {
						using_cb = fire_offensive_port
						using_cb = fire_offensive
					}
				}
			}
			ROOT = {
				join_defender_wars = PREV
			}
			character_event = { id = avatar.200 }
			any_war = {
				limit = {
					OR = {
						using_cb = fire_offensive_port
						using_cb = fire_offensive
					}
				}
				any_attacker = {
					character_event = { id = avatar.201 }
				}
			}
			capital_scope = {
				ROOT = {
					spawn_unit = {
						province = PREV
						home = PREV
						owner = ROOT
						troops = {
							archers = { 600 600 }
							light_cavalry = { 200 200 }
							light_infantry = { 600 600 }
							heavy_infantry = { 400 400 }
							avatar_at_war = { 1 1 }
						}
						disband_on_peace = yes
						maintenance = no
					}
				}
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = { # No
		name = EVTOPTCavatarB.199
		ai_chance = {
			factor = 0
		}
	}

}

character_event = { # Avatar aids Defender - Defender
	id = avatar.200
	desc = EVTDESCavatar.200
	is_triggered_only = yes
	picture = GFX_evt_avatar_conflict

	option = { # Alright
		name = EVTOPTCavatar.200
	}

}

character_event = { # Avatar aids Defender - Attackers
	id = avatar.201
	desc = EVTDESCavatar.201
	is_triggered_only = yes
	picture = GFX_evt_avatar_conflict

	option = { # Alright
		name = EVTOPTCavatar.201
	}

}

character_event = { # Avatar Found?
	id = avatar.202
	desc = EVTDESCavatar.202
	is_triggered_only = yes
	picture = GFX_evt_cliff_face

	option = { # We must train them!
		trigger = {
			is_landed = yes
		}
		name = EVTOPTCavatarA.202
	}

	option = { # The proper authorities should be informed
		trigger = {
			is_landed = no
		}
		name = EVTOPTCavatarB.202
	}

	option = { # They're not the Avatar!
		name = EVTOPTCavatarC.202
	}

}

# !nevercalled
# character_event = { # Authority Informed
# 	id = avatar.203
# 	desc = EVTDESCavatar.203
# 	is_triggered_only = yes
# 	picture = GFX_evt_cliff_face

# 	option = { # We must train them!
# 		name = EVTOPTCavatarA.203
# 	}

# 	option = { # They're not the Avatar!
# 		name = EVTOPTCavatarC.203
# 	}

# }

character_event = { # Avatar's Wrath - Assassination
	id = avatar.204
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		is_title_active = d_avatar
		OR = {
			trait = directdescendantavatar
			trait = descendantavatar
			any_friend = {
				OR = {
					trait = avatar
					trait = fullyrealisedavatar
				}
			}
			any_lover = {
				OR = {
					trait = avatar
					trait = fullyrealisedavatar
				}
			}
		}
	}

	option = {
		d_avatar = {
			holder_scope = {
				character_event = { id = avatar.205 }
			}
		}
	}

}

character_event = { # Avatar's Wrath - Assassination - Avatar
	id = avatar.205
	desc = EVTDESCavatar.205
	is_triggered_only = yes
	picture = GFX_evt_avatar_conflict

	option = { # My Vengence shall be swift!
		name = EVTOPTCavatarA.205
		FROMFROM = { character_event = { id = avatar.206 } }
		ai_chance = {
			factor = 1
		}
	}

	option = { # I shall spare them
		name = EVTOPTCavatarB.205
		piety = 100
		ai_chance = {
			factor = 0
		}
	}

}

character_event = { # Avatar's Wrath - Assassination - FROM
	id = avatar.206
	desc = EVTDESCavatar.206
	is_triggered_only = yes
	picture = GFX_evt_avatar_resist

	option = { # To the Death!
		name = EVTOPTCavatarA.206
		trigger = {
			NOT = { trait = craven }
		}
		random_list = {
			10 = {
				add_trait = wounded
				add_rival = FROM
				modifier = {
					factor = 0
					NOT = { martial = 16 }
				}
			}
			10 = {
				add_trait = maimed
				add_rival = FROM
				modifier = {
					factor = 0
					NOT = { martial = 12 }
				}
			}
			80 = {
				death = { death_reason = death_battle killer = FROM }
				modifier = {
					factor = 1.5
					NOT = { martial = 8 }
				}
			}
		}
	}

	option = { # Mercy!
		name = EVTOPTCavatarB.206
		trigger = {
			NOT = { trait = craven }
		}
		death = { death_reason = death_battle killer = FROM }
	}

	option = { # Mercy!!!
		name = EVTOPTCavatarC.206
		trigger = {
			trait = craven
		}
		death = { death_reason = death_battle killer = FROM }
	}

}

character_event = { # Avatar's Wrath - Abduction
	id = avatar.207
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		is_title_active = d_avatar
		OR = {
			trait = directdescendantavatar
			trait = descendantavatar
			any_friend = {
				OR = {
					trait = avatar
					trait = fullyrealisedavatar
				}
			}
			any_lover = {
				OR = {
					trait = avatar
					trait = fullyrealisedavatar
				}
			}
		}
	}

	option = {
		d_avatar = {
			holder_scope = {
				character_event = { id = avatar.208 }
			}
		}
	}

}

character_event = { # Avatar's Wrath - Abduction - Avatar
	id = avatar.208
	desc = EVTDESCavatar.208
	is_triggered_only = yes
	picture = GFX_evt_avatar_conflict

	option = { # My Vengence shall be swift!
		name = EVTOPTCavatarA.205
		FROMFROM = { character_event = { id = avatar.209 } }
		ai_chance = {
			factor = 1
		}
	}

}

character_event = { # Avatar's Wrath - Abduction - FROM
	id = avatar.209
	desc = EVTDESCavatar.209
	is_triggered_only = yes
	picture = GFX_evt_avatar_resist

	option = { # To the Death!
		name = EVTOPTCavatarA.206
		trigger = {
			NOT = { trait = craven }
		}
		random_list = {
			10 = {
				add_trait = wounded
				add_rival = FROM
				modifier = {
					factor = 0
					NOT = { martial = 16 }
				}
			}
			10 = {
				add_trait = maimed
				add_rival = FROM
				modifier = {
					factor = 0
					NOT = { martial = 12 }
				}
			}
			80 = {
				death = { death_reason = death_battle killer = FROM }
				modifier = {
					factor = 1.5
					NOT = { martial = 8 }
				}
			}
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROMFROM = {
						is_consort = yes
					}
				}
				any_consort = {
					remove_consort = ROOT
					move_character = FROM
				}
			}
			if = {
				limit = {
					FROMFROM = {
						prisoner = yes
					}
				}
				any_courtier = {
					limit = {
						prisoner = yes
					}
					prisoner = no
					move_character = FROM
				}
			}
		}
	}

	option = { # Mercy!
		name = EVTOPTCavatarB.206
		trigger = {
			NOT = { trait = craven }
		}
		death = { death_reason = death_battle killer = FROM }
		hidden_tooltip = {
			if = {
				limit = {
					FROMFROM = {
						is_consort = yes
					}
				}
				any_consort = {
					remove_consort = ROOT
					move_character = FROM
				}
			}
			if = {
				limit = {
					FROMFROM = {
						prisoner = yes
					}
				}
				any_courtier = {
					limit = {
						prisoner = yes
					}
					prisoner = no
					move_character = FROM
				}
			}
		}
	}

	option = { # Mercy!!!
		name = EVTOPTCavatarC.206
		trigger = {
			trait = craven
		}
		death = { death_reason = death_battle killer = FROM }
		hidden_tooltip = {
			if = {
				limit = {
					FROMFROM = {
						is_consort = yes
					}
				}
				any_consort = {
					remove_consort = ROOT
					move_character = FROM
				}
			}
			if = {
				limit = {
					FROMFROM = {
						prisoner = yes
					}
				}
				any_courtier = {
					limit = {
						prisoner = yes
					}
					prisoner = no
					move_character = FROM
				}
			}
		}
	}
}
