# Written by Flavio

namespace = HF
namespace = HFP
# Ritual Sacrifice Prisoner
character_event = {
	id = HF.23001
	desc = EVTDESCHF23001

	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23001
	}
}

# Syncretic rulers can pick a random sympathy.
character_event = {
	id = HF.23003
	desc = EVTDESCHF23003

	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23003
		trigger = {
			NOT = { religion_group = earth_religions }
		}
		add_trait = sympathy_earth_religions
		clr_character_flag = flag_picking_sympathy
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				liege = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 0
				top_liege = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 0.25
				spouse = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 1.5
				any_demesne_province = {
					religion_group = earth_religions
				}
			}
			modifier = {
				factor = 1.5
				any_courtier_or_vassal = {
					religion_group = earth_religions
				}
			}
		}
	}

	option = {
		name = EVTOPTBHF23003
		trigger = {
			NOT = { religion_group = water_religions }
		}
		add_trait = sympathy_water_religions
		clr_character_flag = flag_picking_sympathy
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				liege = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 0
				top_liege = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 0.25
				spouse = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 1.5
				any_demesne_province = {
					religion_group = water_religions
				}
			}
			modifier = {
				factor = 1.5
				any_courtier_or_vassal = {
					religion_group = water_religions
				}
			}
		}
	}

	option = {
		name = EVTOPTCHF23003
		trigger = {
			NOT = { religion_group = fire_religions }
		}
		add_trait = sympathy_fire_religions
		clr_character_flag = flag_picking_sympathy
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				liege = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 0
				top_liege = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 0.25
				spouse = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 1.5
				any_demesne_province = {
					religion_group = fire_religions
				}
			}
			modifier = {
				factor = 1.5
				any_courtier_or_vassal = {
					religion_group = fire_religions
				}
			}
		}
	}

	option = {
		name = EVTOPTCHF23003
		trigger = {
			NOT = { religion_group = air_religions }
		}
		add_trait = sympathy_air_religions
		clr_character_flag = flag_picking_sympathy
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				liege = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 0
				top_liege = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 0.25
				spouse = {
					OR = {
						trait = sympathy_earth_religions
						trait = sympathy_water_religions
						trait = sympathy_fire_religions
						trait = sympathy_air_religions
					}
				}
			}
			modifier = {
				factor = 1.5
				any_demesne_province = {
					religion_group = air_religions
				}
			}
			modifier = {
				factor = 1.5
				any_courtier_or_vassal = {
					religion_group = air_religions
				}
			}
		}
	}
}

#############################################################

#Divination: on war started, chance to divine outcome.
#Hidden ping to select haruspex.
character_event = {
	id = HF.23005
	hide_window = yes

	trigger = {
		has_religion_feature = religion_haruspicy
		NOR = {
			has_character_modifier = divination_crit_success
			has_character_modifier = divination_success
			has_character_modifier = divination_failure
			has_character_modifier = divination_crit_failure
		}
		any_war = { #Do not fire for minor peasant uprisings.
			NOR = {
				attacker = { using_cb = peasant_revolt }
				defender = { using_cb = peasant_revolt }
			}
		}
	}

	is_triggered_only = yes


	immediate = {
		if = {
			limit = {
				any_courtier_or_vassal = {
					religion = ROOT
					has_job_title = job_spiritual
				}
			}
			random_courtier_or_vassal = {
				limit = {
					religion = ROOT
					has_job_title = job_spiritual
				}
				character_event = { id = HF.23006 }
				break = yes
			}
		}
		if = {
			limit = {
				any_realm_character = {
					religion = ROOT
					is_theocracy = yes
				}
			}
			any_realm_character = {
				limit = {
					religion = ROOT
					is_theocracy = yes
				}
				score_value = { #Prioritizes selecting an interesting courtier...
		            value = 10
		            interesting_courtier_selection_score = yes
		        }
				character_event = { id = HF.23006 }
				break = yes
			}
		}
		set_character_flag = flag_cheap_diviner
		character_event = { id = HF.23007 }
	}
}

#Hidden ping on diviner.
character_event = {
	id = HF.23006
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_religion_feature = religion_haruspicy
		NOR = {
			has_character_modifier = divination_crit_success
			has_character_modifier = divination_success
			has_character_modifier = divination_failure
			has_character_modifier = divination_crit_failure
		}
	}


	immediate = {
		FROM = { character_event = { id = HF.23007 days = 7 random = 7 } }
	}
}

character_event = {
	id = HF.23007
	desc = {
		text = EVTDESCAHF23007
		trigger = {
			FROM = { is_alive = yes }
			NOT = {
				FROM = { character = ROOT }
			}
		}
	}
	desc = { #Generic desc if priest dies in between or there was no priest available.
		text = EVTDESCBHF23007
		trigger = {
			OR = {
				FROM = { character = ROOT }
				FROM = { is_alive = no }
			}
		}
	}

	trigger = {
		war = yes
		has_religion_feature = religion_haruspicy
		NOR = {
			has_character_modifier = divination_crit_success
			has_character_modifier = divination_success
			has_character_modifier = divination_failure
			has_character_modifier = divination_crit_failure
		}
	}


	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	immediate = {
		if = {
			limit = { FROM = { is_alive = no } }
			set_character_flag = flag_cheap_diviner #Prevents crit success, increases crit failure.
		}
		if = {
			limit = { has_religion_feature = religion_ritual_sacrifice }
			random_courtier = {
				limit = {
					NOR = {
						dynasty = ROOT
						has_job_title = job_spiritual
						is_ruler = yes
						is_married = ROOT
						is_close_relative = ROOT
						is_lover = ROOT
						is_friend = ROOT
					}
				}
				preferred_limit = {
					is_unimportant_trigger = yes
				}
				save_event_target_as = potential_victim
			}
		}
		clr_character_flag = flag_sacrificing_bull  #Safety cleanup.
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
		clr_character_flag = flag_sacrificing_human
	}

	#Great Bull
	#Cow
	#Goat
	#Chicken

	option = { #Human - Ensure no Critical Fail - Unlocks Critical success - Only if also Bloodthirsty Gods.
		name = EVTOPTZHF23007
		trigger = {
			has_religion_feature = religion_ritual_sacrifice
			event_target:potential_victim = { is_alive = yes }
		}
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -1 min = -200 max = -400 }
		}
		event_target:potential_victim = {
			show_scope_change = no
			death = {
				death_reason = death_execution_aztec_sacrifice
				killer = ROOT
			}
		}
		set_character_flag = flag_sacrificing_human
		ai_chance = {
			factor = 60
			modifier = {
				factor = 0
				trait = greedy
			}
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
			modifier = {
				factor = 0.1
				NOT = { wealth = 300 }
			}
		}
	}
	option = { #Great bull - Ensure no Critical Fail - Unlocks Critical success
		name = EVTOPTAHF23007
		trigger = { NOT = { has_religion_feature = religion_ritual_sacrifice } }
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -1 min = -175 max = -500 }
		}
		set_character_flag = flag_sacrificing_bull
		ai_chance = {
			factor = 60
			modifier = {
				factor = 0
				trait = greedy
			}
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = zealous
			}
			modifier = {
				factor = 0.1
				NOT = { wealth = 300 }
			}
		}
	}
	option = { #Cow - Unlocks critical success
		name = EVTOPTBHF23007
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -0.75 min = -50 max = -130 }
		}
		set_character_flag = flag_sacrificing_cow
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 0.75
				trait = cynical
			}
			modifier = {
				factor = 1.25
				trait = zealous
			}
			modifier = {
				factor = 0.1
				NOT = { wealth = 100 }
			}
		}
	}
	option = { #Goat
		name = EVTOPTCHF23007
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -0.5 min = -30 max = -75 }
		}
		set_character_flag = flag_sacrificing_goat
		ai_chance = {
			factor = 40
			modifier = {
				factor = 0.75
				trait = zealous
			}
		}
	}
	option = { #Chicken
		name = EVTOPTDHF23007
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -0.1 min = -5 max = -30 }
		}
		set_character_flag = flag_sacrificing_chicken
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0.5
				trait = zealous
			}
			modifier = {
				factor = 0.5
				trait = charitable
			}
		}
	}

	after = {
		hidden_tooltip = {
			random_list = {
				20 = {
					trigger = {
						OR = {
							has_character_flag = flag_sacrificing_bull
							has_character_flag = flag_sacrificing_human
						}
						NOT = { has_character_flag = flag_cheap_diviner }
					}
					modifier = {
						factor = 0.7
						trait = cynical
					}
					modifier = {
						factor = 1.5
						trait = zealous
					}
					modifier = {
						factor = 0.7
						NOT = { piety = -150 }
					}
					modifier = {
						factor = 0.8
						NOT = { piety = -100 }
					}
					modifier = {
						factor = 0.8
						NOT = { piety = -50 }
					}
					modifier = {
						factor = 0.8
						NOT = { piety = 0 }
					}
					modifier = {
						factor = 1.15
						piety = 30
					}
					modifier = {
						factor = 1.15
						piety = 40
					}
					modifier = {
						factor = 1.15
						piety = 50
					}
					modifier = {
						factor = 1.15
						piety = 70
					}
					modifier = {
						factor = 1.15
						piety = 100
					}
					modifier = {
						factor = 1.25
						piety = 150
					}
					modifier = {
						factor = 1.25
						piety = 250
					}
					modifier = {
						factor = 1.5
						piety = 350
					}
					modifier = {
						factor = 1.5
						piety = 450
					}
					modifier = {
						factor = 1.5
						piety = 550
					}
					modifier = {
						factor = 0.6
						NOT = { has_character_flag = flag_cheap_diviner }
						NOT = { FROM = { learning = 3 } }
					}
					modifier = {
						factor = 0.7
						NOT = { has_character_flag = flag_cheap_diviner }
						NOT = { FROM = { learning = 4 } }
					}
					modifier = {
						factor = 0.8
						NOT = { has_character_flag = flag_cheap_diviner }
						NOT = { FROM = { learning = 6 } }
					}
					modifier = {
						factor = 0.8
						NOT = { has_character_flag = flag_cheap_diviner }
						NOT = { FROM = { learning = 8 } }
					}
					modifier = {
						factor = 1.15
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning = 10 }
					}
					modifier = {
						factor = 1.15
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning = 12 }
					}
					modifier = {
						factor = 1.15
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning = 14 }
					}
					modifier = {
						factor = 1.15
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning = 16 }
					}
					modifier = {
						factor = 1.15
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning = 18 }
					}
					modifier = {
						factor = 1.15
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning = 20 }
					}
					modifier = {
						factor = 1.25
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning = 25 }
					}
					modifier = {
						factor = 1.35
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning = 30 }
					}
					#But, more importantly, does the divine like you?
					modifier = {
						factor = 0.75
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = -80 } } }
					}
					modifier = {
						factor = 0.75
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = -60 } } }
					}
					modifier = {
						factor = 0.75
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = -40 } } }
					}
					modifier = {
						factor = 0.85
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = -20 } } }
					}
					modifier = {
						factor = 0.85
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = 0 } } }
					}
					modifier = {
						factor = 1.15
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { opinion = { who = ROOT value = 20 } }
					}
					modifier = {
						factor = 1.25
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { opinion = { who = ROOT value = 40 } }
					}
					modifier = {
						factor = 1.25
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { opinion = { who = ROOT value = 60 } }
					}
					modifier = {
						factor = 1.35
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { opinion = { who = ROOT value = 80 } }
					}
					modifier = {
						factor = 1.45
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { opinion = { who = ROOT value = 90 } }
					}
					character_event = { id = HF.23008 } #Crit success
				}
				50 = {
					modifier = {
						factor = 0.7
						has_character_flag = flag_sacrificing_human
					}
					modifier = {
						factor = 0.7
						has_character_flag = flag_sacrificing_bull
					}
					modifier = {
						factor = 0.8
						has_character_flag = flag_sacrificing_goat
					}
					modifier = {
						factor = 0.8
						has_character_flag = flag_sacrificing_chicken
					}
					modifier = {
						factor = 0.8
						has_character_flag = flag_cheap_diviner
					}
					modifier = {
						factor = 0.7
						trait = cynical
					}
					modifier = {
						factor = 1.5
						trait = zealous
					}
					modifier = {
						factor = 0.8
						NOT = { piety = -150 }
					}
					modifier = {
						factor = 0.9
						NOT = { piety = -100 }
					}
					modifier = {
						factor = 0.9
						NOT = { piety = -50 }
					}
					modifier = {
						factor = 0.9
						NOT = { piety = 0 }
					}
					modifier = {
						factor = 0.7
						NOT = { has_character_flag = flag_cheap_diviner }
						NOT = { FROM = { learning = 3 } }
					}
					modifier = {
						factor = 0.8
						NOT = { has_character_flag = flag_cheap_diviner }
						NOT = { FROM = { learning = 4 } }
					}
					modifier = {
						factor = 0.9
						NOT = { has_character_flag = flag_cheap_diviner }
						NOT = { FROM = { learning = 6 } }
					}
					modifier = {
						factor = 0.9
						NOT = { has_character_flag = flag_cheap_diviner }
						NOT = { FROM = { learning = 8 } }
					}
					#But, more importantly, does the divine like you?
					modifier = {
						factor = 0.85
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = -80 } } }
					}
					modifier = {
						factor = 0.85
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = -60 } } }
					}
					modifier = {
						factor = 0.85
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = -40 } } }
					}
					modifier = {
						factor = 0.95
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = -20 } } }
					}
					modifier = {
						factor = 0.95
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { NOT = { opinion = { who = ROOT value = 0 } } }
					}
					character_event = { id = HF.23009 } #Success
				}
				30 = {
					modifier = {
						factor = 0.7
						has_character_flag = flag_sacrificing_human
					}
					modifier = {
						factor = 0.7
						has_character_flag = flag_sacrificing_bull
					}
					modifier = {
						factor = 0.8
						has_character_flag = flag_sacrificing_cow
					}
					character_event = { id = HF.23010 } #Failure
				}
				5 = {

					trigger = {
						NOR = {
							has_character_flag = flag_sacrificing_bull
							has_character_flag = flag_sacrificing_human
						}
					}
					modifier = {
						factor = 0.5
						has_character_flag = flag_sacrificing_cow
					}
					character_event = { id = HF.23011 } #Crit failure
				}
			}
		}
	}
}

#Divination: Critical success
character_event = {
	id = HF.23008
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_human
		}
		text = EVTDESCZHF23008
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_bull
		}
		text = EVTDESCAHF23008
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_cow
		}
		text = EVTDESCBHF23008
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_goat
		}
		text = EVTDESCCHF23008
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_chicken
		}
		text = EVTDESCDHF23008
	}
	show_from_from = yes

	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23008
		add_character_modifier = {
			name = divination_crit_success
			duration = -1
		}
		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
}
#Divination: Success
character_event = {
	id = HF.23009
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_human
		}
		text = EVTDESCZHF23009
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_bull
		}
		text = EVTDESCAHF23009
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_cow
		}
		text = EVTDESCBHF23009
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_goat
		}
		text = EVTDESCCHF23009
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_chicken
		}
		text = EVTDESCDHF23009
	}
	show_from_from = yes

	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23009
		add_character_modifier = {
			name = divination_success
			duration = -1
		}
		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
}
#Divination: Failure
character_event = {
	id = HF.23010
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_human
		}
		text = EVTDESCZHF23010
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_bull
		}
		text = EVTDESCAHF23010
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_cow
		}
		text = EVTDESCBHF23010
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_goat
		}
		text = EVTDESCCHF23010
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_chicken
		}
		text = EVTDESCDHF23010
	}
	show_from_from = yes

	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTXHF23010
		trigger = { learning = 15 }
		tooltip_info = learning
		tiered_piety_negative_effect = yes
		add_character_modifier = {
			name = divination_success
			duration = -1
		}
		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
	option = {
		name = EVTOPTAHF23010
		add_character_modifier = {
			name = divination_failure
			duration = -1
		}
		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
}
#Divination: Critical Failure
character_event = {
	id = HF.23011
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_human
		}
		text = EVTDESCZHF23011
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_bull
		}
		text = EVTDESCAHF23011
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_cow
		}
		text = EVTDESCBHF23011
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_goat
		}
		text = EVTDESCCHF23011
	}
	desc = {
		trigger = {
			has_character_flag = flag_sacrificing_chicken
		}
		text = EVTDESCDHF23011
	}
	show_from_from = yes

	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTXHF23011
		trigger = { learning = 15 }
		tooltip_info = learning
		tiered_piety_negative_effect = yes
		add_character_modifier = {
			name = divination_failure
			duration = -1
		}
		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
	option = {
		name = EVTOPTZHF23011
		trigger = { trait = cynical }
		tooltip_info = cynical
		scaled_wealth = { value = -0.75 min = -100 max = -250 }
		tiered_piety_negative_effect = yes
		add_character_modifier = {
			name = divination_failure
			duration = -1
		}
		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
	option = {
		name = EVTOPTAHF23011
		add_character_modifier = {
			name = divination_crit_failure
			duration = -1
		}
		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
}

#Divination: Cleanup event on war over.
character_event = {
	id = HF.23012
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		character_event = { id = HF.23013 days = 1 }
	}
}
#Divination: Cleanup event on war over.
character_event = {
	id = HF.23013
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				war = no #Maintain modifier if embroiled in multiple wars
				OR = {
					has_character_modifier = divination_crit_success
					has_character_modifier = divination_success
					has_character_modifier = divination_failure
					has_character_modifier = divination_crit_failure
				}
			}
			remove_character_modifier = divination_crit_success
			remove_character_modifier = divination_success
			remove_character_modifier = divination_failure
			remove_character_modifier = divination_crit_failure
		}
		FROMFROM = {
			if = {
				limit = {
					war = no #Maintain modifier if embroiled in multiple wars
					OR = {
						has_character_modifier = divination_crit_success
						has_character_modifier = divination_success
						has_character_modifier = divination_failure
						has_character_modifier = divination_crit_failure
					}
				}
				remove_character_modifier = divination_crit_success
				remove_character_modifier = divination_success
				remove_character_modifier = divination_failure
				remove_character_modifier = divination_crit_failure
			}
		}
	}
}

#HF.23014 - HF.23015


#Pick a Pagan religious branch when having a headless reformed pagan religion.
character_event = {
	id = HF.23016
	desc = EVTDESCHF23016

	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		has_religion_feature = religion_no_leader
		NOR = {
			trait = pagan_branch_1
			trait = pagan_branch_2
			trait = pagan_branch_3
			trait = pagan_branch_4
		}
	}

	option = {
		name = EVTOPTAHF23016
		trigger = {
			NOT = {
				has_religion_feature = religion_dogmatic
			}
		}
		add_trait = pagan_branch_1
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0.1
				has_religion_feature = religion_jizya
			}
		}
	}
	option = {
		name = EVTOPTBHF23016
		add_trait = pagan_branch_2
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				OR = {
					trait = scholar
					trait = theologian
					trait = mystic
					trait = zealous
					has_focus = focus_scholarship
					has_focus = focus_theology
					trait = detached_priest
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					trait = lustful
					trait = hedonist
					trait = gluttonous
					trait = drunkard
					has_focus = focus_seduction
					has_focus = focus_carousing
				}
			}
		}
	}
	option = {
		name = EVTOPTCHF23016
		add_trait = pagan_branch_3
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				OR = {
					trait = duelist
					trait = hunter
					trait = strategist
					trait = zealous
					has_focus = focus_war
					has_focus = focus_hunting
					trait = misguided_warrior
					trait = tough_soldier
					trait = skilled_tactician
					trait = brilliant_strategist
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					trait = craven
					trait = paranoid
					trait = shy
				}
			}
		}
	}
	option = {
		name = EVTOPTDHF23016
		add_trait = pagan_branch_4
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				OR = {
					any_child = { NOT = { age = 16 } count = 3 }
					has_focus = focus_family
					has_focus = focus_carousing
					trait = misguided_warrior
					trait = tough_soldier
					trait = skilled_tactician
					trait = brilliant_strategist
				}
			}
		}
	}
	after = { clr_character_flag = flag_picking_branch }
}

#Switch pagan religious branch.
character_event = {
	id = HF.23017
	desc = EVTDESCHF23017

	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23017
		trigger = {
			NOT = {
				trait = pagan_branch_1
			}
		}
		if = {
			limit = {
				trait = pagan_branch_2
			}
			remove_trait = pagan_branch_2
		}
		if = {
			limit = {
				trait = pagan_branch_3
			}
			remove_trait = pagan_branch_3
		}
		if = {
			limit = {
				trait = pagan_branch_4
			}
			remove_trait = pagan_branch_4
		}
		add_trait = pagan_branch_1
	}
	option = {
		name = EVTOPTBHF23017
		trigger = {
			NOT = {
				trait = pagan_branch_2
			}
		}
		if = {
			limit = {
				trait = pagan_branch_1
			}
			remove_trait = pagan_branch_1
		}
		if = {
			limit = {
				trait = pagan_branch_3
			}
			remove_trait = pagan_branch_3
		}
		if = {
			limit = {
				trait = pagan_branch_4
			}
			remove_trait = pagan_branch_4
		}
		add_trait = pagan_branch_2
	}
	option = {
		name = EVTOPTCHF23017
		trigger = {
			NOT = {
				trait = pagan_branch_3
			}
		}
		if = {
			limit = {
				trait = pagan_branch_2
			}
			remove_trait = pagan_branch_2
		}
		if = {
			limit = {
				trait = pagan_branch_1
			}
			remove_trait = pagan_branch_1
		}
		if = {
			limit = {
				trait = pagan_branch_4
			}
			remove_trait = pagan_branch_4
		}
		add_trait = pagan_branch_3
	}
	option = {
		name = EVTOPTDHF23017
		trigger = {
			NOT = {
				trait = pagan_branch_4
			}
		}
		if = {
			limit = {
				trait = pagan_branch_2
			}
			remove_trait = pagan_branch_2
		}
		if = {
			limit = {
				trait = pagan_branch_3
			}
			remove_trait = pagan_branch_3
		}
		if = {
			limit = {
				trait = pagan_branch_1
			}
			remove_trait = pagan_branch_1
		}
		add_trait = pagan_branch_4
	}
	after = { clr_character_flag = flag_picking_branch }
}

#######################
# Dralha's Children
#######################
# Notification event

#######################
# Zodiac Signs - Hellenic Flavor
#######################
# On_birth event assigns traits on hellenic child.
character_event = {
	id = HF.23019
	hide_window = yes

	trigger = {
		has_religion_feature = religion_astrology
	}

	is_triggered_only = yes

	immediate = {
		add_western_zodiac_trait_effect = yes #Updated effect.
	}
}
#On_adolescence: chance for child to be either inclined to abandon the sign or embrace it. Follows an event for the Guardian to give his opinion on the matter.

#Child: hidden event for delay.
character_event = {
	id = HF.23020
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			trait = zodiac_aquarius
			trait = zodiac_aries
			trait = zodiac_cancer
			trait = zodiac_capricorn
			trait = zodiac_gemini
			trait = zodiac_leo
			trait = zodiac_libra
			trait = zodiac_pisces
			trait = zodiac_sagittarius
			trait = zodiac_scorpio
			trait = zodiac_taurus
			trait = zodiac_virgo

		}
	}
	immediate = {
		character_event = { id = HF.23021 days = 40 random = 120 }
	}
}

#Astrology: The child thinks about his sign.
character_event = {
	id = HF.23021
	desc = EVTDESCAHF23021


	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23021
		set_character_flag = flag_child_embracing_zodiac
		hidden_tooltip = { guardian = { character_event = { id = HF.23022 days = 40 random = 120 } } }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = haughty
			}
			modifier = {
				factor = 0.5
				trait = brooding
			}
			modifier = {
				factor = 0.5
				trait = willful
			}
		}
	}
	option = {
		name = EVTOPTBHF23021
		set_character_flag = flag_child_forsaking_zodiac
		hidden_tooltip = { guardian = { character_event = { id = HF.23022 days = 40 random = 120 } } }
		tooltip = {
			if = {
				limit = {
					trait = zodiac_aquarius
				}
				remove_trait = zodiac_aquarius
			}
			if = {
				limit = {
					trait = zodiac_aries
				}
				remove_trait = zodiac_aries
			}
			if = {
				limit = {
					trait = zodiac_cancer
				}
				remove_trait = zodiac_cancer
			}
			if = {
				limit = {
					trait = zodiac_capricorn
				}
				remove_trait = zodiac_capricorn
			}
			if = {
				limit = {
					trait = zodiac_gemini
				}
				remove_trait = zodiac_gemini
			}
			if = {
				limit = {
					trait = zodiac_leo
				}
				remove_trait = zodiac_leo
			}
			if = {
				limit = {
					trait = zodiac_libra
				}
				remove_trait = zodiac_libra
			}
			if = {
				limit = {
					trait = zodiac_pisces
				}
				remove_trait = zodiac_pisces
			}
			if = {
				limit = {
					trait = zodiac_sagittarius
				}
				remove_trait = zodiac_sagittarius
			}
			if = {
				limit = {
					trait = zodiac_scorpio
				}
				remove_trait = zodiac_scorpio
			}
			if = {
				limit = {
					trait = zodiac_taurus
				}
				remove_trait = zodiac_taurus
			}
			if = {
				limit = {
					trait = zodiac_virgo
				}
				remove_trait = zodiac_virgo
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				trait = zealous
			}
			modifier = {
				factor = 0.5
				trait = timid
			}
			modifier = {
				factor = 0.5
				trait = idolizer
			}
			modifier = {
				factor = 0.5
				trait = indolent
			}
		}
	}
}

#Guardian: is the child doing well?
character_event = {
	id = HF.23022
	desc = {
		trigger = {
			FROM = {
				has_character_flag = flag_child_embracing_zodiac
			}
		}
		text = EVTDESCAHF23022
	}
	desc = {
		trigger = {
			FROM = {
				has_character_flag = flag_child_forsaking_zodiac
			}
		}
		text = EVTDESCBHF23022
	}
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { #Do not care.
		name = EVTOPTAHF23022
		trigger = {
			has_religion_feature = religion_astrology
		}
		if = {
			limit = { FROM = { has_character_flag = flag_child_forsaking_zodiac } }
		FROM = {
				if = {
					limit = {
						trait = zodiac_aquarius
					}
					remove_trait = zodiac_aquarius
				}
				if = {
					limit = {
						trait = zodiac_aries
					}
					remove_trait = zodiac_aries
				}
				if = {
					limit = {
						trait = zodiac_cancer
					}
					remove_trait = zodiac_cancer
				}
				if = {
					limit = {
						trait = zodiac_capricorn
					}
					remove_trait = zodiac_capricorn
				}
				if = {
					limit = {
						trait = zodiac_gemini
					}
					remove_trait = zodiac_gemini
				}
				if = {
					limit = {
						trait = zodiac_leo
					}
					remove_trait = zodiac_leo
				}
				if = {
					limit = {
						trait = zodiac_libra
					}
					remove_trait = zodiac_libra
				}
				if = {
					limit = {
						trait = zodiac_pisces
					}
					remove_trait = zodiac_pisces
				}
				if = {
					limit = {
						trait = zodiac_sagittarius
					}
					remove_trait = zodiac_sagittarius
				}
				if = {
					limit = {
						trait = zodiac_scorpio
					}
					remove_trait = zodiac_scorpio
				}
				if = {
					limit = {
						trait = zodiac_taurus
					}
					remove_trait = zodiac_taurus
				}
				if = {
					limit = {
						trait = zodiac_virgo
					}
					remove_trait = zodiac_virgo
				}
			}
		}
		ai_chance = {
			factor = 100
		}
	}
	option = { #The child should forsake the sign.
		name = { #Child was abandoning the sign already.
			text = EVTOPTBHF23008_A
			trigger = {
				FROM = {
					has_character_flag = flag_child_forsaking_zodiac
				}
			}
		}
		name = { #Child was not abandoning the sign.
			text = EVTOPTBHF23008_B
			trigger = {
				FROM = {
					has_character_flag = flag_child_embracing_zodiac
				}
			}
		}
		trigger = {
			has_religion_feature = religion_astrology
		}
		if = {
			limit = {
				FROM = { has_character_flag = flag_child_embracing_zodiac }
			}
			FROM = { tiered_piety_negative_effect = yes }
		}

		FROM = {
			hidden_tooltip = { character_event = { id = HF.23023 } }
			if = {
				limit = {
					trait = zodiac_aquarius
				}
				remove_trait = zodiac_aquarius
			}
			if = {
				limit = {
					trait = zodiac_aries
				}
				remove_trait = zodiac_aries
			}
			if = {
				limit = {
					trait = zodiac_cancer
				}
				remove_trait = zodiac_cancer
			}
			if = {
				limit = {
					trait = zodiac_capricorn
				}
				remove_trait = zodiac_capricorn
			}
			if = {
				limit = {
					trait = zodiac_gemini
				}
				remove_trait = zodiac_gemini
			}
			if = {
				limit = {
					trait = zodiac_leo
				}
				remove_trait = zodiac_leo
			}
			if = {
				limit = {
					trait = zodiac_libra
				}
				remove_trait = zodiac_libra
			}
			if = {
				limit = {
					trait = zodiac_pisces
				}
				remove_trait = zodiac_pisces
			}
			if = {
				limit = {
					trait = zodiac_sagittarius
				}
				remove_trait = zodiac_sagittarius
			}
			if = {
				limit = {
					trait = zodiac_scorpio
				}
				remove_trait = zodiac_scorpio
			}
			if = {
				limit = {
					trait = zodiac_taurus
				}
				remove_trait = zodiac_taurus
			}
			if = {
				limit = {
					trait = zodiac_virgo
				}
				remove_trait = zodiac_virgo
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0.5
				trait = zealous
			}
			modifier = {
				factor = 0.5
				trait = scholar
			}
			modifier = {
				factor = 0.5
				trait = mystic
			}
		}
	}
	option = { #The child should embrace the sign.
		name = { #Child was abandoning the sign already.
			text = EVTOPTCHF23008_A
			trigger = {
				FROM = {
					has_character_flag = flag_child_forsaking_zodiac
				}
			}
		}
		name = { #Child was not abandoning the sign.
			text = EVTOPTCHF23008_B
			trigger = {
				FROM = {
					has_character_flag = flag_child_embracing_zodiac
				}
			}
		}
		trigger = {
			has_religion_feature = religion_astrology
		}
		FROM = {
			hidden_tooltip = { character_event = { id = HF.23024 } }
		}
		ai_chance = {
			factor = 80
			modifier = {
				factor = 0.5
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = hedonist
			}
			modifier = {
				factor = 0.5
				trait = socializer
			}
		}
	}
}

#Astrology: The child has been persuaded to forsake the sign.
character_event = {
	id = HF.23023
	desc = {
		trigger = {
			ROOT = {
				has_character_flag = flag_child_embracing_zodiac
			}
		}
		text = EVTDESCAHF23023
	}
	desc = {
		trigger = {
			ROOT = {
				has_character_flag = flag_child_forsaking_zodiac
			}
		}
		text = EVTDESCBHF23023
	}

	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23023
		clr_character_flag = flag_child_embracing_zodiac
		clr_character_flag = flag_child_forsaking_zodiac
		set_character_flag = flag_child_forsaken_zodiac
	}
}

#Astrology: The child has been persuaded to embrace the sign.
character_event = {
	id = HF.23024
	desc = {
		trigger = {
			ROOT = {
				has_character_flag = flag_child_embracing_zodiac
			}
		}
		text = EVTDESCAHF23024
	}
	desc = {
		trigger = {
			ROOT = {
				has_character_flag = flag_child_forsaking_zodiac
			}
		}
		text = EVTDESCBHF23024
	}

	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23024
		clr_character_flag = flag_child_embracing_zodiac
		clr_character_flag = flag_child_forsaking_zodiac
	}
}

#Astrology: Adult character without his sign gains it by decision.
character_event = {
	id = HFP.23925
	desc = {
		trigger = {
			trait = zodiac_aquarius
		}
		text = EVTDESCAHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_aries
		}
		text = EVTDESCBHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_cancer
		}
		text = EVTDESCCHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_capricorn
		}
		text = EVTDESCDHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_gemini
		}
		text = EVTDESCEHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_leo
		}
		text = EVTDESCFHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_libra
		}
		text = EVTDESCGHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_pisces
		}
		text = EVTDESCHHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_sagittarius
		}
		text = EVTDESCIHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_scorpio
		}
		text = EVTDESCLHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_taurus
		}
		text = EVTDESCMHF23025
	}
	desc = {
		trigger = {
			trait = zodiac_virgo
		}
		text = EVTDESCNHF23025
	}

	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23025
		#add_western_zodiac_trait_effect = yes
		tooltip = { #Trait has already been added, just show it in the tooltip for the player.
			if = {
				limit = {
					trait = zodiac_aquarius
				}
				add_trait = zodiac_aquarius
			}
			if = {
				limit = {
					trait = zodiac_aries
				}
				add_trait = zodiac_aries
			}
			if = {
				limit = {
					trait = zodiac_cancer
				}
				add_trait = zodiac_cancer
			}
			if = {
				limit = {
					trait = zodiac_capricorn
				}
				add_trait = zodiac_capricorn
			}
			if = {
				limit = {
					trait = zodiac_gemini
				}
				add_trait = zodiac_gemini
			}
			if = {
				limit = {
					trait = zodiac_leo
				}
				add_trait = zodiac_leo
			}
			if = {
				limit = {
					trait = zodiac_libra
				}
				add_trait = zodiac_libra
			}
			if = {
				limit = {
					trait = zodiac_pisces
				}
				add_trait = zodiac_pisces
			}
			if = {
				limit = {
					trait = zodiac_sagittarius
				}
				add_trait = zodiac_sagittarius
			}
			if = {
				limit = {
					trait = zodiac_scorpio
				}
				add_trait = zodiac_scorpio
			}
			if = {
				limit = {
					trait = zodiac_taurus
				}
				add_trait = zodiac_taurus
			}
			if = {
				limit = {
					trait = zodiac_virgo
				}
				add_trait = zodiac_virgo
			}
		}
	}
}

#on_conversion: Converted to a Pagan Religion with branches from a religion without.
character_event = {
	id = HF.23033
	desc = EVTDESCHF23033

	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		is_adult = yes
		has_religion_feature = religion_no_leader
		NOR = {
			trait = pagan_branch_1
			trait = pagan_branch_2
			trait = pagan_branch_3
			trait = pagan_branch_4
			has_character_modifier = picked_pagan_branch_cooldown
		}
	}

	immediate = {
		add_character_modifier = { modifier = picked_pagan_branch_cooldown years = 5 hidden = yes }
	}
	option = {
		name = EVTOPTAHF23016
		trigger = {
			NOT = {
				has_religion_feature = religion_dogmatic
			}
		}
		add_trait = pagan_branch_1
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0.1
				has_religion_feature = religion_jizya
			}
		}
	}
	option = {
		name = EVTOPTBHF23016
		add_trait = pagan_branch_2
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				OR = {
					trait = scholar
					trait = theologian
					trait = mystic
					trait = zealous
					has_focus = focus_scholarship
					has_focus = focus_theology
					trait = detached_priest
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					trait = lustful
					trait = hedonist
					trait = gluttonous
					trait = drunkard
					has_focus = focus_seduction
					has_focus = focus_carousing
				}
			}
		}
	}
	option = {
		name = EVTOPTCHF23016
		add_trait = pagan_branch_3
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				OR = {
					trait = duelist
					trait = hunter
					trait = strategist
					trait = zealous
					has_focus = focus_war
					has_focus = focus_hunting
					trait = misguided_warrior
					trait = tough_soldier
					trait = skilled_tactician
					trait = brilliant_strategist
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					trait = craven
					trait = paranoid
					trait = shy
				}
			}
		}
	}
	option = {
		name = EVTOPTDHF23016
		add_trait = pagan_branch_4
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				OR = {
					any_child = { NOT = { age = 16 } count = 3 }
					has_focus = focus_family
					has_focus = focus_carousing
					trait = misguided_warrior
					trait = tough_soldier
					trait = skilled_tactician
					trait = brilliant_strategist
				}
			}
		}
	}
	after = { clr_character_flag = flag_picking_branch }
}

#On Conversion event to clear up gender laws when needed.
character_event = {
	id = HF.23034
	hide_window = yes

	trigger = {
		ROOT = {
			OR = {
				has_religion_feature = religion_patriarchal
				has_religion_feature = religion_equal
				has_religion_feature = religion_matriarchal
			}
		}
	}
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				ROOT = {
					has_religion_feature = religion_matriarchal
					NOR = {
						#is_merchant_republic = yes
						is_republic = yes
					}
				}
			}
			ROOT = {
				any_demesne_title = {
					add_law = {
						law = enatic_succession
						cooldown = no
						opinion_effect = no
					}
					add_law = {
						law = status_of_women_4
						cooldown = no
						opinion_effect = no
					}
					if = {
						limit = {
							ROOT = {
								OR = {
									is_feudal = yes
									is_tribal = yes
									is_nomadic = yes
								}
							}
						}
						add_law = {
							law = succ_turkish_succession
							cooldown = no
							opinion_effect = no
						}
					}
				}
				recalc_succession = yes
			}
		}
		if = {
			limit = {
				ROOT = { has_religion_feature = religion_patriarchal }
			}
			ROOT = {
				any_demesne_title = {
					add_law = {
						law = agnatic_succession
						cooldown = no
						opinion_effect = no
					}
					add_law = {
						law = status_of_women_0
						cooldown = no
						opinion_effect = no
					}
					if = {
						limit = {
							ROOT = {
								OR = {
									is_feudal = yes
									is_tribal = yes
									is_nomadic = yes
								}
							}
						}
						add_law = {
							law = succ_turkish_succession
							cooldown = no
							opinion_effect = no
						}
					}
				}
				recalc_succession = yes
			}
		}
		if = {
			limit = {
				ROOT = {
					OR = {
						has_religion_feature = religion_equal
					}
					NOR = {
						#is_merchant_republic = yes
						is_republic = yes
					}
				}
			}
			ROOT = {
				any_demesne_title = {
					add_law = {
						law = true_cognatic_succession
						cooldown = no
						opinion_effect = no
					}
					add_law = {
						law = status_of_women_4
						cooldown = no
						opinion_effect = no
					}
				}
				recalc_succession = yes
			}
		}
		ROOT = {
			if = {
				limit = {
					FROM = {
						NOR = {
							has_religion_feature = religion_equal
							has_religion_feature = religion_patriarchal
							has_religion_feature = religion_matriarchal
						}
					}
					ROOT = { has_religion_feature = religion_matriarchal }
				}
				any_close_relative = {
					limit = { is_female = no }
					opinion = {
						who = ROOT
						modifier = bad_succ_law_change
						years = 100
					}
				}
				any_close_relative = {
					limit = { is_female = yes }
					opinion = {
						who = ROOT
						modifier = good_succ_law_change
						years = 100
					}
				}
			}
			if = {
				limit = {
					FROM = {
						NOR = {
							has_religion_feature = religion_equal
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_patriarchal
						}
					}
					ROOT = { has_religion_feature = religion_patriarchal }
				}
				any_close_relative = {
					limit = { is_female = yes }
					opinion = {
						who = ROOT
						modifier = bad_succ_law_change
						years = 100
					}
				}
				any_close_relative = {
					limit = { is_female = no }
					opinion = {
						who = ROOT
						modifier = good_succ_law_change
						years = 100
					}
				}
			}
			if = {
				limit = {
					FROM = { has_religion_feature = religion_patriarchal }
					ROOT = {
						OR = {
							has_religion_feature = religion_equal
							has_religion_feature = religion_matriarchal
						}
					}
				}
				any_close_relative = {
					limit = { is_female = no }
					opinion = {
						who = ROOT
						modifier = bad_succ_law_change
						years = 100
					}
				}
				any_close_relative = {
					limit = { is_female = yes }
					opinion = {
						who = ROOT
						modifier = good_succ_law_change
						years = 100
					}
				}
			}
			if = {
				limit = {
					FROM = { has_religion_feature = religion_matriarchal }
					ROOT = {
						OR = {
							has_religion_feature = religion_equal
							has_religion_feature = religion_patriarchal
						}
					}
				}
				any_close_relative = {
					limit = { is_female = yes }
					opinion = {
						who = ROOT
						modifier = bad_succ_law_change
						years = 100
					}
				}
				any_close_relative = {
					limit = { is_female = no }
					opinion = {
						who = ROOT
						modifier = good_succ_law_change
						years = 100
					}
				}
			}
			if = {
				limit = {
					FROM = {
						has_religion_feature = religion_equal
					}
					ROOT = {
						has_religion_feature = religion_patriarchal
					}
				}
				any_close_relative = {
					limit = { is_female = yes }
					opinion = {
						who = ROOT
						modifier = bad_succ_law_change
						years = 100
					}
				}
				any_close_relative = {
					limit = { is_female = no }
					opinion = {
						who = ROOT
						modifier = good_succ_law_change
						years = 100
					}
				}
			}
			if = {
				limit = {
					FROM = {
						has_religion_feature = religion_equal
					}
					ROOT = {
						has_religion_feature = religion_matriarchal
					}
				}
				any_close_relative = {
					limit = { is_female = no }
					opinion = {
						who = ROOT
						modifier = bad_succ_law_change
						years = 100
					}
				}
				any_close_relative = {
					limit = { is_female = yes }
					opinion = {
						who = ROOT
						modifier = good_succ_law_change
						years = 100
					}
				}
			}
		}
	}
}

#On Random Start cleanup for Status of Women.
character_event = {
	id = HF.23035
	hide_window = yes

	trigger = {
		is_save_game = no

		OR = {
			has_religion_feature = religion_patriarchal
			has_religion_feature = religion_equal
			has_religion_feature = religion_matriarchal
		}
	}
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				ROOT = { has_religion_feature = religion_matriarchal }
			}
			ROOT = {
				any_demesne_title = {
					add_law = {
						law = status_of_women_4
						cooldown = no
						opinion_effect = no
					}
					add_law = {
						law = enatic_succession
						cooldown = no
						opinion_effect = no
					}
					if = {
						limit = {
							ROOT = {
								OR = {
									is_feudal = yes
									is_tribal = yes
									is_nomadic = yes
								}
							}
						}
						add_law = {
							law = succ_turkish_succession
							cooldown = no
							opinion_effect = no
						}
					}
				}
			}
		}
		if = {
			limit = {
				ROOT = { has_religion_feature = religion_patriarchal }
			}
			ROOT = {
				any_demesne_title = {
					add_law = {
						law = status_of_women_0
						cooldown = no
						opinion_effect = no
					}
					add_law = {
						law = cognatic_succession
						cooldown = no
						opinion_effect = no
					}
					if = {
						limit = {
							ROOT = {
								OR = {
									is_feudal = yes
									is_tribal = yes
									is_nomadic = yes
								}
							}
						}
						add_law = {
							law = succ_turkish_succession
							cooldown = no
							opinion_effect = no
						}
					}
				}
			}
		}
		if = {
			limit = {
				ROOT = {
					has_religion_feature = religion_equal
				}
			}
			ROOT = {
				any_demesne_title = {
					add_law = {
						law = status_of_women_4
						cooldown = no
						opinion_effect = no
					}
					add_law = {
						law = true_cognatic_succession
						cooldown = no
						opinion_effect = no
					}
				}
			}
		}
	}
}

#Special raider events (traits gained by having Daring + Seafaring)

#On_looting_settlement: Gaining Thralls.
character_event = {
	id = HF.23207
	desc = EVTDESCHF23207
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	has_dlc = "Holy Fury"

	is_triggered_only = yes

	trigger = {
		this_is_sea_raider_trigger = yes
		FROM = {
			location = { capital_holding = { title = FROM } } #Do not reiterate the event after taking the capital holding.
			is_tribal = no
			is_nomadic = no
		}
	}

	#Sacrifice to improve MA.
	#Sell for money.
	#Put to use (stacking capital building modifier/increasing revolt risk)

	option = {
		name = EVTOPTAHF23207
		trigger = {
			has_religion_feature = religion_ritual_sacrifice
			FROM = { location = { NOT = { religion = ROOT } } } #Only if province is of some other religion.
		}
		hidden_tooltip = { FROM = { owner = { character_event = { id = HF.23208 } } } } #Notify owner
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 6 } }
			}
			piety = 150
			religion_authority = {
				modifier = great_sacrifice_positive
				years = 150
			}
			hidden_tooltip = {
				change_variable = { which = burned_hearts_points value = 2 }
				bloodthirsty_tiered_traits_effect = yes
			}
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 4 } }
				FROM = { location = { NOT = { num_of_settlements = 6 } } }
			}
			piety = 100
			religion_authority = {
				modifier = great_sacrifice_positive
				years = 100
			}
			hidden_tooltip = {
				change_variable = { which = burned_hearts_points value = 1 }
				bloodthirsty_tiered_traits_effect = yes
			}
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 2 } }
				FROM = { location = { NOT = { num_of_settlements = 4 } } }
			}
			piety = 50
			religion_authority = {
				modifier = great_sacrifice_positive
				years = 50
			}
			hidden_tooltip = {
				bloodthirsty_tiered_traits_effect = yes
			}
		}
		if = {
			limit = {
				FROM = { location = { NOT = { num_of_settlements = 2 } } }
			}
			piety = 25
			religion_authority = {
				modifier = great_sacrifice_positive
				years = 25
			}
		}
	}
	option = {
		name = EVTOPTBHF23207
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 6 } }
			}
			wealth = 300
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 4 } }
				FROM = { location = { NOT = { num_of_settlements = 6 } } }
			}
			wealth = 200
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 2 } }
				FROM = { location = { NOT = { num_of_settlements = 4 } } }
			}
			wealth = 100
		}
		if = {
			limit = {
				FROM = { location = { NOT = { num_of_settlements = 2 } } }
			}
			wealth = 50
		}
	}
	option = {
		name = EVTOPTCHF23207
		trigger = { is_ruler = yes higher_tier_than = BARON }
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 6 } }
			}
			capital_scope = { show_scope_change = no add_lots_thralls_capital_effect = yes }
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 3 } }
				FROM = { location = { NOT = { num_of_settlements = 6 } } }
			}
			capital_scope = { show_scope_change = no add_some_thralls_capital_effect = yes }
		}
		if = {
			limit = {
				FROM = { location = { NOT = { num_of_settlements = 3 } } }
			}
			capital_scope = { show_scope_change = no add_few_thralls_capital_effect = yes }
		}
	}
}

#Owner of province is notified of great sacrifice.
character_event = {
	id = HF.23208
	desc = EVTDESCHF23208
	picture = {
		trigger = { FROM = { is_female = no } }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { FROM = { is_female = yes } }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23208
		trigger = { NOT = { religion = FROM } }
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 6 } }
			}
			religion_authority = {
				modifier = great_sacrifice_negative
				years = 150
			}
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 4 } }
				FROM = { location = { NOT = { num_of_settlements = 6 } } }
			}
			religion_authority = {
				modifier = great_sacrifice_negative
				years = 100
			}
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 2 } }
				FROM = { location = { NOT = { num_of_settlements = 4 } } }
			}
			religion_authority = {
				modifier = great_sacrifice_negative
				years = 50
			}
		}
		if = {
			limit = {
				FROM = { location = { NOT = { num_of_settlements = 2 } } }
			}
			religion_authority = {
				modifier = great_sacrifice_negative
				years = 25
			}
		}
	}
	option = {
		name = EVTOPTBHF23208
		trigger = { religion = FROM }
	}
}

#On_looting_settlement: Rounded up cattle.
character_event = {
	id = HF.23209
	desc = EVTDESCHF23209
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	has_dlc = "Holy Fury"

	is_triggered_only = yes

	trigger = {
		this_is_sea_raider_trigger = yes
		FROM = {
			location = { capital_holding = { title = FROM } } #Do not reiterate the event after taking the capital holding.
			is_tribal = no
			is_nomadic = no
		}
	}

	#Sacrifice to the gods.
	#Sell for money.
	#Share with troops.

	option = {
		name = EVTOPTAHF23209
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 6 } }
			}
			piety = 100
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 4 } }
				FROM = { location = { NOT = { num_of_settlements = 6 } } }
			}
			piety = 75
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 2 } }
				FROM = { location = { NOT = { num_of_settlements = 4 } } }
			}
			piety = 50
		}
		if = {
			limit = {
				FROM = { location = { NOT = { num_of_settlements = 2 } } }
			}
			piety = 25
		}
	}
	option = {
		name = EVTOPTBHF23209
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 6 } }
			}
			wealth = 100
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 4 } }
				FROM = { location = { NOT = { num_of_settlements = 6 } } }
			}
			wealth = 75
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 2 } }
				FROM = { location = { NOT = { num_of_settlements = 4 } } }
			}
			wealth = 50
		}
		if = {
			limit = {
				FROM = { location = { NOT = { num_of_settlements = 2 } } }
			}
			wealth = 25
		}
	}
	option = {
		name = EVTOPTCHF23209
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 6 } }
			}
			prestige = 150
			add_character_modifier = { modifier = pillagers_morale stacking = yes years = 10 }
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 4 } }
				FROM = { location = { NOT = { num_of_settlements = 6 } } }
			}
			prestige = 100
			add_character_modifier = { modifier = pillagers_morale stacking = yes years = 5 }
		}
		if = {
			limit = {
				FROM = { location = { num_of_settlements = 2 } }
				FROM = { location = { NOT = { num_of_settlements = 4 } } }
			}
			prestige = 75
			add_character_modifier = { modifier = pillagers_morale stacking = yes years = 5 }
		}
		if = {
			limit = {
				FROM = { location = { NOT = { num_of_settlements = 2 } } }
			}
			prestige = 50
			add_character_modifier = { modifier = pillagers_morale stacking = yes years = 5 }
		}
	}
}

#On_looted_settlement: Destroying large city as a Ravager/Seaking.
character_event = {
	id = HF.23210
	desc = EVTDESCHF23210
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	has_dlc = "Holy Fury"

	is_triggered_only = yes

	trigger = {
		OR = {
			trait = ravager
			trait = seaking
			trait = sea_queen
		}
		FROM = {
			location = { capital_holding = { title = FROM } } #Do not reiterate the event after taking the capital holding.
			location = { num_of_settlements = 5 } #Only fires for big cities.
			is_tribal = no
			is_nomadic = no
			location = { port = yes } 		#Coastal provinces are what the Seaking should be terrorizing.
		}
		location = {
			ROOT = {
				any_realm_province = { #Avoid the event firing for raiders who raided on land all the way to the port of a sea they do not have access to.
					port = yes
					TECH_NAVAL = 1
					OR = {
						has_building = tb_shipyard_1
						has_building = ca_shipyard_1
						has_building = tp_shipyard_1
						has_building = ct_shipyard_1
					}
					can_naval_path_to = PREVPREV
				}
			}
		}
	}

	#Burn it all to the ground.
	#Steal weapons and tools.
	#Scare villagers into telling tales of your fearsome army. (Prestige)
	#Nothing.

	option = { #Destroy
		name = EVTOPTAHF23210
		if = {
			limit = {
				NOR = {
					trait = kind
					trait = cruel
				}
			}
			random = { chance = 5 add_trait = cruel }
		}
		if = {
			limit = {
					trait = kind
			}
			random = { chance = 25 remove_trait = kind }
		}
		if = {
			limit = {
				trait = ravager
			}
			custom_tooltip = {
				text = "TOOLTIP_EVTOPTAHF230210"
				hidden_tooltip = {
					FROM = {
						destroy_random_building = THIS
						destroy_random_building = THIS
						add_holding_modifier = {
							modifier = recently_burnt_the_land
							months = 7
						}
					}
				}
			}
		}
		if = {
			limit = {
				OR = {
					trait = seaking
					trait = sea_queen
				}
			}
			custom_tooltip = {
				text = "TOOLTIP_EVTOPTAHF230210"
				hidden_tooltip = {
					FROM = {
						destroy_random_building = THIS
						destroy_random_building = THIS
						destroy_random_building = THIS
						destroy_random_building = THIS
						destroy_random_building = THIS
						add_holding_modifier = {
							modifier = recently_burnt_the_land
							months = 20
						}
					}
				}
			}
		}
		hidden_tooltip = {
			change_variable = { which = viking_raids value = 5 } #Exp bump.
			if = {
				limit = {
					FROM = { NOT = { has_any_building = yes } }
				}
				hidden_tooltip = {
					location = {
						province_event = { id = HF.23211 days = 1 } #Inform owner that his holding has been destroyed.
					}
				}
				FROM = { destroy_settlement = THIS }
			}
		}
	}
	option = { #Steal
		name = EVTOPTBHF23210
		if = {
			limit = {
				trait = ravager
			}
			wealth = 100
			if = {
				limit = {
					FROM = { location = { has_higher_tech_than = ROOT } }
				}
				military_techpoints = 25
			}
		}
		if = {
			limit = {
				OR = {
					trait = seaking
					trait = sea_queen
				}
			}
			wealth = 200
			if = {
				limit = {
					FROM = { location = { has_higher_tech_than = ROOT } }
				}
				military_techpoints = 50
			}
		}
	}
	option = { #Scare
		name = EVTOPTCHF23210
		if = {
			limit = {
				trait = ravager
			}
			prestige = 150
		}
		if = {
			limit = {
				OR = {
					trait = seaking
					trait = sea_queen
				}
			}
			prestige = 300
		}
		hidden_tooltip = {
			change_variable = { which = viking_raids value = 4 } #Exp bump.
		}
	}
	option = { #Nothing
		name = EVTOPTDHF23210
		trigger = { ai = no }
	}
}

#Owner of province is notified of destruction of settlement.
province_event = {
	id = HF.23211
	desc = EVTDESCHF23211
	picture = {
		trigger = { FROM = { is_female = no } }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { FROM = { is_female = yes } }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23211
	}
}


#On_looted_settlement: Bloodline gained at 200 viking_raids variable.
narrative_event = {
	id = HF.23212
	title = EVTTITLE23212
	desc = EVTDESCCHF23212
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_narrative_frame_war
	sound = bloodline_added

	is_triggered_only = yes

	has_dlc = "Holy Fury"

	trigger = {
		check_variable = { which = viking_raids value = 200 }
		OR = {
			trait = seaking
			trait = sea_queen
		}
		NOR = {
			any_owned_bloodline = { # Not already has a this bloodline.
				has_bloodline_flag = more_raiders_bloodline
			}
		}
	}

	option = {
		name = EVTOPTAHF23212
		hidden_tooltip = {
			if = {
				limit = { this_has_super_cool_nickname_trigger = no }
				random_list = {
					20 = {
						trigger = { age = 50 }
						give_nickname = nick_the_white_raven
					}
					20 = {
						trigger = { is_female = no }
						give_nickname = nick_the_salt_snake
					}
					20 = {
						trigger = { is_female = yes }
						give_nickname = nick_the_salt_viper
					}
					20 = {
						trigger = { is_female = yes is_attractive_trigger = yes }
						give_nickname = nick_the_siren
					}
					20 = {
						trigger = { is_female = no }
						give_nickname = nick_the_wyrm
					}
					20 = {
						trigger = { is_female = yes is_unattractive_trigger = yes }
						give_nickname = nick_the_fury
					}
					20 = {
						trigger = { is_female = no }
						give_nickname = nick_the_sea_devil
					}
					10 = {
						give_nickname = nick_the_stormforged
					}
					10 = {
						give_nickname = nick_the_tempest_of_capital
					}
				}
			}
		}
		if = {
			limit = {
				is_female = no
			}
			create_bloodline = {
				type = seaking_bloodline
			}
			new_bloodline = {
				set_description = "bloodline_desc_seaking_bloodline_pirate"
				random_list = {
					20 = { set_name = bloodline_seaking_pirate_random_a } #Randomize names to avoid too much repetition.
					20 = { set_name = bloodline_seaking_pirate_random_b }
					20 = { set_name = bloodline_seaking_pirate_random_c }
					20 = { set_name = bloodline_seaking_pirate_random_d }
				}
			}
		}
		if = {
			limit = { is_female = yes }
			create_bloodline = {
				type = seaqueen_bloodline
			}
			new_bloodline = {
				set_description = "bloodline_desc_seaking_bloodline_pirate"
				random_list = {
					20 = { set_name = bloodline_seaqueen_pirate_random_a } #Randomize names to avoid too much repetition.
					20 = { set_name = bloodline_seaqueen_pirate_random_b }
					20 = { set_name = bloodline_seaqueen_pirate_random_c }
					20 = { set_name = bloodline_seaqueen_pirate_random_d }
				}
			}
		}
		any_player = {
			limit = { NOT = { character = ROOT } is_within_diplo_range = ROOT }
			narrative_event = { id = HF.23213 }
		}
	}
}

#Other players are notified.
narrative_event = {
	id = HF.23213
	title = EVTTITLE23213
	desc = EVTDESCHF23213
	picture = {
		trigger = { FROM = { is_female = no } }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { FROM = { is_female = yes } }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_narrative_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23213
		trigger = {
			OR = {
				AND = {
					has_religion_feature = religion_adventuring
					has_religion_feature = religion_seafaring
				}
			}
		}
	}
	option = {
		name = EVTOPTBHF23213
		trigger = {
			NOR = {
				AND = {
					has_religion_feature = religion_adventuring
					has_religion_feature = religion_seafaring
				}
			}
		}
	}
}

#On_looted_settlement: Stumbling on small mercenary band.
character_event = {
	id = HF.23214
	desc = EVTDESCAHF23214
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	has_dlc = "Holy Fury"

	trigger = {
		is_landed = yes
		NOR = {
			has_earmarked_regiments = pirate_mercenaries_perm #Don't let another band spawn when the previous is still employed.
			has_earmarked_regiments = pirate_mercenaries
		}
		this_is_sea_raider_trigger = yes
		FROM = {
			location = { capital_holding = { title = FROM } } #Do not reiterate the event after taking the capital holding.
			location = { num_of_settlements = 4 } #Only fires for medium to big cities.
			is_tribal = no
			is_nomadic = no
			location = { port = yes } 		#Coastal provinces are what the Seaking should be terrorizing.
		}
		location = {
			ROOT = {
				any_realm_province = { #Avoid the event firing for raiders who raided on land all the way to the port of a sea they do not have access to.
					port = yes
					TECH_NAVAL = 1
					OR = {
						has_building = tb_shipyard_1
						has_building = ca_shipyard_1
						has_building = tp_shipyard_1
						has_building = ct_shipyard_1
					}
					can_naval_path_to = PREVPREV
				}
			}
		}
	}
	immediate = {
		FROM = { location = { save_event_target_as = scoped_spawning_point } }
		FROM = { owner = { save_event_target_as = scoped_province_owner } }
		random_list = { #Decide mercenary leader's sex.
			70 = {
				trigger = { FROM = { owner = { NOT = { has_religion_feature = religion_matriarchal } } } }
				create_random_soldier = {
					random_traits = yes
					dynasty = random
					culture = event_target:scoped_spawning_point
					religion = event_target:scoped_spawning_point
					female = no
					attributes = {
						diplomacy = 2
						learning = 2
						stewardship = 2
						intrigue = 2
						martial = 8
					}
				}
				new_character = {
					diplomatic_immunity = yes #Temporary
					add_trait = adventurer
					save_event_target_as = scoped_pirate_mercenary
					set_character_flag = flag_special_event_character #Prevent the character from being kicked out.
					random = { chance = 1 add_trait = homosexual }
					move_character = event_target:scoped_province_owner
				}
			}
			30 = {
				trigger = {
					FROM = {
						owner = {
							OR = {
								primary_title = { has_law = status_of_women_4 }
								has_game_rule = {
									name = gender
									value = all
								}
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_equal
							}
						}
					}
				}
				create_random_soldier = {
					random_traits = yes
					dynasty = random
					female = yes
					culture = event_target:scoped_spawning_point
					religion = event_target:scoped_spawning_point
					attributes = {
						diplomacy = 2
						learning = 2
						stewardship = 2
						intrigue = 2
						martial = 8
					}
				}
				new_character = {
					diplomatic_immunity = yes #Temporary
					add_trait = adventurer
					save_event_target_as = scoped_pirate_mercenary
					set_character_flag = flag_special_event_character #Prevent the character from being kicked out.
					random = { chance = 1 add_trait = homosexual }
					move_character = event_target:scoped_province_owner
				}
			}
		}
	}

	#Seduce leader.
	#Fight leader for supremacy.
	#Sway with money.
	#Let them go.

	option = { #Seduce (male)
		name = EVTOPTAHF23214
		trigger = {
			event_target:scoped_pirate_mercenary = { is_female = yes }
			prefers_men_trigger = no
			NOT = { trait = celibate }
		}
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23214 }
		hidden_tooltip = {
			event_target:scoped_pirate_mercenary = { move_character = ROOT }
			random_list = {
				70 = {
					modifier = {
						factor = 0
						is_female = yes
						event_target:scoped_pirate_mercenary = { NOT = { trait = homosexual } }
					}
					modifier = {
						factor = 1.5
						has_attractive_trait_trigger = yes
					}
					modifier = {
						factor = 1.5
						is_strong_trigger = yes
					}
					modifier = {
						factor = 0.5
						has_unattractive_trait_trigger = yes
					}
					modifier = {
						factor = 0.5
						is_weak_trigger = yes
					}
					modifier = {
						factor = 1.5
						trait = seducer
					}
					modifier = {
						factor = 1.5
						trait = seductress
					}
					modifier = {
						factor = 1.25
						trait = lustful
					}
					modifier = {
						factor = 0.75
						trait = chaste
					}
					modifier = {
						factor = 0.75
						trait = shy
					}
					modifier = {
						factor = 0.75
						trait = slow
					}
					modifier = {
						factor = 0.5
						trait = imbecile
					}
					modifier = {
						factor = 0.75
						age = 40
					}
					modifier = {
						factor = 0.5
						age = 50
					}
					character_event = { id = HF.23215 } #Success!
				}
				30 = {
					trigger = {
						is_attractive_trigger = yes
						NOT = { age = 40 }
					}

					character_event = { id = HF.23216 } #Failure!
				}
			}
		}
		ai_chance = { factor = 20 }
	}
	option = { #Seduce (female)
		name = EVTOPTBHF23214
		trigger = {
			event_target:scoped_pirate_mercenary = { is_female = no }
			prefers_men_trigger = yes
			NOT = { trait = celibate }
		}
		custom_tooltip = { text = TOOLTIP_EVTOPTBHF23214 }
		hidden_tooltip = {
			event_target:scoped_pirate_mercenary = { move_character = ROOT }
			random_list = {
				70 = {
					modifier = {
						factor = 0
						is_female = no
						event_target:scoped_pirate_mercenary = { NOT = { trait = homosexual } }
					}
					modifier = {
						factor = 1.5
						has_attractive_trait_trigger = yes
					}
					modifier = {
						factor = 1.5
						is_strong_trigger = yes
					}
					modifier = {
						factor = 0.5
						has_unattractive_trait_trigger = yes
					}
					modifier = {
						factor = 0.5
						is_weak_trigger = yes
					}
					modifier = {
						factor = 1.5
						trait = seducer
					}
					modifier = {
						factor = 1.5
						trait = seductress
					}
					modifier = {
						factor = 1.25
						trait = lustful
					}
					modifier = {
						factor = 0.75
						trait = chaste
					}
					modifier = {
						factor = 0.75
						trait = shy
					}
					modifier = {
						factor = 0.75
						trait = slow
					}
					modifier = {
						factor = 0.5
						trait = imbecile
					}
					modifier = {
						factor = 0.75
						age = 40
					}
					modifier = {
						factor = 0.5
						age = 50
					}
					modifier = { #Chance of mercenary also being homosexual.
						factor = 0.15
						is_female = no
						trait = homosexual
					}
					character_event = { id = HF.23215 } #Success!
				}
				30 = {
					trigger = {
						is_attractive_trigger = yes
						NOT = { age = 40 }
					}

					character_event = { id = HF.23216 } #Failure!
				}
			}
		}
		ai_chance = { factor = 20 }
	}
	option = { #Duel
		name = EVTOPTCHF23214
		trigger = { combat_rating = 15 }
		tooltip_info = combat_rating
		custom_tooltip = { text = TOOLTIP_EVTOPTCHF23214 }
    	#REQUIRED event targets for setting up duel evaluation!
	    hidden_tooltip = {
	    	save_event_target_as = combatant_1 #the person issuing the duel...
	    	set_character_flag = flag_pirate_fighting_mercenary_leader 	#Needed for follow-up event in case of victory.
	    	set_character_flag = flag_duel_no_draws #Prevents duel from ending in a draw.
	    	event_target:scoped_pirate_mercenary = {
	    		set_character_flag = flag_duel_no_backsies #Make the challenged party unable to decline the duel.
	    		set_character_flag = flag_duel_no_draws #Prevents duel from ending in a draw.
	    		save_event_target_as = combatant_2 } #the target of the duel...
	    }
	    pacifists_lose_piety_effect = yes
	    add_character_modifier = {
	        modifier = recent_duel_timer
	        duration = 365
	        hidden = yes
	    }
	    hidden_tooltip = {
	        event_target:scoped_pirate_mercenary = { character_event = { id = HFP.10095 } }
	    }
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	option = { #Pay
		name = EVTOPTDHF23214
		custom_tooltip = { text = TOOLTIP_EVTOPTDHF23214 }
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -1 min = -150 max = -250 }
		}
		location = {
            show_scope_change = no
			ROOT = {
            	show_scope_change = no
				spawn_unit = {
					province = PREV
					home = PREV
					owner = THIS
					leader = event_target:scoped_pirate_mercenary
					match_character = THIS
					match_mult = 0.25
					match_min = 150
					match_max = 1000
					attrition = 1.0
					cannot_inherit = yes
					earmark = pirate_mercenaries
					is_looter = yes
					can_toggle_looting = no
				}
			}
		}
		hidden_tooltip = { event_target:scoped_pirate_mercenary = { diplomatic_immunity = no move_character = ROOT } }
		hidden_tooltip = { character_event = { id = HF.23217 days = 350 random = 50 } } #Disband
		ai_chance = { factor = 20 }
	}
	option = { #Let the thugs go.
		name = EVTOPTEHF23214
		custom_tooltip = { text = TOOLTIP_EVTOPTEHF23214 }
		hidden_tooltip = { event_target:scoped_pirate_mercenary = { death = { death_reason = death_missing } } }
		ai_chance = { factor = 0 }
	}
}

#Pirate was able to seduce mercenary.
character_event = {
	id = HF.23215
	desc = {
		trigger = {
			is_female = no
		}
		text = EVTDESCAHF23215
	}
	desc = {
		trigger = {
			is_female = yes
		}
		text = EVTDESCBHF23215
	}
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	#Kill mercenary in his sleep, take over. (troops do not disband)
	#Declare love (troops do not disband)
	#Get troops for free. (troops are timed)

	option = { #Kill and take over.
		name = EVTOPTAHF23215
		trigger = { trait = deceitful }
		tooltip_info = deceitful
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23215 }
		if = {
			limit = { NOR = { trait = cruel trait = kind } }
			add_trait = cruel
		}
		if = {
			limit = { trait = kind }
			remove_trait = kind
		}
		tiered_piety_negative_effect = yes
		event_target:scoped_pirate_mercenary = {
			show_scope_change = no
			hidden_tooltip = { diplomatic_immunity = no }
			death = { death_reason = death_murder killer = ROOT }
		}
		location = {
            show_scope_change = no
			ROOT = {
            	show_scope_change = no
				spawn_unit = {
					province = PREV
					home = PREV
					owner = THIS
					leader = event_target:scoped_pirate_mercenary
					match_character = THIS
					match_mult = 0.25
					match_min = 150
					match_max = 1000
					attrition = 1.0
					cannot_inherit = yes
					earmark = pirate_mercenaries_perm
					is_looter = yes
				}
			}
		}
		ai_chance = { factor = 20 }
	}
	option = { #Become lover.
		name = EVTOPTBHF23215
		trigger = {
			trait = lustful
			NOT = { num_of_lovers = 3 }
		}
		tooltip_info = lustful
		custom_tooltip = { text = TOOLTIP_EVTOPTBHF23215 }
		if = {
			limit = { NOR = { trait = cruel trait = kind } }
			add_trait = kind
		}
		if = {
			limit = { trait = cruel }
			remove_trait = cruel
		}
		add_lover = event_target:scoped_pirate_mercenary
		tiered_prestige_negative_effect = yes
		hidden_tooltip = {
			event_target:scoped_pirate_mercenary = {
				show_scope_change = no
				diplomatic_immunity = no
				add_lover = ROOT
			}
		}
		location = {
            show_scope_change = no
			ROOT = {
            	show_scope_change = no
				spawn_unit = {
					province = PREV
					home = PREV
					owner = THIS
					leader = event_target:scoped_pirate_mercenary
					match_character = THIS
					match_mult = 0.25
					match_min = 150
					match_max = 1000
					attrition = 1.0
					cannot_inherit = yes
					earmark = pirate_mercenaries_perm
					is_looter = yes
				}
			}
		}
		ai_chance = { factor = 20 }
	}
	option = { #Hire.
		name = EVTOPTCHF23215
		custom_tooltip = { text = TOOLTIP_EVTOPTCHF23215 }
		location = {
            show_scope_change = no
			ROOT = {
            	show_scope_change = no
				spawn_unit = {
					province = PREV
					home = PREV
					owner = THIS
					leader = event_target:scoped_pirate_mercenary
					match_character = THIS
					match_mult = 0.25
					match_min = 150
					match_max = 1000
					attrition = 1.0
					cannot_inherit = yes
					earmark = pirate_mercenaries
					is_looter = yes
					can_toggle_looting = no
				}
			}
		}
		hidden_tooltip = { event_target:scoped_pirate_mercenary = { diplomatic_immunity = no } }
		hidden_tooltip = { character_event = { id = HF.23217 days = 350 random = 50 } } #Disband
		ai_chance = { factor = 60 }
	}
}

#Failed to Seduce. The captain offers band at increased cost.
character_event = {
	id = HF.23216
	desc = EVTDESCAHF23216
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = { #Pay
		name = EVTOPTAHF23216
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23216 }
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -2 min = -250 max = -450 }
		}
		location = {
            show_scope_change = no
			ROOT = {
            	show_scope_change = no
				spawn_unit = {
					province = PREV
					home = PREV
					owner = THIS
					leader = event_target:scoped_pirate_mercenary
					match_character = THIS
					match_mult = 0.25
					match_min = 150
					match_max = 1000
					attrition = 1.0
					cannot_inherit = yes
					earmark = pirate_mercenaries
					is_looter = yes
					can_toggle_looting = no
				}
			}
		}
		hidden_tooltip = { event_target:scoped_pirate_mercenary = { diplomatic_immunity = no } }
		hidden_tooltip = { character_event = { id = HF.23217 days = 350 random = 50 } } #Disband
		ai_chance = { factor = 20 }
	}
	option = { #Let the thugs go.
		name = EVTOPTBHF23216
		custom_tooltip = { text = TOOLTIP_EVTOPTDHB23216 }
		hidden_tooltip = { event_target:scoped_pirate_mercenary = { death = { death_reason = death_missing } } }
		ai_chance = { factor = 0 }
	}
}

#Mercenaries disband after a year.
character_event = {
	id = HF.23217
	desc = EVTDESCAHF23217
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	trigger = {
		has_earmarked_regiments = pirate_mercenaries
	}

	option = { #Pay
		name = EVTOPTAHF23217
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23217 }
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -1.5 min = -150 max = -350 }
		}
		hidden_tooltip = { character_event = { id = HF.23217 days = 150 random = 150 } } #Repeat event until you disband them.
		ai_chance = { factor = 20 }
	}
	option = { #Disband.
		name = EVTOPTBHF23217
		custom_tooltip = { text = TOOLTIP_EVTOPTBHF23217 }
		hidden_tooltip = {
			disband_event_forces = pirate_mercenaries
			event_target:scoped_pirate_mercenary = { death = { death_reason = death_missing } }
		}
		ai_chance = { factor = 80 }
	}
}

#Pirate was able to kill mercenary leader in duel.
character_event = {
	id = HF.23218
	desc = EVTDESCAHF23218
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23218
		location = {
            show_scope_change = no
			ROOT = {
            	show_scope_change = no
				spawn_unit = {
					province = PREV
					home = PREV
					owner = THIS
					#leader = event_target:scoped_pirate_mercenary
					match_character = THIS
					match_mult = 0.25
					match_min = 150
					match_max = 1000
					attrition = 1.0
					cannot_inherit = yes
					earmark = pirate_mercenaries_perm
					is_looter = yes
				}
			}
		}
		ai_chance = { factor = 20 }
	}
}

#on_looting_pulse: chance to sneak inside city.
character_event = {
	id = HF.23219
	desc = {
		trigger = {
			FROM = { holding_type = castle }
		}
		text = EVTDESCAHF23219
	}
	desc = {
		trigger = {
			FROM = { holding_type = city }
		}
		text = EVTDESCBHF23219
	}
	desc = {
		trigger = {
			FROM = { holding_type = temple }
		}
		text = EVTDESCCHF23219
	}
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	has_dlc = "Holy Fury"

	trigger = {
		is_landed = yes
		siege = {
			is_attacker = yes
		}
		this_is_sea_raider_trigger = yes
		FROM = {
			OR = {
				holding_type = castle
				holding_type = city
				holding_type = temple
			}
		}
		FROM = {
			NOR = {
				is_tribal = yes
				is_nomadic = yes
				has_province_modifier = recent_pirate_infiltration_cooldown
			}
			num_of_settlements = 4 #Only fires for medium or big cities.
		}
		location = {
			province = FROM
			ROOT = {
				any_realm_province = { #Avoid the event firing for raiders who raided on land all the way to the port of a sea they do not have access to.
					port = yes
					TECH_NAVAL = 1
					OR = {
						has_building = tb_shipyard_1
						has_building = ca_shipyard_1
						has_building = tp_shipyard_1
						has_building = ct_shipyard_1
					}
					can_naval_path_to = PREVPREV
				}
			}
		}
	}
	immediate = { FROM = { add_province_modifier = { name = recent_pirate_infiltration_cooldown years = 10 hidden = yes } } }

	#Full frontal assault with longships.
	#Dress as priest/priestess. (temple only)
	#Seduce guards. (castle only)
	#Spread on the countryside to pillage farms (city only)

	#Nothing (continue regular blockade)

	option = { #Full assault - combat_rating-based
		name = EVTOPTAHF23219
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23219 }
		hidden_tooltip = {
			random_list = {
				60 = {
					good_soldier_outcome_score = yes
					character_event = { id = HF.23220 } #Success
				}
				40 = {
					bad_soldier_outcome_score = yes
					character_event = { id = HF.23221 } #Failure
				}
			}
		}
	}
	option = { #Sneak inside temple while dressed as priest
		name = EVTOPTBHF23219
		trigger = {
			FROM = { holding_type = temple }
			OR = {  #check doctrines
				AND = {
					is_female = yes
					FROM = { owner = { has_religion_feature = religion_matriarchal } }
				}
				AND = {
					is_female = no
					FROM = { owner = { NOT = { has_religion_feature = religion_matriarchal } } }
				}
				FROM = { owner = { has_religion_feature = religion_equal } }
				FROM = {
					owner = {
						is_reformed_religion = no
						NOT = { has_religion_feature = religion_patriarchal } #Random World Checks.
						NOT = { has_religion_feature = religion_matriarchal }
					}
				}
			}
		}
		custom_tooltip = { text = TOOLTIP_EVTOPTBHF23219 }
		hidden_tooltip = {
			random_list = { #Outcome based on intrigue and a bit of learning.
				60 = {
					is_good_intrigue_character_score = yes
					modifier = {
						factor = 1.25
						learning = 10
					}
					modifier = {
						factor = 1.25
						learning = 12
					}
					modifier = {
						factor = 1.25
						learning = 14
					}
					modifier = {
						factor = 1.25
						learning = 16
					}
					character_event = { id = HF.23222 } #Success
				}
				40 = {
					is_bad_intrigue_character_score = yes
					character_event = { id = HF.23223 } #Failure
				}
			}
		}
	}
	option = { #Dress up and seduce guards of castle.
		name = EVTOPTCHF23219
		trigger = {
			FROM = { holding_type = castle }
			OR = {  #check doctrines
				AND = {
					is_female = yes
					FROM = { NOT = { owner = { has_religion_feature = religion_matriarchal } } }
				}
				AND = {
					is_female = no
					FROM = { owner = { has_religion_feature = religion_matriarchal } }
				}
				FROM = { owner = { has_religion_feature = religion_equal } }
			}
		}
		custom_tooltip = { text = TOOLTIP_EVTOPTCHF23219 }
		hidden_tooltip = {
			random_list = { #Outcome based on intrigue and attraction score.
				60 = {
					is_good_intrigue_character_score = yes
					modifier = {
						factor = 1.75
						is_attractive_trigger = yes
						NOT = { age = 30 }
					}
					modifier = {
						factor = 1.5
						is_attractive_trigger = yes
						age = 30
						NOT = { age = 40 }
					}
					character_event = { id = HF.23224 } #Success
				}
				40 = {
					is_bad_intrigue_character_score = yes
					modifier = {
						factor = 1.75
						is_unattractive_trigger = yes
					}
					modifier = {
						factor = 1.25
						age = 40
					}
					modifier = {
						factor = 1.5
						age = 50
					}
					character_event = { id = HF.23225 } #Failure
				}
			}
		}
	}
	option = { #Spread through the Countryside.
		name = EVTOPTDHF23219
		custom_tooltip = { text = TOOLTIP_EVTOPTDHF23219 }
		trigger = {
			FROM = { holding_type = city }
		}
		hidden_tooltip = {
			random_list = { #Less risky than the above options, but with lesser reward.
				75 = {
					good_soldier_outcome_score = yes
					character_event = { id = HF.23226 } #Success
				}
				25 = {
					bad_soldier_outcome_score = yes
					character_event = { id = HF.23227 } #Failure
				}
			}
		}
	}
	option = { #Wait.
		name = EVTOPTEHF23219
		custom_tooltip = { text = TOOLTIP_EVTOPTEHF23219 }
	}
}

#Success: Full assault.
character_event = {
	id = HF.23220
	desc = EVTDESCAHF23220
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = 0.05
			troops = -0.015
			enemy = {
				morale = -0.05
				troops = -0.15
			}
		}
	}
	option = {
		name = EVTOPTAHF23220
		tooltip = {
			siege = {
				morale = 0.05
				troops = -0.015
				enemy = {
					morale = -0.05
					troops = -0.15
				}
			}
		}
		ai_chance = { factor = 100 }
	}
}
#Failure: Full assault.
character_event = {
	id = HF.23221
	desc = EVTDESCAHF23221
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = -0.25
			troops = -0.15
			enemy = {
				morale = 0.15
				troops = -0.015
			}
		}
	}
	option = {
		name = EVTOPTAHF23221
		tooltip = { #Just a tooltip, apply the effect before, to avoid cheating.
			siege = {
				morale = -0.25
				troops = -0.15
				enemy = {
					morale = 0.15
					troops = -0.015
				}
			}
		}
		ai_chance = { factor = 100 }
	}
}

#Success: Infiltrated Temple.
character_event = {
	id = HF.23222
	desc = EVTDESCAHF23222
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	#Steal wealth from temple.
	#Desecrate temple.

	immediate  = {
		siege = {
			morale = 0.05
			enemy = {
				morale = -0.05
			}
		}
	}
	option = {
		name = EVTOPTAHF23222
		scaled_wealth = { value = 1 min = 50 max = 150 }
		tooltip = {
			siege = {
				morale = 0.05
				enemy = {
					morale = -0.05
				}
			}
		}
		ai_chance = { factor = 50 }
	}
	option = {
		name = EVTOPTBHF23222
		trigger = { FROMFROM = { owner = { NOT = { religion = ROOT } } } } #Only available if temple is not of same religion.
		piety = 75
		tooltip = {
			siege = {
				morale = 0.05
				enemy = {
					morale = -0.05
				}
			}
		}
		ai_chance = { factor = 50 }
	}
}

#Failure: Infiltrated Temple.
character_event = {
	id = HF.23223
	desc = EVTDESCAHF23223
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = -0.25
			enemy = {
				morale = 0.15
			}
		}
	}

	option = {
		name = EVTOPTAHF23223
		tiered_prestige_negative_effect = yes
		tooltip = {
			siege = {
				morale = -0.25
				enemy = {
					morale = 0.15
				}
			}
		}
		ai_chance = { factor = 50 }
	}
}

#Success: Infiltrated Castle.
character_event = {
	id = HF.23224
	desc = EVTDESCAHF23224
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = 0.15
			enemy = {
				troops = -0.25
			}
		}
	}

	option = {
		name = EVTOPTAHF23224
		tiered_prestige_negative_effect = yes
		tooltip = {
			siege = {
				morale = 0.15
				enemy = {
					troops = -0.25
				}
			}
		}
		ai_chance = { factor = 50 }
	}
}

#Failure: Infiltrated Castle.
character_event = {
	id = HF.23225
	desc = EVTDESCAHF23225
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = -0.15
			enemy = {
				morale = 0.25
			}
		}
	}

	option = {
		name = EVTOPTAHF23225
		tiered_prestige_negative_effect = yes
		tooltip = {
			siege = {
				morale = -0.15
				enemy = {
					morale = 0.25
				}
			}
		}
		random = { chance = 25 add_trait = wounded }
		ai_chance = { factor = 50 }
	}
}

#Success: Spread through Countryside.
character_event = {
	id = HF.23226
	desc = EVTDESCAHF23226
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = 0.05
			enemy = {
				troops = -0.05
			}
		}
	}

	option = {
		name = EVTOPTAHF23226
		tiered_prestige_reward_effect = yes
		tooltip = {
			siege = {
				morale = 0.05
				enemy = {
					troops = -0.05
				}
			}
		}
		ai_chance = { factor = 50 }
	}
}
#Failure: Spread through Countryside.
character_event = {
	id = HF.23227
	desc = EVTDESCAHF23227
	picture = {
		trigger = { is_female = no }
		picture = GFX_evt_vikings_arriving_oldgods
	}
	picture = {
		trigger = { is_female = yes }
		picture = GFX_evt_norse_tempest
	}
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = -0.05
			enemy = {
				morale = 0.05
			}
		}
	}

	option = {
		name = EVTOPTAHF23227
		tiered_prestige_negative_effect = yes
		tooltip = {
			siege = {
				morale = -0.05
				enemy = {
					morale = 0.05
				}
			}
		}
		ai_chance = { factor = 50 }
	}
}

#HF.23228-HF.23399 Left empty... for now.

##############################################################################################
##############################################################################################

#Flavor Doctrine events: Astrology + Haruspicy causes Religious Head to interpret the stars 10-yearly. (Or your Court Chaplain if No Rel Head exists)

#Main event for religious head (it is localized, because the religious head might be Temporal).
narrative_event = {
	id = HF.23400
	title = EVTTITLEAHF23400
	desc = {
		trigger = { has_character_flag = flag_astrology_very_good_omen }
		text = EVTDESCAHF23400
	}
	desc = {
		trigger = { has_character_flag = flag_astrology_good_omen }
		text = EVTDESCBHF23400
	}
	desc = {
		trigger = { has_character_flag = flag_astrology_ambiguous_omen }
		text = EVTDESCCHF23400
	}
	desc = {
		trigger = { has_character_flag = flag_astrology_bad_omen }
		text = EVTDESCDHF23400
	}
	desc = {
		trigger = { has_character_flag = flag_astrology_very_bad_omen }
		text = EVTDESCEHF23400
	}
	picture = GFX_evt_comet
	border = GFX_event_narrative_frame_religion

	is_triggered_only = yes

	trigger = {
		controls_religion = yes
		NOR = {
			has_character_modifier = astrology_very_good_omen
			has_character_modifier = astrology_good_omen
			has_character_modifier = astrology_ambiguous_omen
			has_character_modifier = astrology_bad_omen
			has_character_modifier = astrology_very_bad_omen
		}
		OR = {
			AND = {
				has_religion_feature = religion_haruspicy
				has_religion_feature = religion_astrology
			}
		}
	}
	immediate = {
		random_list = {
			5 = {
				modifier = { factor = 1.15 piety = 50 }
				modifier = { factor = 1.15 piety = 100 }
				modifier = { factor = 1.15 piety = 150 }
				modifier = { factor = 1.15 piety = 200 }
				modifier = { factor = 1.15 piety = 250 }
				modifier = { factor = 1.15 piety = 350 }
				modifier = { factor = 1.25 piety = 500 }
				set_character_flag = flag_astrology_very_good_omen
			}
			10 = {
				set_character_flag = flag_astrology_good_omen
			}
			20 = {
				set_character_flag = flag_astrology_ambiguous_omen
			}
			10 = {
				set_character_flag = flag_astrology_bad_omen
			}
			5 = {
				set_character_flag = flag_astrology_very_bad_omen
			}
		}
	}
	#Reinterpret bad omen using high learning/Boost ambiguous or good omen with high learning.
	#Spread the news.
	#Ignore the omen.

	option = { #Reinterpet less favorable omen to prevent bad modifier.
		name = EVTOPTAHF23400
		trigger = {
			learning = 15
			NOT = { has_character_flag = flag_astrology_very_good_omen }
		}
		tooltip_info = learning
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23400 }
		if = {
			limit = {
				has_character_flag = flag_astrology_good_omen
			}
			clr_character_flag = flag_astrology_good_omen
			add_character_modifier = { name = astrology_very_good_omen years = 2 }
		}
		if = {
			limit = {
				has_character_flag = flag_astrology_ambiguous_omen
			}
			clr_character_flag = flag_astrology_ambiguous_omen
			add_character_modifier = { name = astrology_good_omen years = 2 }
		}
		if = {
			limit = {
				has_character_flag = flag_astrology_bad_omen
			}
			clr_character_flag = flag_astrology_bad_omen
			add_character_modifier = { name = astrology_ambiguous_omen years = 2 }
		}
		hidden_tooltip = {
			change_variable = { which = haruspicy_testing_fate value = 1 }
			random = {
				chance = 1
				modifier = {
					factor = 5
					trait = ambitious
				}
				modifier = {
					factor = 1.5
					trait = proud
				}
				testing_fate_variable_character_score = yes
				character_event = { id = HF.23402 days = 25 random = 25 } #The gods did not appreciate your hubris.
			}
		}
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					religion = ROOT
					higher_tier_than = COUNT
				}
				narrative_event = { id = HF.23401 }
			}
		}
		ai_chance = {
			factor = 25
		}
	}
	option = { #Spread the news.
		name = EVTOPTBHF23400
		custom_tooltip = { text = TOOLTIP_EVTOPTBHF23400 }
		if = {
			limit = {
				has_character_flag = flag_astrology_very_good_omen
			}
			add_character_modifier = { name = astrology_very_good_omen years = 2 }
			religion_authority = {
				modifier = haruspicy_very_good_omen
				years = 50
			}
			clr_character_flag = flag_astrology_very_good_omen
		}
		if = {
			limit = {
				has_character_flag = flag_astrology_good_omen
			}
			add_character_modifier = { name = astrology_good_omen years = 2 }
			clr_character_flag = flag_astrology_good_omen
		}
		if = {
			limit = {
				has_character_flag = flag_astrology_ambiguous_omen
			}
			add_character_modifier = { name = astrology_ambiguous_omen years = 2 }
			clr_character_flag = flag_astrology_ambiguous_omen
		}
		if = {
			limit = {
				has_character_flag = flag_astrology_bad_omen
			}
			add_character_modifier = { name = astrology_bad_omen years = 2 }
			clr_character_flag = flag_astrology_bad_omen
		}
		if = {
			limit = {
				has_character_flag = flag_astrology_very_bad_omen
			}
			add_character_modifier = { name = astrology_very_bad_omen years = 2 }
			religion_authority = {
				modifier = haruspicy_very_bad_omen
				years = 50
			}
			clr_character_flag = flag_astrology_very_bad_omen
		}
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					religion = ROOT
					higher_tier_than = COUNT
				}
				narrative_event = { id = HF.23401 }
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.5
				trait = zealous
			}
			modifier = {
				factor = 1.5
				trait = craven
			}
		}
	}
	option = { #Ignore the omen.
		name = EVTOPTCHF23400
		custom_tooltip = { text = TOOLTIP_EVTOPTCHF23400 }
		if = {
			limit = {
				NOR = {
					trait = cynical
					trait = zealous
				}
			}
			random = { chance = 15 add_trait = cynical }
		}
		if = {
			limit = {
				trait = zealous
			}
			random = { chance = 15 remove_trait = zealous }
		}
		tiered_piety_negative_effect = yes
		hidden_tooltip = {
			change_variable = { which = haruspicy_testing_fate value = 2 }
			random = {
				chance = 1
				modifier = {
					factor = 5
					trait = cynical
				}
				testing_fate_variable_character_score = yes
				character_event = { id = HF.23402 days = 25 random = 25 } #The gods did not appreciate your cynicism.
			}
			clr_character_flag = flag_astrology_very_good_omen
			clr_character_flag = flag_astrology_good_omen
			clr_character_flag = flag_astrology_ambiguous_omen
			clr_character_flag = flag_astrology_bad_omen
			clr_character_flag = flag_astrology_very_bad_omen
		}
		ai_chance = {
			factor = 10
			modifier = {
				factor = 5
				trait = cynical
			}
		}
	}
}

#Main event for the rulers.
narrative_event = {
	id = HF.23401
	title = EVTTITLEAHF23401
	desc = {
		trigger = { FROM = { has_character_modifier = astrology_very_good_omen } }
		text = EVTDESCAHF23401
	}
	desc = {
		trigger = { FROM = { has_character_modifier = astrology_good_omen } }
		text = EVTDESCBHF23401
	}
	desc = {
		trigger = { FROM = { has_character_modifier = astrology_ambiguous_omen } }
		text = EVTDESCCHF23401
	}
	desc = {
		trigger = { FROM = { has_character_modifier = astrology_bad_omen } }
		text = EVTDESCDHF23401
	}
	desc = {
		trigger = { FROM = { has_character_modifier = astrology_very_bad_omen } }
		text = EVTDESCEHF23401
	}
	picture = GFX_evt_comet
	border = GFX_event_narrative_frame_religion

	is_triggered_only = yes

	#Accept response.
	#Make great offering to improve modifier.

	option = { #Make great offering to improve modifier.
		name = EVTOPTAHF23401
		tiered_piety_reward_effect = yes
		trigger = {
			FROM = {
				OR = {
					has_character_modifier = astrology_ambiguous_omen
					has_character_modifier = astrology_bad_omen
					has_character_modifier = astrology_very_bad_omen
				}
			}
		}
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -1.5 min = -150 max = -400 }
		}
		if = {
			limit = {
				FROM = { has_character_modifier = astrology_ambiguous_omen }
			}
			add_character_modifier = { name = astrology_good_omen years = 2 }
		}
		if = {
			limit = {
				FROM = { has_character_modifier = astrology_bad_omen }
			}
			add_character_modifier = { name = astrology_ambiguous_omen years = 2 }
		}
		if = {
			limit = {
				FROM = { has_character_modifier = astrology_very_bad_omen }
			}
			add_character_modifier = { name = astrology_bad_omen years = 2 }
		}
		ai_chance = {
			factor = 10
		}
	}
	option = { #Accept response.
		name = {
			text = EVTOPTBHF23401_A
			trigger = {
				has_character_modifier = astrology_very_good_omen
			}
		}
		name = {
			text = EVTOPTBHF23401_B
			trigger = {
				has_character_modifier = astrology_good_omen
			}
		}
		name = {
			text = EVTOPTBHF23401_C
			trigger = {
				has_character_modifier = astrology_ambiguous_omen
			}
		}
		name = {
			text = EVTOPTBHF23401_D
			trigger = {
				has_character_modifier = astrology_bad_omen
			}
		}
		name = {
			text = EVTOPTBHF23401_E
			trigger = {
				has_character_modifier = astrology_very_bad_omen
			}
		}
		if = {
			limit = {
				FROM = { has_character_modifier = astrology_very_good_omen }
			}
			add_character_modifier = { name = astrology_very_good_omen years = 2 }
		}
		if = {
			limit = {
				FROM = { has_character_modifier = astrology_good_omen }
			}
			add_character_modifier = { name = astrology_good_omen years = 2 }
		}
		if = {
			limit = {
				FROM = { has_character_modifier = astrology_ambiguous_omen }
			}
			add_character_modifier = { name = astrology_ambiguous_omen years = 2 }
		}
		if = {
			limit = {
				FROM = { has_character_modifier = astrology_bad_omen }
			}
			add_character_modifier = { name = astrology_bad_omen years = 2 }
		}
		if = {
			limit = {
				FROM = { has_character_modifier = astrology_very_bad_omen }
			}
			add_character_modifier = { name = astrology_very_bad_omen years = 2 }
		}
		ai_chance = {
			factor = 100
		}
	}
}

#Tempted fate once too often. Religious head dies.
character_event = {
	id = HF.23402
	desc = EVTDESCAHF23402
	desc = EVTDESCBHF23402
	desc = EVTDESCCHF23402
	desc = EVTDESCDHF23402
	desc = EVTDESCEHF23402
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23402
		religion_authority = {
			modifier = haruspicy_tempted_faith
			years = 50
		}
		death = { death_reason = death_accident }
		hidden_tooltip = {
			any_player = {
				limit = { religion = ROOT }
				character_event = { id = HF.23403 days = 5 random = 5 }
			}
		}
	}
}

#Players of same religion are notified.
character_event = {
	id = HF.23403
	desc = EVTDESCAHF23403
	desc = EVTDESCBHF23403
	desc = EVTDESCCHF23403
	desc = EVTDESCDHF23403
	desc = EVTDESCEHF23403
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23403
		tooltip = { #Only applied once on the religious head's event.
			religion_authority = {
				modifier = haruspicy_tempted_faith
				years = 50
			}
		}
	}
}

#Main event for Court Chaplain of Kings and above (Only if no religious head exists).
narrative_event = {
	id = HF.23404
	title = EVTTITLEAHF23404
	desc = {
		trigger = { has_character_flag = flag_astrology_good_omen }
		text = EVTDESCAHF23404
	}
	desc = {
		trigger = { has_character_flag = flag_astrology_ambiguous_omen }
		text = EVTDESCBHF23404
	}
	desc = {
		trigger = { has_character_flag = flag_astrology_bad_omen }
		text = EVTDESCCHF23404
	}
	picture = GFX_evt_comet
	border = GFX_event_narrative_frame_religion

	is_triggered_only = yes

	trigger = {
		has_job_title = job_spiritual
		independent = no
		liege = {
			higher_tier_than = DUKE
			religion = ROOT
			NOT = { character = ROOT }
		}
		NOR = {
			has_character_modifier = astrology_good_omen
			has_character_modifier = astrology_ambiguous_omen
			has_character_modifier = astrology_bad_omen
		}
		AND = {
			has_religion_feature = religion_haruspicy
			has_religion_feature = religion_astrology
			has_religion_feature = religion_no_leader
		}
	}
	immediate = {
		random_list = {
			10 = {
				modifier = { factor = 1.15 piety = 50 }
				modifier = { factor = 1.15 piety = 100 }
				modifier = { factor = 1.15 piety = 150 }
				modifier = { factor = 1.15 piety = 200 }
				modifier = { factor = 1.15 piety = 250 }
				modifier = { factor = 1.15 piety = 350 }
				modifier = { factor = 1.25 piety = 500 }
				set_character_flag = flag_astrology_good_omen
			}
			10 = {
				set_character_flag = flag_astrology_ambiguous_omen
			}
			10 = {
				set_character_flag = flag_astrology_bad_omen
			}
		}
	}
	#Tell liege.
	option = {
		name = EVTOPTAHF23404
		tooltip = {
			liege = {
				if = {
					limit = {
						ROOT = { has_character_flag = flag_astrology_good_omen }
					}
					add_character_modifier = { name = astrology_good_omen years = 2 }
				}
				if = {
					limit = {
						ROOT = { has_character_flag = flag_astrology_ambiguous_omen }
					}
					add_character_modifier = { name = astrology_ambiguous_omen years = 2 }
				}
				if = {
					limit = {
						ROOT = { has_character_flag = flag_astrology_bad_omen }
					}
					add_character_modifier = { name = astrology_bad_omen years = 2 }
				}
			}
		}
		hidden_tooltip = {
			liege = {
				narrative_event = { id = HF.23405 }
			}
		}
		ai_chance = {
			factor = 100
		}
	}
}

#Main event for the rulers. (from Chaplain)
narrative_event = {
	id = HF.23405
	title = EVTTITLEAHF23405
	desc = {
		trigger = { FROM = { has_character_flag = flag_astrology_good_omen } }
		text = EVTDESCAHF23405
	}
	desc = {
		trigger = { FROM = { has_character_flag = flag_astrology_ambiguous_omen } }
		text = EVTDESCBHF23405
	}
	desc = {
		trigger = { FROM = { has_character_flag = flag_astrology_bad_omen } }
		text = EVTDESCCHF23405
	}
	picture = GFX_evt_comet
	border = GFX_event_narrative_frame_religion

	is_triggered_only = yes

	#Accept response.
	#Make great offering to improve modifier.

	option = { #Make great offering to improve modifier.
		name = EVTOPTAHF23405
		tiered_piety_reward_effect = yes
		trigger = {
			FROM = {
				OR = {
					has_character_flag = flag_astrology_ambiguous_omen
					has_character_flag = flag_astrology_bad_omen
				}
			}
		}
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -1.5 min = -150 max = -400 }
		}
		if = {
			limit = {
				FROM = { has_character_flag = flag_astrology_ambiguous_omen }
			}
			add_character_modifier = { name = astrology_good_omen years = 2 }
		}
		if = {
			limit = {
				FROM = { has_character_flag = flag_astrology_bad_omen }
			}
			add_character_modifier = { name = astrology_ambiguous_omen years = 2 }
		}
		ai_chance = {
			factor = 10
		}
	}
	option = { #Accept response.
		name = EVTOPTBHF23405
		if = {
			limit = {
				FROM = { has_character_flag = flag_astrology_good_omen }
			}
			add_character_modifier = { name = astrology_good_omen years = 2 }
		}
		if = {
			limit = {
				FROM = { has_character_flag = flag_astrology_ambiguous_omen }
			}
			add_character_modifier = { name = astrology_ambiguous_omen years = 2 }
		}
		if = {
			limit = {
				FROM = { has_character_flag = flag_astrology_bad_omen }
			}
			add_character_modifier = { name = astrology_bad_omen years = 2 }
		}
		ai_chance = {
			factor = 100
		}
	}
	option = { #Ignore the omen.
		name = EVTOPTCHF23405
		if = {
			limit = {
				NOR = {
					trait = cynical
					trait = zealous
				}
			}
			random = { chance = 15 add_trait = cynical }
		}
		if = {
			limit = {
				trait = zealous
			}
			random = { chance = 15 remove_trait = zealous }
		}
		tiered_piety_negative_effect = yes
		hidden_tooltip = {
			change_variable = { which = haruspicy_testing_fate value = 1 }
			random = {
				chance = 1
				modifier = {
					factor = 5
					trait = cynical
				}
				testing_fate_variable_character_score = yes
				character_event = { id = HF.23406 days = 25 random = 25 } #The gods did not appreciate your cynicism.
			}
		}
		ai_chance = {
			factor = 10
			modifier = {
				factor = 5
				trait = cynical
			}
		}
	}
	after = {
		FROM = {
			clr_character_flag = flag_astrology_good_omen
			clr_character_flag = flag_astrology_ambiguous_omen
			clr_character_flag = flag_astrology_bad_omen
		}
	}
}

#Tempted fate once too often. Ruler dies.
character_event = {
	id = HF.23406
	desc = EVTDESCAHF23406
	desc = EVTDESCBHF23406
	desc = EVTDESCCHF23406
	#desc = EVTDESCDHF23406
	desc = EVTDESCEHF23406
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23406
		death = { death_reason = death_accident }
	}
}

###############################################################################
###############################################################################
# Haruspicy + Bloodthirsty Gods allows to read your fortune when killing a notable prisoner.

#On_death: Hidden ping from the prisoner.
character_event = {
	id = HF.23410
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_ruler = yes
		higher_real_tier_than = COUNT
		OR = {
			death_execution_trigger = yes
			death_sacrificed_trigger = yes
		}
		killer = {
			NOR = { #Shouldn't already have one of the main effects.
				has_character_modifier = cannibal_haruspicy_sacrifice
				has_character_modifier = martial_haruspicy_sacrifice
				has_character_modifier = intrigue_def_haruspicy_sacrifice
				has_character_modifier = intrigue_att_haruspicy_sacrifice
				has_character_modifier = stewardship_haruspicy_sacrifice
				has_character_modifier = negative_haruspicy_sacrifice
			}
			is_playable = yes
			is_landed = yes
			NOT = { trait = incapable }
			has_religion_feature = religion_ritual_sacrifice
			has_religion_feature = religion_haruspicy
		}
	}

	immediate = {
		killer = {
			character_event = { id = HF.23411 }
		}
	}
}

#Executioner offered chance of reading his future.
character_event = {
	id = HF.23411
	title = EVTTITLEAHF23411
	desc = EVTDESCAHF23411
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	#Cannibal eats his remains to gain strength.
	#Mystic knows how to do it.
	#Regular option.
	#Do nothing.

	option = { #Cannibal eats his remains to gain strength.
		name = EVTOPTAHF23411
		trigger = {
			trait = cannibal_trait
			NOT = { FROM = { death_reason = death_execution_eaten } } #Nothing left to eat.
		}
		tooltip_info = cannibal_trait
		tiered_piety_negative_effect = yes
		hidden_tooltip = {
			random_list = {
				25 = { character_event = { id = HF.23412 } } #Add modifier
				25 = {
					trigger = {
						NOT = {
							has_character_modifier = blessing_of_health
						}
					}
					character_event = { id = HF.23413 } #Add health modifier.
				}
				25 = {
					trigger = {
						OR = {
							has_disease_trigger = yes
							trait = ill
							has_character_flag = developing_illness
						}
					}
					character_event = { id = HF.23414 } #Remove sickness
				}
				1 = {
					trigger = {
						NOT = {
							trait = lunatic
						}
					}
					character_event = { id = HF.23415 } #Add insanity
				}
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0.5
				NOT = { piety = 100 }
			}
		}
	}
	option = { #Mystic knows how to do it.
		name = EVTOPTBHF23411
		trigger = { trait = mystic }
		tooltip_info = mystic
		tiered_piety_negative_effect = yes
		hidden_tooltip = {
			random_list = {
				5 = {
					trigger = {
						piety = 100
						learning = 15
						NOT = { has_religion_feature = religion_peaceful } #Incompatible with Bloodthirsty anyway, but, just in case...
					}
					character_event = { id = HF.23422 } #Bonus action for Mystics - chance to increase MA.
				}
				25 = { character_event = { id = HF.23416 } } #Add martial modifier
				25 = { character_event = { id = HF.23417 } } #Add intrigue def modifier
				25 = { character_event = { id = HF.23418 } } #Add intrigue att modifier
				25 = { character_event = { id = HF.23419 } } #Add stewardship modifier
				10 = {
					modifier = {
						factor = 0.9
						learning = 10
					}
					modifier = {
						factor = 0.9
						learning = 12
					}
					modifier = {
						factor = 0.9
						learning = 14
					}
					modifier = {
						factor = 0.9
						learning = 16
					}
					modifier = {
						factor = 0.9
						learning = 18
					}
					modifier = {
						factor = 0.9
						learning = 20
					}
					modifier = {
						factor = 0.8
						learning = 25
					}
					modifier = {
						factor = 0.8
						piety = 50
					}
					modifier = {
						factor = 0.8
						piety = 100
					}
					modifier = {
						factor = 0.8
						piety = 150
					}
					modifier = {
						factor = 0.8
						piety = 200
					}
					modifier = {
						factor = 0.8
						piety = 250
					}
					modifier = {
						factor = 0.8
						piety = 300
					}
					character_event = { id = HF.23420 } #Inconclusive results.
				}
				5 = {
					modifier = {
						factor = 0.9
						learning = 10
					}
					modifier = {
						factor = 0.9
						learning = 12
					}
					modifier = {
						factor = 0.9
						learning = 14
					}
					modifier = {
						factor = 0.9
						learning = 16
					}
					modifier = {
						factor = 0.9
						learning = 18
					}
					modifier = {
						factor = 0.9
						learning = 20
					}
					modifier = {
						factor = 0.8
						learning = 25
					}
					modifier = {
						factor = 0.8
						piety = 50
					}
					modifier = {
						factor = 0.8
						piety = 100
					}
					modifier = {
						factor = 0.8
						piety = 150
					}
					modifier = {
						factor = 0.8
						piety = 200
					}
					modifier = {
						factor = 0.8
						piety = 250
					}
					modifier = {
						factor = 0.8
						piety = 300
					}
					character_event = { id = HF.23421 } #Negative results.
				}
			}
		}
		ai_chance = {
			factor = 40
			modifier = {
				factor = 0.5
				NOT = { piety = 100 }
			}
		}
	}
	option = { #Regular option. - Same list as above, worse chances.
		name = EVTOPTCHF23411
		tiered_piety_negative_effect = yes
		hidden_tooltip = {
			random_list = {
				15 = { character_event = { id = HF.23416 } } #Add martial modifier
				15 = { character_event = { id = HF.23417 } } #Add intrigue def modifier
				15 = { character_event = { id = HF.23418 } } #Add intrigue att modifier
				15 = { character_event = { id = HF.23419 } } #Add stewardship modifier
				20 = {
					modifier = {
						factor = 0.9
						learning = 10
					}
					modifier = {
						factor = 0.9
						learning = 12
					}
					modifier = {
						factor = 0.9
						learning = 14
					}
					modifier = {
						factor = 0.9
						learning = 16
					}
					modifier = {
						factor = 0.9
						learning = 18
					}
					modifier = {
						factor = 0.9
						learning = 20
					}
					modifier = {
						factor = 0.8
						learning = 25
					}
					modifier = {
						factor = 0.8
						piety = 50
					}
					modifier = {
						factor = 0.8
						piety = 100
					}
					modifier = {
						factor = 0.8
						piety = 150
					}
					modifier = {
						factor = 0.8
						piety = 200
					}
					modifier = {
						factor = 0.8
						piety = 250
					}
					modifier = {
						factor = 0.8
						piety = 300
					}
					character_event = { id = HF.23420 } #Inconclusive results.
				}
				10 = {
					modifier = {
						factor = 0.9
						learning = 10
					}
					modifier = {
						factor = 0.9
						learning = 12
					}
					modifier = {
						factor = 0.9
						learning = 14
					}
					modifier = {
						factor = 0.9
						learning = 16
					}
					modifier = {
						factor = 0.9
						learning = 18
					}
					modifier = {
						factor = 0.9
						learning = 20
					}
					modifier = {
						factor = 0.8
						learning = 25
					}
					modifier = {
						factor = 0.8
						piety = 50
					}
					modifier = {
						factor = 0.8
						piety = 100
					}
					modifier = {
						factor = 0.8
						piety = 150
					}
					modifier = {
						factor = 0.8
						piety = 200
					}
					modifier = {
						factor = 0.8
						piety = 250
					}
					modifier = {
						factor = 0.8
						piety = 300
					}
					character_event = { id = HF.23421 } #Negative results.
				}
			}
		}
		ai_chance = {
			factor = 40
			modifier = {
				factor = 0.5
				NOT = { piety = 100 }
			}
		}
	}
	option = { #Do nothing.
		name = EVTOPTDHF23411
		ai_chance = {
			factor = 40
		}
	}
}

#Cannibal reinvigored from enemy's flesh.
character_event = {
	id = HF.23412
	desc = EVTDESCAHF23412
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23412
		add_character_modifier = {
			name = cannibal_haruspicy_sacrifice
			years = 5
		}
	}
}

#Cannibal feels healthier.
character_event = {
	id = HF.23413
	desc = EVTDESCAHF23413
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23413
		add_character_modifier = {
			name = blessing_of_health
			years = 5
		}
	}
}
#Cannibal's illness has been cured.
character_event = {
	id = HF.23414
	desc = EVTDESCAHF23414
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23414
		remove_disease_trait_effect = yes
		clr_character_flag = developing_illness
	}
}
#Cannibal has gone insane.
character_event = {
	id = HF.23415
	desc = EVTDESCAHF23415
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23415
		add_trait = lunatic
	}
}
#Martial bonus from bloodied haruspicy.
character_event = {
	id = HF.23416
	desc = EVTDESCAHF23416
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23416
		add_character_modifier = {
			name = martial_haruspicy_sacrifice
			years = 4
		}
	}
}
#Plot def bonus from bloodied haruspicy.
character_event = {
	id = HF.23417
	desc = EVTDESCAHF23417
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23417
		add_character_modifier = {
			name = intrigue_def_haruspicy_sacrifice
			years = 4
		}
	}
}
#Plot att bonus from bloodied haruspicy.
character_event = {
	id = HF.23418
	desc = EVTDESCAHF23418
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23418
		add_character_modifier = {
			name = intrigue_att_haruspicy_sacrifice
			years = 4
		}
	}
}
#Stewardship bonus from bloodied haruspicy.
character_event = {
	id = HF.23419
	desc = EVTDESCAHF23419
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23419
		add_character_modifier = {
			name = stewardship_haruspicy_sacrifice
			years = 4
		}
	}
}
#Inconclusive results from bloodied haruspicy.
character_event = {
	id = HF.23420
	desc = EVTDESCAHF23420
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23420
	}
}
#Negative results from bloodied haruspicy.
character_event = {
	id = HF.23421
	desc = EVTDESCAHF23421
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23421
		add_character_modifier = {
			name = negative_haruspicy_sacrifice
			years = 4
		}
	}
}
#Mystic managed to increase MA of his religion.
character_event = {
	id = HF.23422
	desc = EVTDESCAHF23422
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23422
		tiered_piety_reward_effect = yes
		religion_authority = {
			modifier = blood_haruspicy_positive
			years = 50
		}
		add_character_modifier = {
			name = religious_blood_haruspicy_sacrifice
			years = 4
		}
	}
}

############################################################################
# Bloodthirsty Gods/Aztecs
# Sacrifying prisoners increases burned_hearts_points variable, unlocking tiered traits. It's like Viking traits, but for psychos.
# Hidden on death event for the sacrifical victims.
character_event = {
	id = HF.23430
	hide_window = yes
	trigger = {
		has_dlc = "Holy Fury"
		death_sacrificed_trigger = yes
		killer = {
			is_playable = yes
			is_landed = yes
			NOT = { trait = incapable }
			has_religion_feature = religion_ritual_sacrifice
		}
	}

	is_triggered_only = yes

	immediate = {
		killer = {
			#Bonus points first.
			if = { #The gods appreciate your sacrifice.
				limit = {
					is_adult = no
					ROOT = { is_child_of = PREV }
				}
				change_variable = { which = burned_hearts_points value = 1 }
			}
			if = { #And a divine child is even better.
				limit = {
					is_adult = no
					ROOT = { religion = PREV }
					has_religion_feature = religion_holy_family
				}
				change_variable = { which = burned_hearts_points value = 1 }
			}
			if = { #A foreign religious head is also quite good.
				limit = {
					NOT = { religion = ROOT }
					controls_religion = yes
				}
				change_variable = { which = burned_hearts_points value = 2 }
			}
			if = { #A foreign emperor is also well accepted.
				limit = {
					NOT = { religion = ROOT }
					higher_tier_than = KING
				}
				change_variable = { which = burned_hearts_points value = 2 }
			}
			#Finally, a third point is added regardless in the following scripted effect, which will also trigger the events below, when the proper score is reached.
			bloodthirsty_tiered_traits_effect = yes
		}
	}
}
#Gained the Haemophiliac trait.
character_event = {
	id = HF.23431
	desc = EVTDESCAHF23431
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		NOT = { trait = bloodthirsty_gods_1 }
		has_religion_feature = religion_ritual_sacrifice
	}

	immediate = {
		add_trait = bloodthirsty_gods_1
	}

	option = {
		name = EVTOPTAHF23431
		add_trait = bloodthirsty_gods_1
		if = {
			limit = { NOR = { trait = kind trait = cruel } }
			random = {
				chance = 25
				add_trait = cruel
				hidden_tooltip = { character_event = { id = 38259 } }
			}
		}
		if = {
			limit = { trait = kind }
			random = {
				chance = 25
				remove_trait = kind
				hidden_tooltip = { character_event = { id = 38307 } }
			}
		}
		if = {
			limit = { trait = cynical }
			random = { chance = 25 remove_trait = cynical }
		}
	}
}
#Gained the Haemophant trait.
character_event = {
	id = HF.23432
	desc = EVTDESCAHF23432
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		has_religion_feature = religion_ritual_sacrifice
		NOR = {
			trait = bloodthirsty_gods_2
			trait = bloodthirsty_gods_3
		}
	}

	immediate = {
		add_trait = bloodthirsty_gods_2
	}

	option = {
		name = EVTOPTAHF23432
		if = {
			limit = { trait = bloodthirsty_gods_1 }
			remove_trait = bloodthirsty_gods_1
		}
		add_trait = bloodthirsty_gods_2
		if = {
			limit = { NOR = { trait = kind trait = cruel } }
			random = {
				chance = 50
				add_trait = cruel
				hidden_tooltip = { character_event = { id = 38259 } }
			}
		}
		if = {
			limit = { trait = kind }
			random = {
				chance = 50
				remove_trait = kind
				hidden_tooltip = { character_event = { id = 38307 } }
			}
		}
		if = {
			limit = { trait = cynical }
			random = {
				chance = 50
				remove_trait = cynical
			}
		}
	}
}
#Gained the Haemoarch trait.
character_event = {
	id = HF.23433
	desc = EVTDESCAHF23433
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		has_religion_feature = religion_ritual_sacrifice
		NOT = {
			trait = bloodthirsty_gods_3
		}
	}
	immediate = {
		add_trait = bloodthirsty_gods_3
	}

	option = {
		name = EVTOPTAHF23433
		if = {
			limit = { trait = bloodthirsty_gods_1 }
			remove_trait = bloodthirsty_gods_1
		}
		if = {
			limit = { trait = bloodthirsty_gods_2 }
			remove_trait = bloodthirsty_gods_2
		}
		add_trait = bloodthirsty_gods_3
		if = {
			limit = { NOR = { trait = kind trait = cruel } }
			random = {
				chance = 75
				add_trait = cruel
				hidden_tooltip = { character_event = { id = 38259 } }
			}
		}
		if = {
			limit = { trait = kind }
			remove_trait = kind
		}
		if = {
			limit = { trait = cynical }
			remove_trait = cynical
		}
	}
}
#Gained the Bloodthirsty Bloodline.
narrative_event = {
	id = HF.23434
	title = EVTTITLE23434
	desc = EVTDESCAHF23434
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_narrative_frame_religion
	sound = bloodline_added

	is_triggered_only = yes

	trigger = {
		has_religion_feature = religion_ritual_sacrifice
		NOT = {
			any_owned_bloodline = { # Not already has a Bloodthirsty bloodline.
				has_bloodline_flag = bloodline_created_bloodthirsty
			}
		}
	}

	option = {
		name = EVTOPTAHF23434
		hidden_tooltip = {
			if = {
				limit = { this_has_super_cool_nickname_trigger = no }
				random_list = {
					20 = {
						give_nickname = nick_the_red_storm
					}
					20 = {
						give_nickname = nick_the_scarlet_hands
					}
					20 = {
						give_nickname = nick_the_blood_monger
					}
					20 = {
						give_nickname = nick_the_black_skull
					}
					20 = {
						give_nickname = nick_the_heart_eater
					}
					20 = {
						give_nickname = nick_the_slaughterer
					}
					20 = {
						give_nickname = nick_the_soul_flayer
					}
					20 = {
						give_nickname = nick_the_spirit_stalker
					}
					10 = {
						give_nickname = nick_the_crimson_reaper
					}
					10 = {
						give_nickname = nick_the_dreaded
					}
					5 = {
						give_nickname = nick_the_chest_buster
					}
				}
			}
		}
		if = {
			limit = { is_female = no }
			create_bloodline = {
				type = bloodthirsty_male_bloodline
			}
			new_bloodline = {
				set_description = "bloodline_desc_bloodthirsty_gods_bloodline"
				random_list = {
					20 = { set_name = bloodline_bloodthirsty_name_random_a } #Randomize names to avoid too much repetition.
					20 = { set_name = bloodline_bloodthirsty_name_random_b }
					20 = { set_name = bloodline_bloodthirsty_name_random_c }
					20 = { set_name = bloodline_bloodthirsty_name_random_d }
					20 = { set_name = bloodline_bloodthirsty_name_random_e }
					20 = { set_name = bloodline_bloodthirsty_name_random_f }
				}
			}
		}
		if = {
			limit = { is_female = yes }
			create_bloodline = {
				type = bloodthirsty_female_bloodline
			}
			new_bloodline = {
				set_description = "bloodline_desc_bloodthirsty_gods_bloodline"
				random_list = {
					20 = { set_name = bloodline_bloodthirsty_name_random_a } #Randomize names to avoid too much repetition.
					20 = { set_name = bloodline_bloodthirsty_name_random_b }
					20 = { set_name = bloodline_bloodthirsty_name_random_c }
					20 = { set_name = bloodline_bloodthirsty_name_random_d }
					20 = { set_name = bloodline_bloodthirsty_name_random_e }
					20 = { set_name = bloodline_bloodthirsty_name_random_f }
				}
			}
		}
		hidden_tooltip = {
			any_player = {
				limit = {
					NOT = { character = ROOT }
					is_within_diplo_range = ROOT
				}
				narrative_event = { id = HF.23435 }
			}
		}
	}
}

#Inform players.
narrative_event = {
	id = HF.23435
	title = EVTTITLE23435
	desc = {
		trigger = {
			OR = {
				religion = FROM
				has_religion_feature = religion_ritual_sacrifice
			}
		}
		text = EVTDESCAHF23435
	}
	desc = {
		trigger = {
			NOR = {
				religion = FROM
				has_religion_feature = religion_ritual_sacrifice
			}
		}
		text = EVTDESCBHF23435
	}
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_narrative_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23435
		trigger = {
			OR = {
				religion = FROM
				has_religion_feature = religion_ritual_sacrifice
			}
		}
	}
	option = {
		name = EVTOPTBHF23435
		trigger = {
			NOR = {
				religion = FROM
				has_religion_feature = religion_ritual_sacrifice
			}
		}
	}
}

######################################################################################################
######################################################################################################
#Bloodthirsty Gods: The Blood Festival - Available from trait tier 1 and above

#First event, send invitations to all vassals.
character_event = {
	id = HF.23440
	desc = EVTDESCAHF23440
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23440
		set_character_flag = flag_preparing_blood_games #Used for on_death notifications.
		hidden_tooltip = {
			any_vassal = {
				limit = {
					NOT = { has_character_flag = do_not_disturb }
					NOT = { has_character_modifier = holding_large_feast }
					is_adult = yes
					NOT = { trait = incapable }
					NOT = { is_inaccessible_trigger = yes }
					religion = ROOT
					higher_tier_than = BARON
					NOT = { has_any_opinion_modifier = opinion_blood_games_guest } #Not already tangled in some other blood games from a previous liege.
				}
				letter_event = { id = HF.23441 }
			}
			character_event = { id = HF.23443 days = 5 } #Pick your champion.
		}
	}
}
#Vassal receives invitation.
letter_event = {
	id = HF.23441
	desc = EVTDESCAHF23441
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23441
		hidden_tooltip = {
			opinion = {
				modifier = opinion_blood_games_guest
				months = 4
				who = FROM
			}
			FROM = {
				character_event = { id = HF.23442 days = 2 random = 3 } #Notify
			}
			character_event = { id = HF.23443 days = 5 } #Pick your champion.
		}
		ai_chance = {
			factor = 90
			modifier = {
				factor = 1.5
				trait = zealous
			}
			modifier = {
				factor = 1.5
				trait = bloodthirsty_gods_1
			}
			modifier = {
				factor = 2
				trait = bloodthirsty_gods_2
			}
			modifier = {
				factor = 3
				trait = bloodthirsty_gods_3
			}
		}
	}
	option = {
		name = EVTOPTBHF23441
		ai_chance = {
			factor = 10
			modifier = {
				factor = 5
				trait = cynical
			}
			modifier = {
				factor = 3
				trait = craven
			}
		}
	}
}
#Notify liege of positive response.
character_event = {
	id = HF.23442
	desc = EVTDESCAHF23442
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	notification = yes

	has_character_flag = flag_preparing_blood_games #Cleared on conversion.

	option = {
		name = EVTOPTAHF23442
	}
}
#Pick a champion. -Rulers cannot fight themselves.
character_event = {
	id = HF.23443
	desc = EVTDESCAHF23443
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion
	hide_new = yes

	is_triggered_only = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	immediate = {
		if = { #Clear any potential champion that might still be lingering.
			limit = { persistent_event_target:my_blood_contender = { always = yes } }
			clear_persistent_event_target = my_blood_contender
		}
		random_courtier = { #Pick a prisoner.
			limit = {
				prisoner = yes
				is_adult = yes
				NOT = { trait = incapable }
				OR = { #Sex laws check
					AND = {
						is_female = no
						male_can_hold_minor_title_trigger = yes
					}
					AND = {
						is_female = yes
						female_can_hold_minor_title_trigger = yes
					}
				}
			}
			preferred_limit = { #Always try to pick the best possible candidate.
				combat_rating = 200
				is_ruler = no #Prefer landless prisoners first.
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 200
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 200
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 200 }
			preferred_limit = {
				combat_rating = 150
				is_ruler = no #Prefer landless prisoners first.
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 150
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 150
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 150 }
			preferred_limit = {
				combat_rating = 100
				is_ruler = no #Prefer landless prisoners first.
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 100
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 100
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 100 }
			preferred_limit = {
				combat_rating = 50
				is_ruler = no #Prefer landless prisoners first.
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 50
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 50
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 50 }
			preferred_limit = {
				combat_rating = 25
				is_ruler = no #Prefer landless prisoners first.
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 25
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 25
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 25 }
			preferred_limit = {
				combat_rating = 10
				is_ruler = no #Prefer landless prisoners first.
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 10
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 10
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 10 }
			preferred_limit = {
				combat_rating = 0
				is_ruler = no #Prefer landless prisoners first.
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 0
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 0
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 0 }
			preferred_limit = { trait = brave }
			preferred_limit = { NOT = { trait = craven } }
			save_event_target_as = blood_contender_prisoner
		}
		random_courtier = { #Pick a commander.
			limit = {
				is_ruler = no #Cannot risk your own vassals' life.
				is_adult = yes
				NOR = {
					trait = incapable
					has_character_modifier = elder_long_life_modifier
				}
				has_minor_title = title_commander
				NOT = { event_target:blood_contender_prisoner = { character = PREV } }
				OR = {
					AND = {
						is_female = no
						male_can_hold_minor_title_trigger = yes
					}
					AND = {
						is_female = yes
						female_can_hold_minor_title_trigger = yes
					}
				}
			}
			preferred_limit = {
				combat_rating = 200
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 200
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 200 }
			preferred_limit = {
				combat_rating = 150
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 150
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 150 }
			preferred_limit = {
				combat_rating = 100
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 100
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 100 }
			preferred_limit = {
				combat_rating = 50
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 50
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 50 }
			preferred_limit = {
				combat_rating = 25
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 25
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 25 }
			preferred_limit = {
				combat_rating = 10
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 10
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 10 }
			preferred_limit = {
				combat_rating = 0
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 0
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 0 }
			preferred_limit = { trait = brave }
			preferred_limit = { NOT = { trait = craven } }
			save_event_target_as = blood_contender_commander
		}
		random_courtier = { #Pick a random courtier.
			limit = {
				is_ruler = no #Cannot risk your own vassals' life.
				is_adult = yes
				prisoner = no
				religion = ROOT
				NOR = {
					trait = incapable
					has_character_modifier = elder_long_life_modifier
				}
				NOT = { has_minor_title = title_commander }
				NOT = { event_target:blood_contender_prisoner = { character = PREV } }
				NOT = { event_target:blood_contender_commander = { character = PREV } }
				is_unimportant_trigger = yes
				OR = {
					AND = {
						is_female = no
						male_can_hold_minor_title_trigger = yes
					}
					AND = {
						is_female = yes
						female_can_hold_minor_title_trigger = yes
					}
				}
			}
			preferred_limit = {
				combat_rating = 200
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 200
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 200 }
			preferred_limit = {
				combat_rating = 150
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 150
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 150 }
			preferred_limit = {
				combat_rating = 100
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 100
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 100 }
			preferred_limit = {
				combat_rating = 50
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 50
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 50 }
			preferred_limit = {
				combat_rating = 25
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 25
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 25 }
			preferred_limit = {
				combat_rating = 10
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 10
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 10 }
			preferred_limit = {
				combat_rating = 0
				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}
			preferred_limit = {
				combat_rating = 0
				NOR = {
					is_weak_trigger = yes
					is_dumb_trigger = yes
				}
			}
			preferred_limit = { combat_rating = 0 }
			preferred_limit = { trait = brave }
			preferred_limit = { NOT = { trait = craven } }
			save_event_target_as = blood_contender_courtier
		}
		if = {
			limit = {
				event_target:blood_contender_prisoner = { is_alive = no }
				event_target:blood_contender_commander = { is_alive = no }
				event_target:blood_contender_courtier = { is_alive = no } #In the event of no available other target...
			}
			spawn_good_commander_effect = yes #Saved as invited_character
		}
	}

	#A prisoner
	#A commander
	#A courtier
	#A spawned random guy

	option = { #Pick prisoner
		name = EVTOPTAHF23443
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23443 }
		show_portrait = event_target:blood_contender_prisoner
		trigger = { event_target:blood_contender_prisoner = { is_alive = yes } }
		if = {
			limit = {
				event_target:blood_contender_prisoner = {
				is_alive = no #Dies after event fires but before picking the option.
				}
			}
			character_event = { id = HF.23466 } #Replace.
			break = yes
		}
		hidden_tooltip = {
			event_target:blood_contender_prisoner = {
				if = {
					limit = { is_playable = yes }
					character_event = { id = HF.23444 } #If a ruler prisoner, notify of what is about to happen.
				}
				set_character_flag = flag_blood_contender #Check in case he dies before time and you wish to make a last minute replacement.
				set_character_flag = flag_prisoner_waiting_for_blood_games #Check in case he gets free before time.
				ROOT = { save_persistent_event_target = { name = my_blood_contender scope = PREV } }
			}
			character_event = { id = HF.23445 } #Pick equipment.
		}
		ai_chance = {
			factor = 40
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 10 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 20 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 30 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 40 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 50 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 60 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 70 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 80 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 90 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 100 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 120 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 140 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 160 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 180 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating = 200 }
			}
			modifier = {
				factor = 1.5
				event_target:blood_contender_prisoner = { combat_rating = 250 }
			}
		}
	}
	option = { #Pick commander
		name = EVTOPTBHF23443
		custom_tooltip = { text = TOOLTIP_EVTOPTBHF23443 }
		show_portrait = event_target:blood_contender_commander
		trigger = { event_target:blood_contender_commander = { is_alive = yes } }
		if = {
			limit = {
				event_target:blood_contender_commander = {
				is_alive = no #Dies after event fires but before picking the option.
				}
			}
			character_event = { id = HF.23466 } #Replace.
			break = yes
		}
		hidden_tooltip = {
			event_target:blood_contender_commander = {
				set_character_flag = flag_blood_contender #Check in case he dies before time and you wish to make a last minute replacement.
				ROOT = { save_persistent_event_target = { name = my_blood_contender scope = PREV } }
			}
			character_event = { id = HF.23445 } #Pick equipment.
		}
		ai_chance = {
			factor = 40
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 10 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 20 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 30 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 40 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 50 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 60 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 70 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 80 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 90 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 100 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 120 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 140 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 160 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 180 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating = 200 }
			}
			modifier = {
				factor = 1.5
				event_target:blood_contender_commander = { combat_rating = 250 }
			}
		}
	}
	option = { #Pick courtier
		name = EVTOPTCHF23443
		custom_tooltip = { text = TOOLTIP_EVTOPTCHF23443 }
		show_portrait = event_target:blood_contender_courtier
		trigger = { event_target:blood_contender_courtier = { is_alive = yes } }
		if = {
			limit = {
				event_target:blood_contender_courtier = {
				is_alive = no #Dies after event fires but before picking the option.
				}
			}
			character_event = { id = HF.23466 } #Replace.
			break = yes
		}
		hidden_tooltip = {
			event_target:blood_contender_courtier = {
				set_character_flag = flag_blood_contender #Check in case he dies before time and you wish to make a last minute replacement.
				ROOT = { save_persistent_event_target = { name = my_blood_contender scope = PREV } }
			}
			character_event = { id = HF.23445 } #Pick equipment.
		}
		ai_chance = {
			factor = 40
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 10 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 20 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 30 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 40 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 50 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 60 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 70 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 80 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 90 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 100 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 120 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 140 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 160 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 180 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating = 200 }
			}
			modifier = {
				factor = 1.5
				event_target:blood_contender_courtier = { combat_rating = 250 }
			}
		}
	}
	option = { #Pick spawned guy
		name = EVTOPTDHF23443
		custom_tooltip = { text = TOOLTIP_EVTOPTDHF23443 }
		show_portrait = event_target:invited_character
		trigger = { event_target:invited_character = { is_alive = yes } }
		if = {
			limit = {
				event_target:invited_character = {
				is_alive = no #Dies after event fires but before picking the option.
				}
			}
			character_event = { id = HF.23466 } #Replace.
			break = yes
		}
		hidden_tooltip = {
			event_target:invited_character = {
				set_character_flag = flag_blood_contender #Check in case he dies before time and you wish to make a last minute replacement.
				ROOT = { save_persistent_event_target = { name = my_blood_contender scope = PREV } }
			}
			character_event = { id = HF.23445 } #Pick equipment.
		}
		ai_chance = {
			factor = 60
		}
	}
}

#Imprisoned ruler notified that he has been picked.
character_event = {
	id = HF.23444
	desc = EVTDESCAHF23444
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion
	hide_new = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23444
		trigger = { trait = brave }
	}
	option = {
		name = EVTOPTBHF23444
		trigger = { NOT = { trait = brave } }
	}
}

#Pick equipment
character_event = {
	id = HF.23445
	desc = EVTDESCAHF23445
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion
	hide_new = yes
	portrait = persistent_event_target:my_blood_contender

	is_triggered_only = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	#Mystic potion
	#Deceitful poison
	#Costly armor
	#Regular equipment

	option = {
		name = EVTOPTAHF23445
		trigger = { trait = mystic }
		tooltip_info = mystic
		persistent_event_target:my_blood_contender = { add_character_modifier =  { name = fearless_potion months = 3 } }
		ai_chance = { factor = 60 }
	}
	option = {
		name = EVTOPTBHF23445
		trigger = { trait = deceitful }
		tooltip_info = deceitful
		persistent_event_target:my_blood_contender = { add_character_modifier =  { name = poisoned_weapons months = 3 } }
		ai_chance = { factor = 60 }
	}
	option = {
		name = EVTOPTCHF23445
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -0.5 min = -50 max = -150 }
		}
		persistent_event_target:my_blood_contender = { add_character_modifier =  { name = gladiatorial_equipment months = 3 } }
		ai_chance = { factor = 20 }
	}

	option = {
		name = EVTOPTEHF23445
		tooltip_info_custom = EVTOPTEHF23445_tt
		trigger = {
			any_realm_wonder = {
				has_wonder_upgrade = upgrade_animal_cages
			}
		}
		ai_chance = { factor = 10 }
	}

	option = { #Nothing
		name = EVTOPTDHF23445
		ai_chance = { factor = 30 }
	}
	after = {
		hidden_tooltip = {
			if = {
				limit = { has_character_modifier = bloodthirsty_games_cooldown } #The host.
				character_event = { id = HF.23452 days = 12 } #Start the tournament
			}
		}
	}
}

#Getting cleaunp events out of the way first...
#on_released_from_prison: If your champion is a prisoner and he is released before the tournament starts, you cannot use him.
#hidden ping from prisoner
character_event = {
	id = HF.23446
	hide_window = yes

	is_triggered_only = yes

	has_character_flag = flag_prisoner_waiting_for_blood_games

	immediate = {
		if = {
			limit = {
				FROM = {
					persistent_event_target:my_blood_contender = { character = ROOT }
					OR = {
						has_any_opinion_modifier = opinion_blood_games_guest #Is either guest or host of blood games, and blood games have not started yet.
						has_character_flag = flag_preparing_blood_games
					}
				}
			}
			clr_character_flag = flag_prisoner_waiting_for_blood_games
			clr_character_flag = flag_blood_contender
			remove_character_modifier = fearless_potion
			remove_character_modifier = poisoned_weapons
			remove_character_modifier = gladiatorial_equipment
			FROM = {
				clear_persistent_event_target = my_blood_contender
				character_event = { id = HF.23447 }
			}
		}
	}
}

#Ruler informed that he has no champion.
character_event = {
	id = HF.23447
	desc = EVTDESCAHF23447
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion
	hide_new = yes
	portrait = FROM

	is_triggered_only = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	immediate = {
		if = {
			limit = {
				multiplayer = no  #With the delay, the new contender might not make it in time before the tournament ends.
			}
			spawn_good_commander_effect = yes #Saved as invited_character
		}
	}
	option = {
		name = EVTOPTAHF23447
		trigger = {
			multiplayer = no
			event_target:invited_character = { is_alive = yes }
		}
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23447 }
		show_portrait = event_target:invited_character
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -0.5 min = -50 max = -150 }
		}
		hidden_tooltip = {
			event_target:invited_character = {
				set_character_flag = flag_blood_contender #Check in case he dies before time and you wish to make a last minute replacement.
				ROOT = { save_persistent_event_target = { name = my_blood_contender scope = PREV } }
			}
			character_event = { id = HF.23461 }
		}
		ai_chance = { factor = 10 }
	}
	option = {
		name = EVTOPTBHF23447
		hidden_tooltip = {
			event_target:invited_character = {
				death = { death_reason = death_missing }
			}
		}
		ai_chance = { factor = 90 }
	}
}

#on_death: If your champion dies before the tournament starts, you cannot use him.
#hidden ping from dying man
character_event = {
	id = HF.23448
	hide_window = yes

	is_triggered_only = yes

	has_character_flag = flag_blood_contender

	immediate = {
		if = {
			limit = {
				any_realm_character = {
					persistent_event_target:my_blood_contender = { character = ROOT }
					OR = {
						has_any_opinion_modifier = opinion_blood_games_guest #Is either guest or host of blood games, and blood games have not started yet.
						has_character_flag = flag_preparing_blood_games
					}
				}
			}
			random_realm_character = {
				limit = {
					persistent_event_target:my_blood_contender = { character = ROOT }
					OR = {
						has_any_opinion_modifier = opinion_blood_games_guest #Is either guest or host of blood games, and blood games have not started yet.
						has_character_flag = flag_preparing_blood_games
					}
				}
				clear_persistent_event_target = my_blood_contender
				character_event = { id = HF.23449 }
			}
		}
	}
}

#Ruler informed that he has no champion.
character_event = {
	id = HF.23449
	desc = EVTDESCAHF23449
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion
	hide_new = yes
	portrait = FROM

	is_triggered_only = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	immediate = {
		if = {
			limit = {
				multiplayer = no  #With the delay, the new contender might not make it in time before the tournament ends.
			}
			spawn_good_commander_effect = yes #Saved as invited_character
		}
	}
	option = {
		name = EVTOPTAHF23449
		trigger = {
			multiplayer = no
			event_target:invited_character = { is_alive = yes }
		}
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23449 }
		show_portrait = event_target:invited_character
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -0.5 min = -50 max = -150 }
		}
		hidden_tooltip = {
			event_target:invited_character = {
				set_character_flag = flag_blood_contender #Check in case he dies before time and you wish to make a last minute replacement.
				ROOT = { save_persistent_event_target = { name = my_blood_contender scope = PREV } }
			}
			character_event = { id = HF.23461 }
		}
		ai_chance = { factor = 10 }
	}
	option = {
		name = EVTOPTBHF23449
		ai_chance = { factor = 90 }
	}
}

#Ruler informed that he has no champion.
character_event = {
	id = HF.23466
	desc = EVTDESCAHF23466
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion
	hide_new = yes
	portrait = FROM

	is_triggered_only = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	immediate = {
		if = {
			limit = {
				multiplayer = no  #With the delay, the new contender might not make it in time before the tournament ends.
			}
			spawn_good_commander_effect = yes #Saved as invited_character
		}
	}
	option = {
		name = EVTOPTAHF23449
		trigger = {
			multiplayer = no
			event_target:invited_character = { is_alive = yes }
		}
		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23449 }
		show_portrait = event_target:invited_character
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -0.5 min = -50 max = -150 }
		}
		hidden_tooltip = {
			event_target:invited_character = {
				set_character_flag = flag_blood_contender #Check in case he dies before time and you wish to make a last minute replacement.
				ROOT = { save_persistent_event_target = { name = my_blood_contender scope = PREV } }
			}
			if = {
				limit = { event_target:invited_character = { is_alive = yes } }
				character_event = { id = HF.23461 }
			}
		}
		ai_chance = { factor = 10 }
	}
	option = {
		name = EVTOPTBHF23449
		ai_chance = { factor = 90 }
	}
	after = {
		hidden_tooltip = {
			if = {
				limit = { has_character_modifier = bloodthirsty_games_cooldown } #The host.
				character_event = { id = HF.23452 days = 12 } #Start the tournament
			}
		}
	}
}

#On_death: The Tournament's host dies before the tournament starts.
character_event = {
	id = HF.23450
	hide_window = yes

	has_character_flag = flag_preparing_blood_games

	is_triggered_only = yes

	immediate = {
		any_realm_character = {
			limit = {
				has_opinion_modifier = {
					modifier = opinion_blood_games_guest
					who = ROOT
				}
			}
			character_event = { id = HF.23451 }
		}
	}
}
#Other guests are notified that the tournament has been canceled.
character_event = {
	id = HF.23451
	desc = EVTDESCAHF23451
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion
	hide_new = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23451
		hidden_tooltip = {
			if = {
				limit = { persistent_event_target:my_blood_contender = { always = yes } }
				clear_persistent_event_target = my_blood_contender
			}
		}
	}
}
#The Tournament is about to start. (liege)
character_event = {
	id = HF.23452
	desc = EVTDESCAHF23452
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion
	hide_new = yes
	portrait = persistent_event_target:my_blood_contender

	has_character_flag = flag_preparing_blood_games #Removed in case of conversion.

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23452
		hidden_tooltip = {
			any_realm_character = {
				limit = {
					has_opinion_modifier = {
						modifier = opinion_blood_games_guest
						who = ROOT
					}
				}
				character_event = { id = HF.23453 }
			}
			character_event = { id = HF.23454 days = 4 } #Actual tournament
		}
	}
}

#Tournament is about to start. (guests)
character_event = {
	id = HF.23453
	desc = EVTDESCAHF23453
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion
	hide_new = yes
	portrait = persistent_event_target:my_blood_contender

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23453
	}
}

#Tournament starts (liege)
character_event = {
	id = HF.23454
	desc = EVTDESCAHF23454
	picture = GFX_evt_melee_arabic
	border = GFX_event_normal_frame_religion
	hide_new = yes
	portrait = persistent_event_target:my_blood_contender

	has_character_flag = flag_preparing_blood_games #Removed in case of conversion.

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23454
		hidden_tooltip = { #Determine the winner of the tournament.
			#First, pick the five best contenders in the realm.
			pick_potential_blood_games_winners_effect = yes
			#Now determine the winner amongst them, semi-randomly.
			pick_blood_games_winner_effect = yes
		}
	}
}

#Winner of the tournament.
character_event = {
	id = HF.23455
	title = EVTTITLEAHF23455
	desc = EVTDESCAHF23455
	picture = GFX_evt_melee_arabic
	border = GFX_event_normal_frame_religion
	hide_new = yes

	is_triggered_only = yes

	immediate = {
		#Sacrifice all the losers to the gods.
		FROM = {
			any_realm_character = {
				limit = {
					NOT = { character = ROOT }
					has_character_flag = flag_blood_contender
				}
				if = {
					limit = { multiplayer = no }
					character_event = { id = HF.23456 } #Send it as an event, as it might be an imprisoned ruler fighting for his life.
				}
				else = {
					clr_character_flag = flag_blood_contender
					death = {
						death_reason = death_execution_aztec_sacrifice
						killer = FROM #The host
					}
				}
			}
		}
		clr_character_flag = flag_prisoner_waiting_for_blood_games
		clr_character_flag = flag_blood_contender
		add_blood_splatter_effect = yes
		add_blood_splatter_effect = yes
		add_blood_splatter_effect = yes #Get highest tier.
		random_list = { #Chance of injury.
			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = one_legged }
				}
				add_trait = one_legged
			}
			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = one_handed }
				}
				add_trait = one_handed
			}
			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = disfigured }
				}
				add_trait = disfigured
			}
			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = one_eyed }
				}
				add_trait = one_eyed
			}
			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = mangled }
				}
				add_trait = mangled
			}
			1 = {
				trigger = { NOR = { has_dlc = "Reapers" trait = maimed } }
				add_trait = maimed
			}
			5 = {
				if = {
					limit = { has_dlc = "Holy Fury" }
					hidden_tooltip = { change_variable = { which = scarred_variable value = 4 } } #Bonus scars.
				}
				add_scarred_tiered_effect = yes #Gives regular Scarred trait otherwise.
			}
			5 = {
				add_trait = wounded
			}
			5 = {
				trigger = { has_dlc = "Holy Fury" }
			}

			80 = { #Nothing
			}
		}
		if = { #Give him a nickname.
			limit = {
				this_has_cool_nickname_trigger = no
				this_has_super_cool_nickname_trigger = no
			}
			random_list = {
				10 = {
					give_nickname = nick_the_skull_crusher
				}
				10 = {
					give_nickname = nick_the_quick_foot
				}
				10 = {
					give_nickname = nick_the_bleeder
				}
				10 = {
					give_nickname = nick_the_sharp_teeth
				}
				10 = {
					give_nickname = nick_the_crimson_flurry
				}
				10 = {
					give_nickname = nick_the_champion_of_province
				}
				10 = {
					give_nickname = nick_the_destroyer
				}
				10 = {
					give_nickname = nick_the_bone_gnasher
				}
				10 = {
					give_nickname = nick_the_survivor
				}
				10 = {
					give_nickname = nick_the_gods_champion
				}
				10 = {
					trigger = { is_female = no }
					give_nickname = nick_the_red_gladiator
				}
				10 = {
					trigger = { is_female = yes }
					give_nickname = nick_the_red_gladiatrix
				}
				10 = {
					trigger = { is_female = yes }
					give_nickname = nick_the_crimson_gorgon
				}
				10 = {
					trigger = { is_female = no }
					give_nickname = nick_the_scarlet_eagle
				}
				10 = {
					give_nickname = nick_the_exalted_chosen_of_province
				}
				10 = {
					give_nickname = nick_the_scarlet_painter
				}
			}
		}
		hidden_tooltip = { FROM = { character_event = { id = HF.23460 } } } #Notify liege.
	}

	option = {
		name = EVTOPTAHF23455
		prestige = 200
		if = { #Of same religion, the gods blessed you.
			limit = {
				religion = FROM
			}
			piety = 100
		}
		if = { #Earned your freedom.
			limit = {
				prisoner = yes
			}
			prisoner = no
		}
		add_character_modifier = {
			name = survived_blood_games
			duration = -1
			stacking = yes
		}
		hidden_tooltip = {
			remove_character_modifier = fearless_potion
			remove_character_modifier = poisoned_weapons
			remove_character_modifier = gladiatorial_equipment
		}
	}
}

#Tournament loser is sacrified to the gods.
character_event = {
	id = HF.23456
	title = EVTTITLEAHF23455
	desc = EVTDESCAHF23456
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion
	hide_new = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23456
		clr_character_flag = flag_blood_contender
		death = {
			death_reason = death_execution_aztec_sacrifice
			killer = FROMFROM #The host
		}
	}
}
#Tournament is over, FROM is the winner. (liege)
character_event = {
	id = HF.23460
	title = EVTTITLEAHF23460
	desc = {
		trigger = {
			persistent_event_target:my_blood_contender = {
				character = FROM
			}
		}
		text = EVTDESCAHF23460 #Your guy won.
	}
	desc = {
		trigger = {
			NOT = {
				persistent_event_target:my_blood_contender = {
					character = FROM
				}
			}
		}
		text = EVTDESCBHF23460 #Your guy lost.
	}
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion
	hide_new = yes

	is_triggered_only = yes

	immediate = {
		clr_character_flag = flag_preparing_blood_games
		hidden_tooltip = {
			any_realm_character = {
				limit = {
					has_opinion_modifier = {
						modifier = opinion_blood_games_guest
						who = ROOT
					}
				}
				character_event = { id = HF.23457 }
				remove_opinion = { who = ROOT modifier = opinion_blood_games_guest }
			}
		}
	}
	option = { #My guy won
		name = EVTOPTAHF23460
		trigger = {
			persistent_event_target:my_blood_contender = {
				character = FROM
			}
		}
		tiered_piety_reward_effect = yes
		hidden_tooltip  = {
			change_variable = { which = burned_hearts_points value = 10 }
			bloodthirsty_tiered_traits_effect = yes
			clear_persistent_event_target = my_blood_contender
		}
	}
	option = { #Another guy won
		name = EVTOPTBHF23460
		trigger = {
			NOT = {
				persistent_event_target:my_blood_contender = {
					character = FROM
				}
			}
		}
		hidden_tooltip  = {
			bloodthirsty_tiered_traits_effect = yes #You still get a point.
			clear_persistent_event_target = my_blood_contender
		}
	}
}

#Tournament is over, FROMFROM is the winner. (guests)
character_event = {
	id = HF.23457
	title = EVTTITLEAHF23457
	desc = {
		trigger = {
			persistent_event_target:my_blood_contender = {
				character = FROMFROM
			}
		}
		text = EVTDESCAHF23457 #Your guy won.
	}
	desc = {
		trigger = {
			NOT = {
				persistent_event_target:my_blood_contender = {
					character = FROMFROM
				}
			}
		}
		text = EVTDESCBHF23457 #Your guy lost.
	}
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion
	hide_new = yes
	show_from_from = yes

	is_triggered_only = yes

	option = { #My guy won
		name = EVTOPTAHF23457
		trigger = {
			persistent_event_target:my_blood_contender = {
				character = FROMFROM
			}
		}
		opinion = {
			modifier = opinion_held_blood_games
			who = FROM
			years = 5
		}
		tiered_piety_reward_effect = yes
		hidden_tooltip  = {
			change_variable = { which = burned_hearts_points value = 10 }
			bloodthirsty_tiered_traits_effect = yes
			clear_persistent_event_target = my_blood_contender
		}
	}
	option = { #Another guy won
		name = EVTOPTBHF23457
		trigger = {
			NOT = {
				persistent_event_target:my_blood_contender = {
					character = FROMFROM
				}
			}
		}
		opinion = {
			modifier = opinion_held_blood_games
			who = FROM
			years = 5
		}
		hidden_tooltip  = {
			bloodthirsty_tiered_traits_effect = yes #You still get a point.
			clear_persistent_event_target = my_blood_contender
		}
	}
}

#On_conversion cleanup. If the host converts to a religion without the bloodthirsty gods doctrine, the whole thing is off.
character_event = {
	id = HF.23458
	desc = EVTDESCAHF23458
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion
	hide_new = yes

	is_triggered_only = yes

	has_character_flag = flag_preparing_blood_games

	trigger = {
		NOT = {
			has_religion_feature = religion_ritual_sacrifice
		}
	}
	immediate = {
		clr_character_flag = flag_preparing_blood_games
		any_realm_character = {
			limit = {
				has_opinion_modifier = {
					modifier = opinion_blood_games_guest
					who = ROOT
				}
			}
			character_event = { id = HF.23459 }
			remove_opinion = { who = ROOT modifier = opinion_blood_games_guest }
		}
	}

	option = {
		name = EVTOPTAHF23458
		hidden_tooltip  = {
			clear_persistent_event_target = my_blood_contender
		}
	}
}
#Notify vassals.
character_event = {
	id = HF.23459
	desc = EVTDESCAHF23459
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion
	hide_new = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23459
		trigger  = {
			has_religion_feature = religion_ritual_sacrifice
		}
		hidden_tooltip  = {
			clear_persistent_event_target = my_blood_contender
		}
	}
	option = {
		name = EVTOPTBHF23459
		trigger  = {
			NOT = {
				has_religion_feature = religion_ritual_sacrifice
			}
		}
		hidden_tooltip  = {
			clear_persistent_event_target = my_blood_contender
		}
	}
}

#HF.23460 taken by double event

#Pick equipment - Version for spare warrior, same events, but doesn't fire the tournament again.
character_event = {
	id = HF.23461
	desc = EVTDESCAHF23445
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion
	hide_new = yes
	portrait = persistent_event_target:my_blood_contender

	is_triggered_only = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	#Mystic potion
	#Deceitful poison
	#Costly armor
	#Regular equipment

	option = {
		name = EVTOPTAHF23445
		trigger = { trait = mystic }
		tooltip_info = mystic
		persistent_event_target:my_blood_contender = { add_character_modifier =  { name = fearless_potion months = 3 } }
		ai_chance = { factor = 60 }
	}
	option = {
		name = EVTOPTBHF23445
		trigger = { trait = deceitful }
		tooltip_info = deceitful
		persistent_event_target:my_blood_contender = { add_character_modifier =  { name = poisoned_weapons months = 3 } }
		ai_chance = { factor = 60 }
	}
	option = {
		name = EVTOPTCHF23445
		if = {
			limit = { ai = no }
			scaled_wealth = { value = -0.5 min = -50 max = -150 }
		}
		persistent_event_target:my_blood_contender = { add_character_modifier =  { name = gladiatorial_equipment months = 3 } }
		ai_chance = { factor = 20 }
	}
	option = { #Nothing
		name = EVTOPTDHF23445
		ai_chance = { factor = 30 }
	}
}
######################################################################################################
######################################################################################################
#Bloodthirsty Gods: The Mass Sacrifice - Available from trait tier 2 and above

#Decide how many people are you going to sacrifice.
character_event = {
	id = HF.23462
	desc = EVTDESCAHF23462
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion
	hide_new = yes
	portrait = persistent_event_target:my_blood_contender

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23462
		add_character_modifier = { name = bloodthirsty_mass_sacrifice_bonus_3 years = 10 }
		religion_authority = {
			modifier = bloodthirsty_mass_sacrifice
			years = 100
		}
		if = {
			limit = { is_nomadic = yes }
			population = -2000
		}
		if = {
			limit = { is_nomadic = no }
			custom_tooltip = { text = TOOLTIP_EVTOPTAHF23462 }
		}
		hidden_tooltip = {
			any_demesne_province = {
				show_scope_change = no
				if = {
					limit = { ROOT = { is_nomadic = no } }
					add_province_modifier = { name = bloodthirsty_mass_sacrifice_province_2 years = 10 stacking = yes }
				}
				change_variable = { which = prosperity_value value = -40 }
				if = {
					limit = { NOT = { check_variable = { which = prosperity_value value = 0 } } }
					set_variable = { which = prosperity_value value = 0 }
				}
			}
		}
		hidden_tooltip = {
			any_vassal = {
				limit = {
					higher_tier_than = BARON
					religion = ROOT
				}
				character_event = { id = HF.23463 }
			}
			any_vassal = {
				limit = {
					higher_tier_than = BARON
					NOR = {
						religion = ROOT
						has_religion_feature = religion_ritual_sacrifice
					}
				}
				character_event = { id = HF.23464 }
			}
			any_independent_ruler = {
				limit = {
					war_with = ROOT
				}
				character_event = { id = HF.23465 }
			}
		}
		hidden_tooltip = {
			if = {
				limit = { this_has_super_cool_nickname_trigger = no }
				random_list = {
					20 = {
						give_nickname = nick_the_red_storm
					}
					20 = {
						give_nickname = nick_the_scarlet_hands
					}
					20 = {
						give_nickname = nick_the_blood_monger
					}
					20 = {
						give_nickname = nick_the_black_skull
					}
					20 = {
						give_nickname = nick_the_heart_eater
					}
					20 = {
						give_nickname = nick_the_slaughterer
					}
					20 = {
						give_nickname = nick_the_soul_flayer
					}
					20 = {
						give_nickname = nick_the_spirit_stalker
					}
					10 = {
						give_nickname = nick_the_crimson_reaper
					}
					10 = {
						give_nickname = nick_the_dreaded
					}
					5 = {
						give_nickname = nick_the_chest_buster
					}
					70 = { #Nothing
					}
				}
			}
			change_variable = { which = burned_hearts_points value = 15 }
			bloodthirsty_tiered_traits_effect = yes
		}
		#Opinion bonus towards vassals of same religion (through event).
		ai_chance = { factor = 10 }
	}
	option = {
		name = EVTOPTBHF23462
		add_character_modifier = { name = bloodthirsty_mass_sacrifice_bonus_2 years = 10 }
		if = {
			limit = { is_nomadic = yes }
			population = -1000
		}
		if = {
			limit = { is_nomadic = no }
			custom_tooltip = { text = TOOLTIP_EVTOPTBHF23462 }
		}
		hidden_tooltip = {
			any_demesne_province = {
				show_scope_change = no
				if = {
					limit = { ROOT = { is_nomadic = no } }
					add_province_modifier = { name = bloodthirsty_mass_sacrifice_province_1 years = 10 stacking = yes }
				}
				change_variable = { which = prosperity_value value = -20 }
				if = {
					limit = { NOT = { check_variable = { which = prosperity_value value = 0 } } }
					set_variable = { which = prosperity_value value = 0 }
				}
			}
		}
		hidden_tooltip = {
			any_vassal = {
				limit = {
					higher_tier_than = BARON
					religion = ROOT
				}
				character_event = { id = HF.23463 }
			}
			any_vassal = {
				limit = {
					higher_tier_than = BARON
					NOR = {
						religion = ROOT
						has_religion_feature = religion_ritual_sacrifice
					}
				}
				character_event = { id = HF.23464 }
			}
			any_independent_ruler = {
				limit = {
					war_with = ROOT
				}
				character_event = { id = HF.23465 }
			}
			change_variable = { which = burned_hearts_points value = 10 }
			bloodthirsty_tiered_traits_effect = yes
		}
		ai_chance = { factor = 20 }
	}
	option = {
		name = EVTOPTCHF23462
		add_blood_splatter_effect = yes
		add_character_modifier = { name = bloodthirsty_mass_sacrifice_bonus_1 years = 5 }
		if = {
			limit = { is_nomadic = yes }
			population = -500
		}
		if = {
			limit = { is_nomadic = no }
			capital_scope = {
				show_scope_change = no
				add_province_modifier = { name = bloodthirsty_mass_sacrifice_province_1 years = 10 stacking = yes }
				hidden_tooltip = {
					change_variable = { which = prosperity_value value = -10 }
					if = {
						limit = { NOT = { check_variable = { which = prosperity_value value = 0 } } }
						set_variable = { which = prosperity_value value = 0 }
					}
				}
			}
		}
		hidden_tooltip = {
			capital_scope = {
				change_variable = { which = prosperity_value value = -10 }
				if = {
					limit = { NOT = { check_variable = { which = prosperity_value value = 0 } } }
					set_variable = { which = prosperity_value value = 0 }
				}
			}
			any_vassal = {
				limit = {
					higher_tier_than = BARON
					religion = ROOT
				}
				character_event = { id = HF.23463 }
			}
			any_vassal = {
				limit = {
					higher_tier_than = BARON
					NOR = {
						religion = ROOT
						NOT = { has_religion_feature = religion_peaceful }
						has_religion_feature = religion_ritual_sacrifice
					}
				}
				character_event = { id = HF.23464 }
			}
			any_independent_ruler = {
				limit = {
					war_with = ROOT
				}
				character_event = { id = HF.23465 }
			}
			change_variable = { which = burned_hearts_points value = 5 }
			bloodthirsty_tiered_traits_effect = yes
		}
		ai_chance = { factor = 30 }
	}
	option = { #Nothing
		name = EVTOPTDHF23462
		hidden_tooltip = { remove_character_modifier = bloodthirsty_mass_sacrifice_cooldown }
		ai_chance = { factor = 0 }
	}
}

#Bloodthirsty vassals notified.
character_event = {
	id = HF.23463
	desc = EVTDESCAHF23463
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23463
		opinion = {
			who = ROOT
			modifier = opinion_mass_sacrifice_positive
			years = 5
		}
	}
}
#Non-bloodthirsty vassals notified.
character_event = {
	id = HF.23464
	desc = EVTDESCAHF23464
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23464
		opinion = {
			who = ROOT
			modifier = opinion_mass_sacrifice_negative
			years = 5
		}
	}
}
#War enemy notified.
character_event = {
	id = HF.23465
	desc = EVTDESCAHF23465
	picture =  GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23465
		trigger = {
			has_religion_feature = religion_ritual_sacrifice
		}
		if = {
			limit = { NOT = { trait = stressed } }
			random = {
				chance = 20
				add_trait = stressed
			}
		}
		add_character_modifier = {
			name = enemy_made_mass_sacrifice
			years = 2
		}
	}
	option = {
		name = EVTOPTBHF23465
		trigger = {
			NOT = {
				has_religion_feature = religion_ritual_sacrifice
			}
		}
	}
}

#HF.23466 taken.

###############################################################

############################################################


#On_title_new_holder: check succession/women's status when creating new vassals.
#ROOT is the character, FROM is the title, FROMFROM is the old holder
character_event = {
	id = HF.23700
	hide_window = yes

	trigger = {
		#NOT = { ROOT = { is_merchant_republic = yes } }
		NOT = { ROOT = { character = FROMFROM } }
		OR = {
			AND = {
				ROOT = { has_religion_feature = religion_patriarchal }
				FROMFROM = { has_religion_feature = religion_patriarchal }
			}
			AND = {
				ROOT = {
					has_religion_feature = religion_equal
				}
				FROMFROM = {
					has_religion_feature = religion_equal
				}
			}
			AND = {
				ROOT = { has_religion_feature = religion_matriarchal }
				FROMFROM = { has_religion_feature = religion_matriarchal }
			}
		}
	}
	is_triggered_only = yes

	immediate = {
		ROOT = { character_event = { id  = HF.23701 days  = 1 } }
	}
}

character_event = {
	id = HF.23701
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				ROOT = {
					has_religion_feature = religion_matriarchal
					NOR = {
						#is_merchant_republic = yes
						is_republic = yes
					}
				}
			}
			FROMFROM = {
				add_law = {
					law = status_of_women_4
					cooldown = no
					opinion_effect = no
				}
				add_law = {
					law = enatic_succession
					cooldown = no
					opinion_effect = no
				}
				if = {
					limit = {
						OR = {
							is_feudal = yes
							is_tribal = yes
							is_nomadic = yes
						}
					}
					add_law = {
						law = succ_turkish_succession
						cooldown = no
						opinion_effect = no
					}
				}
			}
		}
		if = {
			limit = {
				ROOT = { has_religion_feature = religion_patriarchal }
			}
			FROMFROM = {
				add_law = {
					law = status_of_women_0
					cooldown = no
					opinion_effect = no
				}
				add_law = {
					law = agnatic_succession
					cooldown = no
					opinion_effect = no
				}
				if = {
					limit = {
						OR = {
							is_feudal = yes
							is_tribal = yes
							is_nomadic = yes
						}
					}
					add_law = {
						law = succ_turkish_succession
						cooldown = no
						opinion_effect = no
					}
				}
			}
		}
		if = {
			limit = {
				ROOT = {
					has_religion_feature = religion_equal
					NOR = {
						#is_merchant_republic = yes
						is_republic = yes
					}
				}
			}
			FROMFROM = {
				add_law = {
					law = status_of_women_4
					cooldown = no
					opinion_effect = no
				}
				add_law = {
					law = true_cognatic_succession
					cooldown = no
					opinion_effect = no
				}
			}
		}
	}
}


###############################################################

###############################################################

#Doctrine Flavor: Stability
#on_birth: Primary Heir is born, decide what to do with him.
#Check if ruler's son and new heir, send delayed event.
character_event = {
	id = HF.23750
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		liege = {
			is_parent_of = ROOT
			is_playable = yes
			higher_tier_than = BARON
			has_religion_feature = religion_stable
			religion = ROOT
		}
	}

	immediate = {
		liege = { character_event = { id = HF.23751 days = 100 random = 70 } }
	}
}

#Parent-liege receives event and decides what to do.
character_event = {
	id = HF.23751
	desc = {
		trigger = {
			FROM = { is_ill = yes }
		}
		text = EVTDESCAHF23751
	}
	desc = {
		trigger = {
			FROM = { is_ill = no }
		}
		text = EVTDESCBHF23751
	}
	picture = GFX_evt_birth
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		FROM = { is_alive = yes }
		player_heir = { character = FROM }
	}
	option = {
		name = EVTOPTAHF23751
		trigger = { has_religion_feature = religion_astrology } #Synergy
		custom_tooltip = { text = TT_EVTOPTAHF23751 }
		hidden_tooltip = {
			random_list = {
				15 = {
					modifier = {
						factor = 1.5
						piety = 150
					}
					modifier = {
						factor = 1.5
						piety = 250
					}
					modifier = {
						factor = 1.5
						piety = 350
					}
					modifier = {
						factor = 1.5
						piety = 450
					}
					modifier = {
						factor = 1.5
						piety = 550
					}
					modifier = {
						factor = 1.5
						piety = 650
					}
					modifier = {
						factor = 1.5
						piety = 750
					}
					modifier = {
						factor = 1.5
						piety = 850
					}
					modifier = {
						factor = 1.5
						piety = 950
					}
					modifier = {
						factor = 1.75
						piety = 1250
					}
					modifier = {
						factor = 2
						piety = 2000
					}
					modifier = {
						factor = 4
						piety = 2000
					}
					modifier = {
						factor = 1.5
						learning = 8
					}
					modifier = {
						factor = 1.5
						learning = 10
					}
					modifier = {
						factor = 1.5
						learning = 12
					}
					modifier = {
						factor = 1.5
						learning = 14
					}
					modifier = {
						factor = 1.5
						learning = 16
					}
					modifier = {
						factor = 1.5
						learning = 18
					}
					modifier = {
						factor = 1.5
						learning = 20
					}
					modifier = {
						factor = 1.5
						any_courtier_or_vassal = { has_job_title = job_spiritual learning = 8 }
					}
					modifier = {
						factor = 1.5
						any_courtier_or_vassal = { has_job_title = job_spiritual learning = 10 }
					}
					modifier = {
						factor = 1.5
						any_courtier_or_vassal = { has_job_title = job_spiritual learning = 12 }
					}
					modifier = {
						factor = 1.5
						any_courtier_or_vassal = { has_job_title = job_spiritual learning = 14 }
					}
					modifier = {
						factor = 1.5
						any_courtier_or_vassal = { has_job_title = job_spiritual learning = 16 }
					}
					modifier = {
						factor = 1.5
						any_courtier_or_vassal = { has_job_title = job_spiritual learning = 18 }
					}
					modifier = {
						factor = 1.5
						any_courtier_or_vassal = { has_job_title = job_spiritual learning = 20 }
					}
					character_event = { id = HF.23752 } #Excellent Response.
				}
				60 = {
					character_event = { id = HF.23753 }  #Good Response.
				}
				20 = {
					character_event = { id = HF.23754 }  #Bad Response.
				}
				5 = {
					modifier = {
						factor = 2
						NOT = { piety = -50 }
					}
					modifier = {
						factor = 2
						NOT = { piety = -100 }
					}
					modifier = {
						factor = 2
						NOT = { piety = -200 }
					}
					modifier = {
						factor = 2
						NOT = { piety = -400 }
					}
					modifier = {
						factor = 2
						NOT = { piety = -600 }
					}
					modifier = {
						factor = 2
						has_character_modifier = adulteress
					}
					modifier = {
						factor = 2
						has_character_modifier = incestuous_adulteress
					}
					modifier = {
						factor = 2
						has_character_modifier = adulterer
					}
					modifier = {
						factor = 2
						has_character_modifier = incestuous_adulterer
					}
					modifier = {
						factor = 2
						spouse = { has_character_modifier = adulterer }
					}
					modifier = {
						factor = 2
						spouse = { has_character_modifier = incestuous_adulterer }
					}
					modifier = {
						factor = 2
						spouse = { has_character_modifier = adulteress }
					}
					modifier = {
						factor = 2
						spouse = { has_character_modifier = incestuous_adulteress }
					}
					modifier = {
						factor = 2
						FROM = { trait = bastard }
					}
					modifier = {
						factor = 2
						FROM = { trait = legit_bastard }
					}
					modifier = {
						factor = 2
						FROM = { trait = child_of_consort }
					}
					modifier = {
						factor = 2
						FROM = { trait = child_of_consort_male }
					}
					character_event = { id = HF.23755 } #Catastrophic Response.
				}
			}
		}
	}
	option = {
		name = EVTOPTBHF23751
		FROM = {
			show_scope_change = no
			add_character_modifier = {
				name = child_protected
				years = 16
			}
		}
		if = {
			limit = { real_tier = COUNT }
			scaled_wealth = { value = -1 min = -50 max = -200 }
		}
		if = {
			limit = { real_tier = DUKE }
			scaled_wealth = { value = -1 min = -100 max = -400 }
		}
		if = {
			limit = { real_tier = KING }
			scaled_wealth = { value = -1 min = -175 max = -500 }
		}
		if = {
			limit = { real_tier = EMPEROR }
			scaled_wealth = { value = -1 min = -300 max = -600 }
		}
	}
	option = {
		name = EVTOPTCHF23751
		FROM = {
			show_scope_change = no
			add_character_modifier = {
				name = child_heavily_guarded
				years = 16
			}
		}
		if = {
			limit = { real_tier = COUNT }
			scaled_wealth = { value = -1 min = -50 max = -100 }
		}
		if = {
			limit = { real_tier = DUKE }
			scaled_wealth = { value = -1 min = -100 max = -300 }
		}
		if = {
			limit = { real_tier = KING }
			scaled_wealth = { value = -1 min = -175 max = -400 }
		}
		if = {
			limit = { real_tier = EMPEROR }
			scaled_wealth = { value = -1 min = -300 max = -500 }
		}
	}
	option = {
		name = EVTOPTDHF23751
		tiered_piety_negative_effect = yes
	}
}

#Astronomy+Stability outcomes.
#Very Positive.
character_event = {
	id = HF.23752
	desc = {
		trigger = {
			FROMFROM = { is_ill = yes }
		}
		text = EVTDESCAHF23752
	}
	desc = {
		trigger = {
			FROMFROM = { is_ill = no }
		}
		text = EVTDESCBHF23752
	}
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion
	show_from_from = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23752
		FROMFROM = { health = 1.0 }
		random_list = {
			25 = { FROMFROM = { change_diplomacy = 2 } }
			25 = { FROMFROM = { change_martial = 2 } }
			25 = { FROMFROM = { change_stewardship = 2 } }
			25 = { FROMFROM = { change_intrigue = 2 } }
			25 = { FROMFROM = { change_learning = 2 } }
		}
		any_vassal = {
			limit = { higher_tier_than = BARON }
			opinion = { who = FROMFROM modifier = opinion_favored_child years = 20 }
		}
	}
}

#Positive.
character_event = {
	id = HF.23753
	desc = {
		trigger = {
			FROMFROM = { is_ill = yes }
		}
		text = EVTDESCAHF23753
	}
	desc = {
		trigger = {
			FROMFROM = { is_ill = no }
		}
		text = EVTDESCBHF23753
	}
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion
	show_from_from = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23753
		FROMFROM = { health = 2.0 }
	}
}

#Negative.
character_event = {
	id = HF.23754
	desc = {
		trigger = {
			FROMFROM = { is_ill = yes }
		}
		text = EVTDESCAHF23754
	}
	desc = {
		trigger = {
			FROMFROM = { is_ill = no }
		}
		text = EVTDESCBHF23754
	}
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion
	show_from_from = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23754
		FROMFROM = { health = -1.0 }
	}
}

#Very Negative.
character_event = {
	id = HF.23755
	desc = {
		trigger = {
			FROMFROM = { is_ill = yes }
		}
		text = EVTDESCAHF23755
	}
	desc = {
		trigger = {
			FROMFROM = { is_ill = no }
		}
		text = EVTDESCBHF23755
	}
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion
	show_from_from = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23755
		FROMFROM = { health = -0.5 }
		any_vassal = {
			limit = { higher_tier_than = BARON }
			opinion = { who = FROMFROM modifier = opinion_unfavored_child years = 20 }
		}
	}
}

####################################

#Stability. Attribute Improvement decision. (Meliorism)
#First event, pick attribute.
character_event = {
	id = HF.23760
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = ROOT } #Doing self-improvement.
		}
		text = EVTDESCAHF23760
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = ROOT } } #Helping someone else.
			is_close_relative = event_target:scoped_improvement_target
		}
		text = EVTDESCBHF23760
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = ROOT } } #Helping someone else.
			NOT = { is_close_relative = event_target:scoped_improvement_target }
		}
		text = EVTDESCCHF23760
	}
	picture = {
		trigger = {
			OR = {
				has_religion_feature = religion_matriarchal
				AND = {
					event_target:scoped_improvement_target = { character = ROOT is_female = yes }
					primary_title = { has_law = status_of_women_4 }
				}
			}
		}
		picture = GFX_evt_matriarchy_throne_room
	}
	picture = {
		trigger = {
			has_religion_feature = religion_patriarchal
		}
		picture = GFX_evt_tengri_throneroom_oldgods
	}
	picture = {
		trigger = {
			has_dlc = "Reapers"
			NOR = {
				has_religion_feature = religion_patriarchal
				has_religion_feature = religion_matriarchal
			}
		}
		picture = GFX_evt_prospering_province
	}
	picture = {
		trigger = {
			NOR = {
				has_dlc = "Reapers"
				has_religion_feature = religion_patriarchal
				has_religion_feature = religion_matriarchal
			}
		}
		picture = GFX_evt_magnificent_castle
	}
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	immediate = {
		ROOT = { save_event_target_as = scoped_improvement_ruler }
		FROM = {
			save_event_target_as = scoped_improvement_target
			clr_character_flag = flag_training_diplomacy_attribute
			clr_character_flag = flag_training_martial_attribute
			clr_character_flag = flag_training_combat_rating
			clr_character_flag = flag_training_stewardship_attribute
			clr_character_flag = flag_training_intrigue_attribute
			clr_character_flag = flag_training_learning_attribute
		}
	}

	#Statemanship (Diplomacy/Stewardship)
	#War (Martial/Combat Rating)
	#Knowledge (Intrigue/Learning)
	#Cancel.

	option = {
		name = EVTOPTAHF23760
		trigger = {
			OR = {
				event_target:scoped_improvement_target = { character = ROOT }
				attribute_diff = { attribute = diplomacy character = event_target:scoped_improvement_target value = 1 }
				attribute_diff = { attribute = stewardship character = event_target:scoped_improvement_target value = 1 }
			}
		}
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = ROOT } }
				attribute_diff = { attribute = diplomacy character = event_target:scoped_improvement_target value = 1 }
				NOT = { attribute_diff = { attribute = stewardship character = event_target:scoped_improvement_target value = 1 } }
			}
			event_target:scoped_improvement_target = { change_diplomacy = 1 set_character_flag = flag_training_diplomacy_attribute }
			if = {
				limit = {
					event_target:scoped_improvement_target = { has_education_diplomacy_trigger = yes }
					event_target:scoped_improvement_ruler = {
						OR = {
							has_religion_feature = religion_meritocratic
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_patriarchal
						}
					}
				}
				custom_tooltip = {
					text = tooltip_synergic_education_ugrade
				}
			}
		}
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = ROOT } }
				attribute_diff = { attribute = stewardship character = event_target:scoped_improvement_target value = 1 }
				NOT = { attribute_diff = { attribute = diplomacy character = event_target:scoped_improvement_target value = 1 } }
			}
			event_target:scoped_improvement_target = { change_stewardship = 1 set_character_flag = flag_training_stewardship_attribute }
			if = {
				limit = {
					event_target:scoped_improvement_target = { has_education_stewardship_trigger = yes }
					event_target:scoped_improvement_ruler = {
						OR = {
							has_religion_feature = religion_meritocratic
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_patriarchal
						}
					}
				}
				custom_tooltip = {
					text = tooltip_synergic_education_ugrade
				}
			}
		}
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = ROOT } }
				attribute_diff = { attribute = stewardship character = event_target:scoped_improvement_target value = 1 }
				attribute_diff = { attribute = diplomacy character = event_target:scoped_improvement_target value = 1 }
			}
			event_target:scoped_improvement_target = {
				random_list = {
					50 = {
						change_diplomacy = 1
						set_character_flag = flag_training_diplomacy_attribute
						if = {
							limit = {
								event_target:scoped_improvement_target = { has_education_diplomacy_trigger = yes }
								event_target:scoped_improvement_ruler = {
									OR = {
										has_religion_feature = religion_meritocratic
										has_religion_feature = religion_matriarchal
										has_religion_feature = religion_patriarchal
									}
								}
							}
							custom_tooltip = {
								text = tooltip_synergic_education_ugrade
							}
						}
					}
					50 = {
						change_stewardship = 1
						set_character_flag = flag_training_stewardship_attribute
						if = {
							limit = {
								event_target:scoped_improvement_target = { has_education_stewardship_trigger = yes }
								event_target:scoped_improvement_ruler = {
									OR = {
										has_religion_feature = religion_meritocratic
										has_religion_feature = religion_matriarchal
										has_religion_feature = religion_patriarchal
									}
								}
							}
							custom_tooltip = {
								text = tooltip_synergic_education_ugrade
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				event_target:scoped_improvement_target = { character = ROOT }
			}
			random_list = {
				50 = {
					change_diplomacy = 1
					set_character_flag = flag_training_diplomacy_attribute
					if = {
						limit = {
							event_target:scoped_improvement_target = { has_education_diplomacy_trigger = yes }
							event_target:scoped_improvement_ruler = {
								OR = {
									has_religion_feature = religion_meritocratic
									has_religion_feature = religion_matriarchal
									has_religion_feature = religion_patriarchal
								}
							}
						}
						custom_tooltip = {
							text = tooltip_synergic_education_ugrade
						}
					}
				}
				50 = {
					change_stewardship = 1
					set_character_flag = flag_training_stewardship_attribute
					if = {
						limit = {
							event_target:scoped_improvement_target = { has_education_stewardship_trigger = yes }
							event_target:scoped_improvement_ruler = {
								OR = {
									has_religion_feature = religion_meritocratic
									has_religion_feature = religion_matriarchal
									has_religion_feature = religion_patriarchal
								}
							}
						}
						custom_tooltip = {
							text = tooltip_synergic_education_ugrade
						}
					}
				}
			}
		}
		hidden_tooltip = {
			event_target:scoped_improvement_target = {
				change_variable = { which = burnout_count value = 1 }
				stable_attribute_improvement_effect = yes
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				has_education_diplomacy_trigger = yes
			}
			modifier = {
				factor = 1.5
				has_education_stewardship_trigger = yes
			}
		}
	}
	option = {
		name = EVTOPTBHF23760
		trigger = {
			OR = {
				event_target:scoped_improvement_target = { character = ROOT }
				attribute_diff = { attribute = martial character = event_target:scoped_improvement_target value = 1 }
				combat_rating_diff = { who = ROOT value = 1 }
			}
		}
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = ROOT } }
				attribute_diff = { attribute = martial character = event_target:scoped_improvement_target value = 1 }
				NOT = { combat_rating_diff = { who = event_target:scoped_improvement_target value = 1 } }
			}
			event_target:scoped_improvement_target = { change_martial = 1 set_character_flag = flag_training_martial_attribute }
		}
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = ROOT } }
				combat_rating_diff = { who = event_target:scoped_improvement_target value = 1 }
				NOT = { attribute_diff = { attribute = martial character = event_target:scoped_improvement_target value = 1 } }
			}
			event_target:scoped_improvement_target = { add_one_duel_experience_modifier = yes set_character_flag = flag_training_combat_rating }
		}
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = ROOT } }
				combat_rating_diff = { who = event_target:scoped_improvement_target value = 1 }
				attribute_diff = { attribute = martial character = event_target:scoped_improvement_target value = 1 }
			}
			event_target:scoped_improvement_target = {
				random_list = {
					50 = {
						change_martial = 1
						set_character_flag = flag_training_martial_attribute
					}
					50 = {
						add_one_duel_experience_modifier = yes
						set_character_flag = flag_training_combat_rating
					}
				}
			}
		}
		if = {
			limit = {
				event_target:scoped_improvement_target = { character = ROOT }
			}
			random_list = {
				50 = {
					change_martial = 1
					set_character_flag = flag_training_martial_attribute
				}
				50 = {
					add_one_duel_experience_modifier = yes
					set_character_flag = flag_training_combat_rating
				}
			}
		}
		if = {
			limit = {
				event_target:scoped_improvement_target = { has_education_martial_trigger = yes }
				event_target:scoped_improvement_ruler = {
					OR = {
						has_religion_feature = religion_meritocratic
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_patriarchal
					}
				}
			}
			custom_tooltip = {
				text = tooltip_synergic_education_ugrade
			}
		}
		hidden_tooltip = {
			event_target:scoped_improvement_target = {
				change_variable = { which = burnout_count value = 1 }
				stable_attribute_improvement_effect = yes
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				has_education_martial_trigger = yes
			}
		}
	}
	option = {
		name = EVTOPTCHF23760
		trigger = {
			OR = {
				event_target:scoped_improvement_target = { character = ROOT }
				attribute_diff = { attribute = intrigue character = event_target:scoped_improvement_target value = 1 }
				attribute_diff = { attribute = learning character = event_target:scoped_improvement_target value = 1 }
			}
		}
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = ROOT } }
				attribute_diff = { attribute = intrigue character = event_target:scoped_improvement_target value = 1 }
				NOT = { attribute_diff = { attribute = learning character = event_target:scoped_improvement_target value = 1 } }
			}
			event_target:scoped_improvement_target = { change_intrigue = 1 set_character_flag = flag_training_intrigue_attribute }
			if = {
				limit = {
					event_target:scoped_improvement_target = { has_education_intrigue_trigger = yes }
					event_target:scoped_improvement_ruler = {
						OR = {
							has_religion_feature = religion_meritocratic
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_patriarchal
						}
					}
				}
				custom_tooltip = {
					text = tooltip_synergic_education_ugrade
				}
			}
		}
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = ROOT } }
				attribute_diff = { attribute = learning character = event_target:scoped_improvement_target value = 1 }
				NOT = { attribute_diff = { attribute = intrigue character = event_target:scoped_improvement_target value = 1 } }
			}
			event_target:scoped_improvement_target = { change_learning = 1 set_character_flag = flag_training_learning_attribute }
			if = {
				limit = {
					event_target:scoped_improvement_target = { has_education_learning_trigger = yes }
					event_target:scoped_improvement_ruler = {
						OR = {
							has_religion_feature = religion_meritocratic
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_patriarchal
						}
					}
				}
				custom_tooltip = {
					text = tooltip_synergic_education_ugrade
				}
			}
		}
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = ROOT } }
				attribute_diff = { attribute = learning character = event_target:scoped_improvement_target value = 1 }
				attribute_diff = { attribute = intrigue character = event_target:scoped_improvement_target value = 1 }
			}
			event_target:scoped_improvement_target = {
				random_list = {
					50 = {
						change_intrigue = 1
						set_character_flag = flag_training_intrigue_attribute
						if = {
							limit = {
								event_target:scoped_improvement_target = { has_education_intrigue_trigger = yes }
								event_target:scoped_improvement_ruler = {
									OR = {
										has_religion_feature = religion_meritocratic
										has_religion_feature = religion_matriarchal
										has_religion_feature = religion_patriarchal
									}
								}
							}
							custom_tooltip = {
								text = tooltip_synergic_education_ugrade
							}
						}
					}
					50 = {
						change_learning = 1
						set_character_flag = flag_training_learning_attribute
						if = {
							limit = {
								event_target:scoped_improvement_target = { has_education_learning_trigger = yes }
								event_target:scoped_improvement_ruler = {
									OR = {
										has_religion_feature = religion_meritocratic
										has_religion_feature = religion_matriarchal
										has_religion_feature = religion_patriarchal
									}
								}
							}
							custom_tooltip = {
								text = tooltip_synergic_education_ugrade
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				event_target:scoped_improvement_target = { character = ROOT }
			}
			random_list = {
				50 = {
					change_intrigue = 1
					set_character_flag = flag_training_intrigue_attribute
					if = {
						limit = {
							event_target:scoped_improvement_target = { has_education_intrigue_trigger = yes }
							event_target:scoped_improvement_ruler = {
								OR = {
									has_religion_feature = religion_meritocratic
									has_religion_feature = religion_matriarchal
									has_religion_feature = religion_patriarchal
								}
							}
						}
						custom_tooltip = {
							text = tooltip_synergic_education_ugrade
						}
					}
				}
				50 = {
					change_learning = 1
					set_character_flag = flag_training_learning_attribute
					if = {
						limit = {
							event_target:scoped_improvement_target = { has_education_learning_trigger = yes }
							event_target:scoped_improvement_ruler = {
								OR = {
									has_religion_feature = religion_meritocratic
									has_religion_feature = religion_matriarchal
									has_religion_feature = religion_patriarchal
								}
							}
						}
						custom_tooltip = {
							text = tooltip_synergic_education_ugrade
						}
					}
				}
			}
		}
		hidden_tooltip = {
			event_target:scoped_improvement_target = {
				change_variable = { which = burnout_count value = 1 }
				stable_attribute_improvement_effect = yes
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				has_education_intrigue_trigger = yes
			}
			modifier = {
				factor = 1.5
				has_education_learning_trigger = yes
			}
		}
	}
	option = {
		name = EVTOPTDHF23760
		hidden_tooltip = {
			piety = 150 #Refund
			if = {
				limit = { character = FROM } #Used on yourself.
				prestige = 500
			}
			remove_character_modifier = stable_attribute_improvement_cooldown
			event_target:scoped_improvement_target = { remove_character_modifier = stable_attribute_improvement_target_cooldown }
		}
		ai_chance = { factor = 1 }
	}
}

#Thanks to synergy and good work, target has improved his education.
character_event = {
	id = HF.23761
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_diplomacy_attribute
		}
		text = EVTDESCAHF23761
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_martial_attribute
		}
		text = EVTDESCBHF23761
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_combat_rating
		}
		text = EVTDESCCHF23761
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_stewardship_attribute
		}
		text = EVTDESCDHF23761
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_intrigue_attribute
		}
		text = EVTDESCEHF23761
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_learning_attribute
		}
		text = EVTDESCFHF23761
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_diplomacy_attribute
		}
		text = EVTDESCGHF23761
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_martial_attribute
		}
		text = EVTDESCHHF23761
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_combat_rating
		}
		text = EVTDESCIHF23761
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_stewardship_attribute
		}
		text = EVTDESCLHF23761
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_intrigue_attribute
		}
		text = EVTDESCMHF23761
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_learning_attribute
		}
		text = EVTDESCNHF23761
	}
	picture = {
		trigger = {
			OR = {
				has_religion_feature = religion_matriarchal
				AND = {
					event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler is_female = yes }
					primary_title = { has_law = status_of_women_4 }
				}
			}
		}
		picture = GFX_evt_matriarchy_throne_room
	}
	picture = {
		trigger = {
			has_religion_feature = religion_patriarchal
		}
		picture = GFX_evt_tengri_throneroom_oldgods
	}
	picture = {
		trigger = {
			has_dlc = "Reapers"
			NOR = {
				has_religion_feature = religion_patriarchal
				has_religion_feature = religion_matriarchal
			}
		}
		picture = GFX_evt_prospering_province
	}
	picture = {
		trigger = {
			NOR = {
				has_dlc = "Reapers"
				has_religion_feature = religion_patriarchal
				has_religion_feature = religion_matriarchal
			}
		}
		picture = GFX_evt_magnificent_castle
	}
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_improvement_ruler

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23761
		if = {
			limit = {
				NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } }
			}
			opinion = {
				who = event_target:scoped_improvement_ruler
				modifier = opinion_mentor
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = flag_training_diplomacy_attribute
			}
			trigger_switch = {
				on_trigger = trait
				### Diplomacy ###
				naive_appeaser = {
					remove_trait = naive_appeaser
					add_trait = underhanded_rogue
				}
				underhanded_rogue = {
					remove_trait = underhanded_rogue
					add_trait = charismatic_negotiator
				}
				charismatic_negotiator = {
					remove_trait = charismatic_negotiator
					add_trait = grey_eminence
				}
				grey_eminence = {
					# already maxed
				}
			}
			clr_character_flag = flag_training_diplomacy_attribute
		}
		if = {
			limit = {
				OR = {
					has_character_flag = flag_training_martial_attribute
					has_character_flag = flag_training_combat_rating
				}
			}
			trigger_switch = {
				on_trigger = trait
				### Martial ###
				misguided_warrior = {
					remove_trait = misguided_warrior
					add_trait = tough_soldier
				}
				tough_soldier = {
					remove_trait = tough_soldier
					add_trait = skilled_tactician
				}
				skilled_tactician = {
					remove_trait = skilled_tactician
					add_trait = brilliant_strategist
				}
				brilliant_strategist = {
					# already maxed
				}
			}
			clr_character_flag = flag_training_martial_attribute
			clr_character_flag = flag_training_combat_rating
		}
		if = {
			limit = {
				has_character_flag = flag_training_stewardship_attribute
			}
			trigger_switch = {
				on_trigger = trait
				### Stewardship ###
				indulgent_wastrel = {
					remove_trait = indulgent_wastrel
					add_trait = thrifty_clerk
				}
				thrifty_clerk = {
					remove_trait = thrifty_clerk
					add_trait = fortune_builder
				}
				fortune_builder = {
					remove_trait = fortune_builder
					add_trait = midas_touched
				}
				midas_touched = {
					# already maxed
				}
			}
			clr_character_flag = flag_training_stewardship_attribute
		}
		if = {
			limit = {
				has_character_flag = flag_training_intrigue_attribute
			}
			trigger_switch = {
				on_trigger = trait
				### Intrigue ###
				amateurish_plotter = {
					remove_trait = amateurish_plotter
					add_trait = flamboyant_schemer
				}
				flamboyant_schemer = {
					remove_trait = flamboyant_schemer
					add_trait = intricate_webweaver
				}
				intricate_webweaver = {
					remove_trait = intricate_webweaver
					add_trait = elusive_shadow
				}
				elusive_shadow = {
					# already maxed
				}
			}
			clr_character_flag = flag_training_intrigue_attribute
		}
		if = {
			limit = {
				has_character_flag = flag_training_learning_attribute
			}
			trigger_switch = {
				on_trigger = trait
				### Learning ###
				detached_priest = {
					remove_trait = detached_priest
					add_trait = martial_cleric
				}
				martial_cleric = {
					remove_trait = martial_cleric
					add_trait = scholarly_theologian
				}
				scholarly_theologian = {
					remove_trait = scholarly_theologian
					add_trait = mastermind_theologian
				}
				mastermind_theologian = {
					# already maxed
				}
			}
			clr_character_flag = flag_training_learning_attribute
		}
	}
}

#Too much pressure resulted in burnout.
character_event = {
	id = HF.23762
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_diplomacy_attribute
		}
		text = EVTDESCAHF23762
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_martial_attribute
		}
		text = EVTDESCBHF23762
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_combat_rating
		}
		text = EVTDESCCHF23762
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_stewardship_attribute
		}
		text = EVTDESCDHF23762
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_intrigue_attribute
		}
		text = EVTDESCEHF23762
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } #Doing self-improvement.
			has_character_flag = flag_training_learning_attribute
		}
		text = EVTDESCFHF23762
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_diplomacy_attribute
		}
		text = EVTDESCGHF23762
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_martial_attribute
		}
		text = EVTDESCHHF23762
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_combat_rating
		}
		text = EVTDESCIHF23762
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_stewardship_attribute
		}
		text = EVTDESCLHF23762
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_intrigue_attribute
		}
		text = EVTDESCMHF23762
	}
	desc = {
		trigger = {
			NOT = { event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler } } #Helping someone else.
			has_character_flag = flag_training_learning_attribute
		}
		text = EVTDESCNHF23762
	}
	picture = {
		trigger = {
			event_target:scoped_improvement_target  = {
				is_female = yes
			}
		}
		picture = GFX_evt_bad_news_female
	}
	picture = {
		trigger = {
			event_target:scoped_improvement_target  = {
				is_female = no
			}
		}
		picture = GFX_evt_bad_news
	}
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_improvement_ruler

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23762
		trigger = {
			NOT = {
				trait = stressed
			}
		}
		add_trait = stressed
		health = -0.25
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.5
				trait = slothful
			}
			modifier = {
				factor = 1.5
				trait = diligent
			}
		}
	}
	option = { #Sacrifice personal grooming.
		name = EVTOPTBHF23762
		trigger = {
			NOT = {
				trait = uncouth
			}
		}
		if = {
			limit = {
				NOR = {
					trait = groomed
					trait = uncouth
					event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler }
				}
				event_target:scoped_improvement_ruler = { trait = uncouth } #Kindred coping.
			}
			opinion = { who = event_target:scoped_improvement_ruler modifier = opinion_kindred_spirit years = 5 }
			reverse_opinion = { who = event_target:scoped_improvement_ruler modifier = opinion_kindred_spirit years = 5 }
			hidden_tooltip = { event_target:scoped_improvement_ruler = { character_event = { id = HF.23763 } } }
		}
		else_if = { #If self-improving, look for kindred vassal.
			limit = {
				event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler }
				NOR = {
					trait = groomed
					trait = uncouth
				}
				any_courtier_or_vassal = {
					trait = uncouth
					is_adult = yes
					is_incapable = no
					prisoner = no
					NOT = { is_rival = ROOT }
					NOT = { trait = proud }
					opinion = { who = ROOT value = 0 }
				}
			}
			hidden_tooltip = {
				random_courtier_or_vassal = {
					limit = {
						trait = uncouth
						is_adult = yes
						is_incapable = no
						prisoner = no
						NOT = { is_rival = ROOT }
						NOT = { trait = proud }
						opinion = { who = ROOT value = 0 }
					}
					preferred_limit = {
						is_married = ROOT
					}
					preferred_limit = {
						is_lover = ROOT
					}
					preferred_limit = {
						is_friend = ROOT
					}
					save_event_target_as = scoped_kindred
				}
				character_event = { id = HF.23764 }
			}
		}
		if = {
			limit = {
				trait = groomed
			}
			remove_trait = groomed
		}
		else = {
			add_trait = uncouth
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.5
				trait = proud
			}
		}
	}
	option = { #Eat more.
		name = EVTOPTCHF23762
		trigger = {
			NOR  = {
				trait = is_fat
				trait = is_malnourished
			}
		}
		show_trait = is_fat
		gain_weight_medium_effect = yes
		set_character_flag = flag_primed_physique #No random flavor needed.
		weight_trait_check_effect = yes
		if = {
			limit = {
				OR = {
					NOT = { check_variable = { which = physique_variable value = -5 } }
					trait = feeble
				}
			}
			health = 0.5
		}
		if = {
			limit = {
				check_variable = { which = physique_variable value = 15 } #Nearing threshold.
				NOR = {
					trait = is_malnourished
					event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler }
				}
				event_target:scoped_improvement_ruler = { trait = is_fat } #Kindred coping.
			}
			opinion = { who = event_target:scoped_improvement_ruler modifier = opinion_kindred_spirit years = 5 }
			reverse_opinion = { who = event_target:scoped_improvement_ruler modifier = opinion_kindred_spirit years = 5 }
			hidden_tooltip = { event_target:scoped_improvement_ruler = { character_event = { id = HF.23765 } } }
		}
		else_if = { #If self-improving, look for kindred vassal.
			limit = {
				event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler }
				any_courtier_or_vassal = {
					trait = is_fat
					is_adult = yes
					is_incapable = no
					prisoner = no
					NOT = { is_rival = ROOT }
					NOT = { trait = temperate }
					opinion = { who = ROOT value = 0 }
				}
				check_variable = { which = physique_variable value = 15 } #Nearing threshold.
			}
			hidden_tooltip = {
				random_courtier_or_vassal = {
					limit = {
						trait = is_fat
						is_adult = yes
						is_incapable = no
						prisoner = no
						NOT = { is_rival = ROOT }
						NOT = { trait = temperate }
						opinion = { who = ROOT value = 0 }
					}
					preferred_limit = {
						is_married = ROOT
					}
					preferred_limit = {
						is_lover = ROOT
					}
					preferred_limit = {
						is_friend = ROOT
					}
					save_event_target_as = scoped_kindred
				}
				character_event = { id = HF.23766 }
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.5
				trait = temperate
			}
		}
	}
	option = { #Eat less.
		name = EVTOPTDHF23762
		trigger = {
			NOR  = {
				trait = is_fat
				trait = is_malnourished
			}
		}
		show_trait = is_malnourished
		lose_weight_medium_effect = yes
		set_character_flag = flag_primed_physique #No random flavor needed.
		weight_trait_check_effect = yes
		if = {
			limit = {
				OR = {
					check_variable = { which = physique_variable value = 5 }
					trait = sturdy
				}
			}
			health = 0.5
		}
		if = {
			limit = {
				NOT = { check_variable = { which = physique_variable value = -15 } } #Nearing threshold.
				NOR = {
					trait = is_fat
					event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler }
				}
				event_target:scoped_improvement_ruler = { trait = is_malnourished } #Kindred coping.
			}
			opinion = { who = event_target:scoped_improvement_ruler modifier = opinion_kindred_spirit years = 5 }
			reverse_opinion = { who = event_target:scoped_improvement_ruler modifier = opinion_kindred_spirit years = 5 }
			hidden_tooltip = { event_target:scoped_improvement_ruler = { character_event = { id = HF.23767 } } }
		}
		else_if = { #If self-improving, look for kindred vassal.
			limit = {
				event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler }
				any_courtier_or_vassal = {
					trait = is_malnourished
					is_adult = yes
					is_incapable = no
					prisoner = no
					NOT = { is_rival = ROOT }
					NOT = { trait = gluttonous }
					opinion = { who = ROOT value = 0 }
				}
				NOT = { check_variable = { which = physique_variable value = -15 } } #Nearing threshold.
			}
			hidden_tooltip = {
				random_courtier_or_vassal = {
					limit = {
						trait = is_malnourished
						is_adult = yes
						is_incapable = no
						prisoner = no
						NOT = { is_rival = ROOT }
						NOT = { trait = gluttonous }
						opinion = { who = ROOT value = 0 }
					}
					preferred_limit = {
						is_married = ROOT
					}
					preferred_limit = {
						is_lover = ROOT
					}
					preferred_limit = {
						is_friend = ROOT
					}
					save_event_target_as = scoped_kindred
				}
				character_event = { id = HF.23768 }
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.5
				trait = gluttonous
			}
		}
	}
	option = { #Total burnout.
		name = EVTOPTFHF23762
		trigger = {
			OR = {
				trait = stressed
				trait = uncouth
				trait = is_fat
				trait = is_malnourished
			}
		}
		if = {
			limit = {
				NOT = {
					event_target:scoped_improvement_target = { character = event_target:scoped_improvement_ruler }
				}
			}
			hidden_tooltip = { event_target:scoped_improvement_ruler = { character_event = { id = HF.23769 } } } #Notify.
		}
		trigger_switch = {
			on_trigger = trait

			### Intrigue ###
			amateurish_plotter = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOR = { trait = dull trait = shrewd } }
					add_trait = dull
				}
				else_if = {
					limit = { trait = dull NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}
			flamboyant_schemer = {
				remove_trait = flamboyant_schemer
				add_trait = amateurish_plotter
			}
			intricate_webweaver = {
				remove_trait = intricate_webweaver
				add_trait = flamboyant_schemer
			}
			elusive_shadow = {
				remove_trait = elusive_shadow
				add_trait = intricate_webweaver
			}

			### Diplomacy ###
			naive_appeaser = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOR = { trait = dull trait = shrewd } }
					add_trait = dull
				}
				else_if = {
					limit = { trait = dull NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}
			underhanded_rogue = {
				remove_trait = underhanded_rogue
				add_trait = naive_appeaser
			}
			charismatic_negotiator = {
				remove_trait = charismatic_negotiator
				add_trait = underhanded_rogue
			}
			grey_eminence = {
				remove_trait = grey_eminence
				add_trait = charismatic_negotiator
			}

			### Stewardship ###
			indulgent_wastrel = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOR = { trait = dull trait = shrewd } }
					add_trait = dull
				}
				else_if = {
					limit = { trait = dull NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}
			thrifty_clerk = {
				remove_trait = thrifty_clerk
				add_trait = indulgent_wastrel
			}
			fortune_builder = {
				remove_trait = fortune_builder
				add_trait = thrifty_clerk
			}
			midas_touched = {
				remove_trait = midas_touched
				add_trait = fortune_builder
			}

			### Martial ###
			misguided_warrior = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOR = { trait = dull trait = shrewd } }
					add_trait = dull
				}
				else_if = {
					limit = { trait = dull NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}
			tough_soldier = {
				remove_trait = tough_soldier
				add_trait = misguided_warrior
			}
			skilled_tactician = {
				remove_trait = skilled_tactician
				add_trait = tough_soldier
			}
			brilliant_strategist = {
				remove_trait = brilliant_strategist
				add_trait = skilled_tactician
			}

			### Learning ###
			detached_priest = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOR = { trait = dull trait = shrewd } }
					add_trait = dull
				}
				else_if = {
					limit = { trait = dull NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}
			martial_cleric = {
				remove_trait = martial_cleric
				add_trait = detached_priest
			}
			scholarly_theologian = {
				remove_trait = scholarly_theologian
				add_trait = martial_cleric
			}
			mastermind_theologian = {
				remove_trait = mastermind_theologian
				add_trait = scholarly_theologian
			}
		}
		ai_chance = { factor = 1 }
	}
	after = {
		clr_character_flag = flag_training_diplomacy_attribute
		clr_character_flag = flag_training_martial_attribute
		clr_character_flag = flag_training_combat_rating
		clr_character_flag = flag_training_stewardship_attribute
		clr_character_flag = flag_training_intrigue_attribute
		clr_character_flag = flag_training_learning_attribute
	}
}

#Ruler: Target become as uncouth as you.
character_event = {
	id = HF.23763
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { is_female = no }
		}
		text = EVTDESCAHF23763
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { is_female = yes }
		}
		text = EVTDESCBHF23763
	}
	picture = GFX_evt_drunk
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23763
		tooltip_info = uncouth
		tooltip = {
			opinion = { who = event_target:scoped_improvement_target modifier = opinion_kindred_spirit years = 5 }
			reverse_opinion = { who = event_target:scoped_improvement_target modifier = opinion_kindred_spirit years = 5 }
		}
	}
}

#Target: Random courtier approves of uncouthness.
character_event = {
	id = HF.23764
	desc = {
		trigger = {
			is_female = no
		}
		text = EVTDESCAHF23764
	}
	desc = {
		trigger = {
			is_female = yes
		}
		text = EVTDESCBHF23764
	}
	picture = GFX_evt_drunk
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_kindred

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23764
		tooltip_info = uncouth
		tooltip = {
			opinion = { who = event_target:scoped_kindred modifier = opinion_kindred_spirit years = 5 }
			reverse_opinion = { who = event_target:scoped_kindred modifier = opinion_kindred_spirit years = 5 }
		}
	}
}

#Ruler: Target become as fat as you.
character_event = {
	id = HF.23765
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { is_female = no }
		}
		text = EVTDESCAHF23765
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { is_female = yes }
		}
		text = EVTDESCBHF23765
	}
	picture = GFX_evt_fancy_feast
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23765
		tooltip_info = is_fat
		tooltip = {
			opinion = { who = event_target:scoped_improvement_target modifier = opinion_kindred_spirit years = 5 }
			reverse_opinion = { who = event_target:scoped_improvement_target modifier = opinion_kindred_spirit years = 5 }
		}
		hidden_tooltip = {
			event_target:scoped_improvement_target = { #Random flavor.
				set_character_flag = flag_fat_for_stress
				this_post_weight_gain_flavor_effect = yes
			}
		}
	}
}

#Target: Random courtier approves of weight.
character_event = {
	id = HF.23766
	desc = {
		trigger = {
			is_female = no
		}
		text = EVTDESCAHF23766
	}
	desc = {
		trigger = {
			is_female = yes
		}
		text = EVTDESCBHF23766
	}
	picture = GFX_evt_fancy_feast
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_kindred

	is_triggered_only = yes

	option = {
		name = {
			text = EVTOPTAHF23766_A
			trigger = {
				is_female = no
			}
		}
		name = {
			text = EVTOPTAHF23766_B
			trigger = {
				is_female = yes
			}
		}
		tooltip_info = is_fat
		tooltip = {
			opinion = { who = event_target:scoped_kindred modifier = opinion_kindred_spirit years = 5 }
			reverse_opinion = { who = event_target:scoped_kindred modifier = opinion_kindred_spirit years = 5 }
		}
		hidden_tooltip = {
			ROOT = { #Random flavor.
				set_character_flag = flag_fat_for_stress
				this_post_weight_gain_flavor_effect = yes
			}
		}
	}
}

#Ruler: Target become as thin as you.
character_event = {
	id = HF.23767
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { is_female = no }
		}
		text = EVTDESCAHF23767
	}
	desc = {
		trigger = {
			event_target:scoped_improvement_target = { is_female = yes }
		}
		text = EVTDESCBHF23767
	}
	picture = GFX_evt_fancy_feast
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23767
		tooltip_info = is_malnourished
		tooltip = {
			opinion = { who = event_target:scoped_improvement_target modifier = opinion_kindred_spirit years = 5 }
			reverse_opinion = { who = event_target:scoped_improvement_target modifier = opinion_kindred_spirit years = 5 }
		}
		hidden_tooltip = {
			event_target:scoped_improvement_target = { #Random flavor.
				set_character_flag = flag_malnourished_for_diligence
				this_post_weight_loss_flavor_effect = yes
			}
		}
	}
}

#Target: Random courtier approves of weight.
character_event = {
	id = HF.23768
	desc = {
		trigger = {
			is_female = no
		}
		text = EVTDESCAHF23768
	}
	desc = {
		trigger = {
			is_female = yes
		}
		text = EVTDESCBHF23768
	}
	picture = GFX_evt_fancy_feast
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_kindred

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23768
		tooltip_info = is_malnourished
		tooltip = {
			opinion = { who = event_target:scoped_kindred modifier = opinion_kindred_spirit years = 5 }
			reverse_opinion = { who = event_target:scoped_kindred modifier = opinion_kindred_spirit years = 5 }
		}
		hidden_tooltip = {
			ROOT = { #Random flavor.
				set_character_flag = flag_malnourished_for_diligence
				this_post_weight_loss_flavor_effect = yes
			}
		}
	}
}

#Ruler: Target experienced burnout.
character_event = {
	id = HF.23769
	desc = EVTDESCAHF23769
	picture = {
		trigger = {
			event_target:scoped_improvement_target  = {
				is_female = no
			}
		}
		picture = GFX_evt_bad_news
	}
	picture = {
		trigger = {
			event_target:scoped_improvement_target  = {
				is_female = yes
			}
		}
		picture = GFX_evt_bad_news_female
	}
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_improvement_target

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23769
		tiered_piety_negative_effect = yes
	}
}

#Family Bloodline gained from improving close relatives.
narrative_event = {
	id = HF.23770
	title = EVTTITLEHF24059
	desc = {
		trigger = {
			num_of_dynasty_members = 10
		}
		text = EVTDESCAHF24061
	}
	desc = {
		trigger = {
			NOT = { num_of_dynasty_members = 10 }
		}
		text = EVTDESCBHF24061
	}
	picture = GFX_evt_family
	border = GFX_event_narrative_frame_diplomacy
	sound = bloodline_added

	is_triggered_only = yes

	trigger = {
		has_dlc = "Holy Fury"
		NOT = {
			any_owned_bloodline = {
				has_bloodline_flag = created_bloodline
			}
		}
	}

	option = {
		name = EVTOPTAHF24061
		if = {
			limit = {
				this_has_cool_nickname_trigger = no
				this_has_super_cool_nickname_trigger = no
				is_female = no
			}
			ROOT = { give_nickname = nick_the_grand_patriarch }
		}
		if = {
			limit = {
				this_has_cool_nickname_trigger = no
				this_has_super_cool_nickname_trigger = no
				is_female = yes
			}
			ROOT = { give_nickname = nick_the_grand_matriarch }
		}
		if = {
			limit = { is_female = no }
			create_bloodline = {
				type = event_family_bloodline_01
			}
		}
		if = {
			limit = { is_female = yes }
			create_bloodline = {
				type = event_family_bloodline_01
				inheritance = matrilineal
			}
		}
		ai_chance = {
			factor = 100
		}
	}
}

#Benevolent Bloodline gained.
narrative_event = {
	id = HF.23771
	title = EVTTITLEHF24056
	desc = EVTDESCHF24058
	picture = {
		trigger = {
			has_religion_feature = religion_matriarchal
		}
		picture = GFX_evt_matriarchy_throne_room
	}
	picture = {
		trigger = {
			has_religion_feature = religion_patriarchal
		}
		picture = GFX_evt_tengri_throneroom_oldgods
	}
	picture = {
		trigger = {
			NOR = {
				has_religion_feature = religion_patriarchal
				has_religion_feature = religion_matriarchal
			}
		}
		picture = GFX_evt_throne_room
	}
	border = GFX_event_narrative_frame_diplomacy
	sound = bloodline_added

	is_triggered_only = yes

	trigger = {
		has_dlc = "Holy Fury"
		NOT = {
			any_owned_bloodline = {
				has_bloodline_flag = created_bloodline
			}
		}
	}

	option = {
		name = EVTOPTAHF24058
		if = {
			limit = {
				this_has_cool_nickname_trigger = no
				this_has_super_cool_nickname_trigger = no
			}
			ROOT = { give_nickname = nick_the_benevolent }
		}
		if = {
			limit = { is_female = no }
			create_bloodline = {
				type = event_benevolent_bloodline_01
			}
		}
		if = {
			limit = { is_female = yes }
			create_bloodline = {
				type = event_benevolent_bloodline_01
				inheritance = matrilineal
			}
		}
		ai_chance = {
			factor = 100
		}
	}
}

#Safety flag cleanup event.
character_event = {
	id = HF.23772
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		clr_character_flag = flag_training_diplomacy_attribute
		clr_character_flag = flag_training_martial_attribute
		clr_character_flag = flag_training_combat_rating
		clr_character_flag = flag_training_stewardship_attribute
		clr_character_flag = flag_training_intrigue_attribute
		clr_character_flag = flag_training_learning_attribute
	}
}

#on_adulthood (delayed): African rite of passage.
#First select investment for ceremony.
character_event = {
	id = HF.23773
	desc = EVTDESCAHF23773
	picture = GFX_evt_magic_ritual

	is_triggered_only = yes
	only_capable = yes

	trigger = {
		has_dlc = "Holy Fury"
		NOT = {
			dynasty = none
		}
		has_religion_feature = religion_animistic
	}

	option = {
		name = EVTOPTAHF23773
		custom_tooltip = { text = tooltip_EVTOPTAHF23773 }
		if = {
			limit = {
				ai = no
			}
			scaled_wealth = { value = -1.0 min = -150 max = -350 }
		}
		set_character_flag = flag_african_initiation_high
		if = {
			limit = {
				higher_real_tier_than = BARON
				is_landed = yes
				any_courtier_or_vassal = { has_job_title = job_spiritual religion = ROOT }
			}
			random_courtier_or_vassal = {
				limit = { has_job_title = job_spiritual religion = ROOT }
				opinion = {
					who = ROOT
					modifier = opinion_placated_spirits
					years = 20
				}
			}

		}
		hidden_tooltip = { character_event = { id = HF.23774 } }
		ai_chance = {
			factor = 10
			modifier = {
				factor = 1.5
				trait = zealous
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 0.25
				NOT = { wealth = 350 }
			}
			modifier = {
				factor = 0.15
				NOT = { wealth = 100 }
			}
		}
	}
	option = {
		name = EVTOPTBHF23773
		custom_tooltip = { text = tooltip_EVTOPTBHF23773 }
		if = {
			limit = {
				ai = no
			}
			scaled_wealth = { value = -1.0 min = -50 max = -100 }
		}
		hidden_tooltip = { character_event = { id = HF.23774 } }
		set_character_flag = flag_african_initiation_medium
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.5
				NOT = { wealth = 100 }
			}
			modifier = {
				factor = 0.25
				NOT = { wealth = 50 }
			}
		}
	}
	option = {
		name = EVTOPTCHF23773
		custom_tooltip = { text = tooltip_EVTOPTCHF23773 }
		if = {
			limit = {
				ai = no
			}
			scaled_wealth = { value = -1.0 min = -15 max = -50 }
		}
		hidden_tooltip = { character_event = { id = HF.23774 } }
		set_character_flag = flag_african_initiation_low
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.75
				NOT = { wealth = 50 }
			}
			modifier = {
				factor = 0.35
				NOT = { wealth = 0 }
			}
		}
	}
	option = {
		name = EVTOPTDHF23773
		custom_tooltip = { text = tooltip_EVTOPTDHF23773 }
		if = {
			limit = {
				trait = zealous
			}
			remove_trait = zealous
		}
		tiered_piety_negative_effect = yes
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0.1
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = cynical
			}
			modifier = {
				factor = 1.25
				trait = greedy
			}
		}
	}
}

#Then select the kind of bonus.
character_event = {
	id = HF.23774
	desc = {
		trigger = {
			has_character_flag = flag_african_initiation_high
		}
		text = EVTDESCAHF23774
	}
	desc = {
		trigger = {
			has_character_flag = flag_african_initiation_medium
		}
		text = EVTDESCBHF23774
	}
	desc = {
		trigger = {
			has_character_flag = flag_african_initiation_low
		}
		text = EVTDESCCHF23774
	}

	picture = GFX_evt_tribal_shrine
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { #Prosperity
		name = EVTOPTAHF23774
		custom_tooltip = { text = tooltip_EVTOPTAHF23774 }
		if = {
			limit = {
				has_character_flag = flag_african_initiation_high
			}
			add_character_modifier = {
				name = african_adulthood_rites_1
				years = 20
			}
		}
		if = {
			limit = {
				has_character_flag = flag_african_initiation_medium
			}
			add_character_modifier = {
				name = african_adulthood_rites_1
				years = 10
			}
		}
		if = {
			limit = {
				has_character_flag = flag_african_initiation_low
			}
			add_character_modifier = {
				name = african_adulthood_rites_1
				years = 5
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				trait = charitable
			}
			modifier = {
				factor = 1.5
				trait = kind
			}
			modifier = {
				factor = 1.5
				trait = idolizer
			}
			modifier = {
				factor = 1.5
				trait = affectionate
			}
		}
	}
	option = { #Power
		name = EVTOPTBHF23774
		custom_tooltip = { text = tooltip_EVTOPTBHF23774 }
		if = {
			limit = {
				has_character_flag = flag_african_initiation_high
			}
			add_character_modifier = {
				name = african_adulthood_rites_2
				years = 20
			}
		}
		if = {
			limit = {
				has_character_flag = flag_african_initiation_medium
			}
			add_character_modifier = {
				name = african_adulthood_rites_2
				years = 10
			}
		}
		if = {
			limit = {
				has_character_flag = flag_african_initiation_low
			}
			add_character_modifier = {
				name = african_adulthood_rites_2
				years = 5
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 1.5
				trait = cruel
			}
			modifier = {
				factor = 1.5
				trait = rowdy
			}
			modifier = {
				factor = 1.5
				trait = haughty
			}
		}
	}
	option = { #Shadows
		name = EVTOPTCHF23774
		custom_tooltip = { text = tooltip_EVTOPTCHF23774 }
		if = {
			limit = {
				has_character_flag = flag_african_initiation_high
			}
			add_character_modifier = {
				name = african_adulthood_rites_3
				years = 20
			}
		}
		if = {
			limit = {
				has_character_flag = flag_african_initiation_medium
			}
			add_character_modifier = {
				name = african_adulthood_rites_3
				years = 10
			}
		}
		if = {
			limit = {
				has_character_flag = flag_african_initiation_low
			}
			add_character_modifier = {
				name = african_adulthood_rites_3
				years = 5
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				trait = envious
			}
			modifier = {
				factor = 1.5
				trait = deceitful
			}
			modifier = {
				factor = 1.5
				trait = timid
			}
			modifier = {
				factor = 1.5
				trait = fussy
			}
		}
	}
	option = { #Death
		name = EVTOPTDHF23774
		custom_tooltip = { text = tooltip_EVTOPTDHF23774 }
		if = {
			limit = {
				has_character_flag = flag_african_initiation_high
			}
			add_character_modifier = {
				name = african_adulthood_rites_4
				years = 20
			}
		}
		if = {
			limit = {
				has_character_flag = flag_african_initiation_medium
			}
			add_character_modifier = {
				name = african_adulthood_rites_4
				years = 10
			}
		}
		if = {
			limit = {
				has_character_flag = flag_african_initiation_low
			}
			add_character_modifier = {
				name = african_adulthood_rites_4
				years = 5
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.5
				trait = feeble
			}
			modifier = {
				factor = 1.5
				trait = slothful
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				trait = brooding
			}
			modifier = {
				factor = 1.5
				trait = indolent
			}
		}
	}
	after = {
		clr_character_flag = flag_african_initiation_high
		clr_character_flag = flag_african_initiation_medium
		clr_character_flag = flag_african_initiation_low
	}
}

#on_adulthood: actual event, firing delay to avoid clutter.
character_event = {
	id = HF.23775
	hide_window = yes
	only_capable = yes

	trigger = {
		has_dlc = "Holy Fury"
		NOT = {
			dynasty = none
		}
		has_religion_feature = religion_animistic
	}

	is_triggered_only = yes

	immediate = {
		character_event = { id = HF.23773 days = 50 random = 50 }
	}
}

# On-action event: Divine Marriage due to Doctrine.
character_event = {
	id = HF.23777
	desc = EVTDESCHF23777
	picture = GFX_evt_marriage_zoroastrian_group


	is_triggered_only = yes

	trigger = {
		has_religion_feature = religion_holy_family
		new_character = { is_close_relative = FROM }
		OR = {
			FROM = { character = ROOT }
			AND = {
				FROM = {
					dynasty = ROOT
					is_primary_heir = ROOT
				}
				new_character = {
					NOT = { character = ROOT }
				}
			}
		}
	}

	option = {
		name = EVTOPTA500
		scaled_wealth = {
			value = 0.5
			min = 10
		}

		if = {
			limit = { tier = EMPEROR }
			piety = 300
		}
		if = {
			limit = { tier = KING }
			piety = 200
		}
		if = {
			limit = { tier = DUKE }
			piety = 100
		}
		if = {
			limit = { tier = COUNT }
			piety = 50
		}
		if = {
			limit = { tier = BARON }
			piety = 25
		}
	}
	option = {
		name = EVTOPTB500

		if = {
			limit = { tier = EMPEROR }
			piety = 300
		}
		if = {
			limit = { tier = KING }
			piety = 200
		}
		if = {
			limit = { tier = DUKE }
			piety = 100
		}
		if = {
			limit = { tier = COUNT }
			piety = 50
		}
		if = {
			limit = { tier = BARON }
			piety = 25
		}

		if = {
			limit = {
				NOT = { yearly_income = 50 }
			}
			if = {
				limit = { tier = EMPEROR }
				prestige = 150
			}
			if = {
				limit = { tier = KING }
				prestige = 50
			}
			if = {
				limit = { tier = DUKE }
				prestige = 25
			}
			if = {
				limit = { tier = COUNT }
				prestige = 13
			}
			if = {
				limit = { tier = BARON }
				prestige = 6
			}
			break = yes
		}

		if = {
			limit = { tier = EMPEROR }
			prestige = 300
		}
		if = {
			limit = { tier = KING }
			prestige = 200
		}
		if = {
			limit = { tier = DUKE }
			prestige = 100
		}
		if = {
			limit = { tier = COUNT }
			prestige = 50
		}
		if = {
			limit = { tier = BARON }
			prestige = 25
		}
	}
}

# New_holder event: Dogmatic+Holy Family+Temporal Head = Ruling religious head is the high god.
# ROOT is the character, FROM is the title, FROMFROM is the old holder
character_event = {
	id = HF.23779
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_religion_feature = religion_holy_family
		has_religion_feature = religion_dogmatic
		has_religion_feature = religion_temporal_head
		#religion = FROMFROM
		controls_religion = yes
	}

	immediate = {
		set_high_god_name = string_reformer_god
	}
}